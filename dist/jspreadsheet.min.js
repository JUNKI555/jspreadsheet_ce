!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).jspreadsheet=e()}}((function(){var define,module,exports;return function e(t,n,o){function r(a,l){if(!n[a]){if(!t[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};t[a][0].call(c.exports,(function(e){return r(t[a][1][e]||e)}),c,c.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(require,module,exports){var F,w;F=this,w=function(){var F=function(w){var k=(g={},g.nil=Error("#NULL!"),g.div0=Error("#DIV/0!"),g.value=Error("#VALUE!"),g.ref=Error("#REF!"),g.name=Error("#NAME?"),g.num=Error("#NUM!"),g.na=Error("#N/A"),g.error=Error("#ERROR!"),g.data=Error("#GETTING_DATA"),g),e=function(){var e={flattenShallow:function(e){return e&&e.reduce?e.reduce((function(e,t){var n=Array.isArray(e),o=Array.isArray(t);return n&&o?e.concat(t):n?(e.push(t),e):o?[e].concat(t):[e,t]})):e},isFlat:function(e){if(!e)return!1;for(var t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0},flatten:function(){for(var t=e.argsToArray.apply(null,arguments);!e.isFlat(t);)t=e.flattenShallow(t);return t},argsToArray:function(t){var n=[];return e.arrayEach(t,(function(e){n.push(e)})),n},numbers:function(){return this.flatten.apply(null,arguments).filter((function(e){return"number"==typeof e}))},cleanFloat:function(e){return Math.round(1e14*e)/1e14},parseBool:function(e){if("boolean"==typeof e||e instanceof Error)return e;if("number"==typeof e)return 0!==e;if("string"==typeof e){var t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}return e instanceof Date&&!isNaN(e)||k.value},parseNumber:function(e){return void 0===e||""===e||isNaN(e)?k.value:parseFloat(e)},parseNumberArray:function(t){var n,o;if(!t||0===(n=t.length))return k.value;for(;n--;){if((o=e.parseNumber(t[n]))===k.value)return o;t[n]=o}return t},parseMatrix:function(t){if(!t||0===t.length)return k.value;for(var n,o=0;o<t.length;o++)if(n=e.parseNumberArray(t[o]),t[o]=n,n instanceof Error)return n;return t}},t=new Date(Date.UTC(1900,0,1));return e.parseDate=function(e){return isNaN(e)?"string"!=typeof e||(e=new Date(e),isNaN(e))?k.value:e:e instanceof Date?new Date(e):0>(e=parseInt(e,10))?k.num:60>=e?new Date(t.getTime()+864e5*(e-1)):new Date(t.getTime()+864e5*(e-2))},e.parseDateArray=function(e){for(var t,n=e.length;n--;){if((t=this.parseDate(e[n]))===k.value)return t;e[n]=t}return e},e.anyIsError=function(){for(var e=arguments.length;e--;)if(arguments[e]instanceof Error)return!0;return!1},e.arrayValuesToNumbers=function(e){for(var t,n=e.length;n--;)"number"!=typeof(t=e[n])&&(!0===t?e[n]=1:!1===t?e[n]=0:"string"==typeof t&&(t=this.parseNumber(t),e[n]=t instanceof Error?0:t));return e},e.rest=function(e,t){return e&&"function"==typeof e.slice?e.slice(t||1):e},e.initial=function(e,t){return e&&"function"==typeof e.slice?e.slice(0,e.length-(t||1)):e},e.arrayEach=function(e,t){for(var n=-1,o=e.length;++n<o&&!1!==t(e[n],n,e););return e},e.transpose=function(e){return e?e[0].map((function(t,n){return e.map((function(e){return e[n]}))})):k.value},e}(),y={},g;y.datetime=function(){function t(e){return(e-o)/864e5+(-22038912e5<e?2:1)}var n={},o=new Date(1900,0,1),r=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];return n.DATE=function(t,n,o){return t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),e.anyIsError(t,n,o)?k.value:0>t||0>n||0>o?k.num:new Date(t,n-1,o)},n.DATEVALUE=function(e){return"string"!=typeof e?k.value:(e=Date.parse(e),isNaN(e)?k.value:-22038912e5>=e?(e-o)/864e5+1:(e-o)/864e5+2)},n.DAY=function(t){return(t=e.parseDate(t))instanceof Error?t:t.getDate()},n.DAYS=function(n,o){return n=e.parseDate(n),o=e.parseDate(o),n instanceof Error?n:o instanceof Error?o:t(n)-t(o)},n.DAYS360=function(e,t,n){},n.EDATE=function(n,o){return(n=e.parseDate(n))instanceof Error?n:isNaN(o)?k.value:(o=parseInt(o,10),n.setMonth(n.getMonth()+o),t(n))},n.EOMONTH=function(n,o){return(n=e.parseDate(n))instanceof Error?n:isNaN(o)?k.value:(o=parseInt(o,10),t(new Date(n.getFullYear(),n.getMonth()+o+1,0)))},n.HOUR=function(t){return(t=e.parseDate(t))instanceof Error?t:t.getHours()},n.INTERVAL=function(e){if("number"!=typeof e&&"string"!=typeof e)return k.value;e=parseInt(e,10);var t=Math.floor(e/94608e4);e%=94608e4;var n=Math.floor(e/2592e3);e%=2592e3;var o=Math.floor(e/86400);e%=86400;var r=Math.floor(e/3600);e%=3600;var i=Math.floor(e/60);return"P"+(0<t?t+"Y":"")+(0<n?n+"M":"")+(0<o?o+"D":"")+"T"+(0<r?r+"H":"")+(0<i?i+"M":"")+(0<(e%=60)?e+"S":"")},n.ISOWEEKNUM=function(t){if((t=e.parseDate(t))instanceof Error)return t;t.setHours(0,0,0),t.setDate(t.getDate()+4-(t.getDay()||7));var n=new Date(t.getFullYear(),0,1);return Math.ceil(((t-n)/864e5+1)/7)},n.MINUTE=function(t){return(t=e.parseDate(t))instanceof Error?t:t.getMinutes()},n.MONTH=function(t){return(t=e.parseDate(t))instanceof Error?t:t.getMonth()+1},n.NETWORKDAYS=function(e,t,n){},n.NETWORKDAYS.INTL=function(e,t,n,o){},n.NOW=function(){return new Date},n.SECOND=function(t){return(t=e.parseDate(t))instanceof Error?t:t.getSeconds()},n.TIME=function(t,n,o){return t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),e.anyIsError(t,n,o)?k.value:0>t||0>n||0>o?k.num:(3600*t+60*n+o)/86400},n.TIMEVALUE=function(t){return(t=e.parseDate(t))instanceof Error?t:(3600*t.getHours()+60*t.getMinutes()+t.getSeconds())/86400},n.TODAY=function(){return new Date},n.WEEKDAY=function(t,n){return(t=e.parseDate(t))instanceof Error?t:(void 0===n&&(n=1),t=t.getDay(),r[n][t])},n.WEEKNUM=function(e,t){},n.WORKDAY=function(e,t,n){},n.WORKDAY.INTL=function(e,t,n,o){},n.YEAR=function(t){return(t=e.parseDate(t))instanceof Error?t:t.getFullYear()},n.YEARFRAC=function(e,t,n){},n}(),y.database=function(){function g(a,c){for(var d={},f=1;f<a[0].length;++f)d[f]=!0;var h=c[0].length;for(f=1;f<c.length;++f)c[f].length>h&&(h=c[f].length);for(f=1;f<a.length;++f)for(var l=1;l<a[f].length;++l){for(var m=!1,n=!1,p=0;p<c.length;++p){var q=c[p];if(!(q.length<h)&&a[f][0]===q[0]){n=!0;for(var t=1;t<q.length;++t)m=m||eval(a[f][l]+q[t])}}n&&(d[l]=d[l]&&m)}for(c=[],h=0;h<a[0].length;++h)d[h]&&c.push(h-1);return c}var b={FINDFIELD:function(e,t){for(var n=null,o=0;o<e.length;o++)if(e[o][0]===t){n=o;break}return null==n?k.value:n},DAVERAGE:function(t,n,o){if(isNaN(n)&&"string"!=typeof n)return k.value;o=g(t,o),"string"==typeof n?(n=b.FINDFIELD(t,n),t=e.rest(t[n])):t=e.rest(t[n]);for(var r=n=0;r<o.length;r++)n+=t[o[r]];return 0===o.length?k.div0:n/o.length},DCOUNT:function(e,t,n){},DCOUNTA:function(e,t,n){},DGET:function(t,n,o){return isNaN(n)&&"string"!=typeof n?k.value:(o=g(t,o),"string"==typeof n?(n=b.FINDFIELD(t,n),t=e.rest(t[n])):t=e.rest(t[n]),0===o.length?k.value:1<o.length?k.num:t[o[0]])},DMAX:function(t,n,o){if(isNaN(n)&&"string"!=typeof n)return k.value;o=g(t,o),"string"==typeof n?(n=b.FINDFIELD(t,n),t=e.rest(t[n])):t=e.rest(t[n]),n=t[o[0]];for(var r=1;r<o.length;r++)n<t[o[r]]&&(n=t[o[r]]);return n},DMIN:function(t,n,o){if(isNaN(n)&&"string"!=typeof n)return k.value;o=g(t,o),"string"==typeof n?(n=b.FINDFIELD(t,n),t=e.rest(t[n])):t=e.rest(t[n]),n=t[o[0]];for(var r=1;r<o.length;r++)n>t[o[r]]&&(n=t[o[r]]);return n},DPRODUCT:function(t,n,o){if(isNaN(n)&&"string"!=typeof n)return k.value;if(o=g(t,o),"string"==typeof n){n=b.FINDFIELD(t,n);var r=e.rest(t[n])}else r=e.rest(t[n]);for(t=[],n=0;n<o.length;n++)t[n]=r[o[n]];if(o=t)for(t=[],n=0;n<o.length;++n)o[n]&&t.push(o[n]);else t=o;for(o=1,n=0;n<t.length;n++)o*=t[n];return o},DSTDEV:function(e,t,n){},DSTDEVP:function(e,t,n){},DSUM:function(e,t,n){},DVAR:function(e,t,n){},DVARP:function(e,t,n){},MATCH:function(e,t,n){if(!e&&!t)return k.na;if(2===arguments.length&&(n=1),!(t instanceof Array)||-1!==n&&0!==n&&1!==n)return k.na;for(var o,r,i=0;i<t.length;i++)if(1===n){if(t[i]===e)return i+1;t[i]<e&&(r?t[i]>r&&(o=i+1,r=t[i]):(o=i+1,r=t[i]))}else if(0===n){if("string"==typeof e){if(e=e.replace(/\?/g,"."),t[i].toLowerCase().match(e.toLowerCase()))return i+1}else if(t[i]===e)return i+1}else if(-1===n){if(t[i]===e)return i+1;t[i]>e&&(r?t[i]<r&&(o=i+1,r=t[i]):(o=i+1,r=t[i]))}return o||k.na}};return b}(),y.engineering=function(){var t={BESSELI:function(e,t){},BESSELJ:function(e,t){},BESSELK:function(e,t){},BESSELY:function(e,t){},BIN2DEC:function(e){if(!/^[01]{1,10}$/.test(e))return k.num;var t=parseInt(e,2);return 10===(e=e.toString()).length&&"1"===e.substring(0,1)?parseInt(e.substring(1),2)-512:t},BIN2HEX:function(e,t){if(!/^[01]{1,10}$/.test(e))return k.num;var n=e.toString();return 10===n.length&&"1"===n.substring(0,1)?(0xfffffffe00+parseInt(n.substring(1),2)).toString(16):(e=parseInt(e,2).toString(16),void 0===t?e:isNaN(t)?k.value:0>t?k.num:(t=Math.floor(t))>=e.length?REPT("0",t-e.length)+e:k.num)},BIN2OCT:function(e,t){if(!/^[01]{1,10}$/.test(e))return k.num;var n=e.toString();return 10===n.length&&"1"===n.substring(0,1)?(1073741312+parseInt(n.substring(1),2)).toString(8):(e=parseInt(e,2).toString(8),void 0===t?e:isNaN(t)?k.value:0>t?k.num:(t=Math.floor(t))>=e.length?REPT("0",t-e.length)+e:k.num)},BITAND:function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:0>t||0>n||Math.floor(t)!==t||Math.floor(n)!==n||0xffffffffffff<t||0xffffffffffff<n?k.num:t&n},BITLSHIFT:function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:0>t||Math.floor(t)!==t||0xffffffffffff<t||53<Math.abs(n)?k.num:0<=n?t<<n:t>>-n},BITOR:function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:0>t||0>n||Math.floor(t)!==t||Math.floor(n)!==n||0xffffffffffff<t||0xffffffffffff<n?k.num:t|n},BITRSHIFT:function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:0>t||Math.floor(t)!==t||0xffffffffffff<t||53<Math.abs(n)?k.num:0<=n?t>>n:t<<-n},BITXOR:function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:0>t||0>n||Math.floor(t)!==t||Math.floor(n)!==n||0xffffffffffff<t||0xffffffffffff<n?k.num:t^n},COMPLEX:function(t,n,o){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?t:"i"!==(o=void 0===o?"i":o)&&"j"!==o?k.value:0===t&&0===n?0:0===t?1===n?o:n.toString()+o:0===n?t.toString():t.toString()+(0<n?"+":"")+(1===n?o:n.toString()+o)},CONVERT:function(t,n,o){if((t=e.parseNumber(t))instanceof Error)return t;for(var r,i=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],a={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},l={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},s=null,u=null,c=n,d=o,p=1,f=1,h=0;h<i.length;h++)r=null===i[h][2]?[]:i[h][2],(i[h][1]===c||0<=r.indexOf(c))&&(s=i[h]),(i[h][1]===d||0<=r.indexOf(d))&&(u=i[h]);if(null===s)for(r=a[n.substring(0,2)],h=l[n.substring(0,1)],"da"===n.substring(0,2)&&(h=["dekao",10,"da"]),r?(p=r[2],c=n.substring(2)):h&&(p=h[1],c=n.substring(h[2].length)),n=0;n<i.length;n++)r=null===i[n][2]?[]:i[n][2],(i[n][1]===c||0<=r.indexOf(c))&&(s=i[n]);if(null===u)for(a=a[o.substring(0,2)],l=l[o.substring(0,1)],"da"===o.substring(0,2)&&(l=["dekao",10,"da"]),a?(f=a[2],d=o.substring(2)):l&&(f=l[1],d=o.substring(l[2].length)),o=0;o<i.length;o++)r=null===i[o][2]?[]:i[o][2],(i[o][1]===d||0<=r.indexOf(d))&&(u=i[o]);return null===s||null===u||s[3]!==u[3]?k.na:t*s[6]*p/(u[6]*f)},DEC2BIN:function(t,n){return(t=e.parseNumber(t))instanceof Error?t:!/^-?[0-9]{1,3}$/.test(t)||-512>t||511<t?k.num:0>t?"1"+REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2):(t=parseInt(t,10).toString(2),void 0===n?t:isNaN(n)?k.value:0>n?k.num:(n=Math.floor(n))>=t.length?REPT("0",n-t.length)+t:k.num)},DEC2HEX:function(t,n){return(t=e.parseNumber(t))instanceof Error?t:!/^-?[0-9]{1,12}$/.test(t)||-549755813888>t||549755813887<t?k.num:0>t?(1099511627776+t).toString(16):(t=parseInt(t,10).toString(16),void 0===n?t:isNaN(n)?k.value:0>n?k.num:(n=Math.floor(n))>=t.length?REPT("0",n-t.length)+t:k.num)},DEC2OCT:function(t,n){return(t=e.parseNumber(t))instanceof Error?t:!/^-?[0-9]{1,9}$/.test(t)||-536870912>t||536870911<t?k.num:0>t?(1073741824+t).toString(8):(t=parseInt(t,10).toString(8),void 0===n?t:isNaN(n)?k.value:0>n?k.num:(n=Math.floor(n))>=t.length?REPT("0",n-t.length)+t:k.num)},DELTA:function(t,n){return n=void 0===n?0:n,t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:t===n?1:0},ERF:function(e,t){}};return t.ERF.PRECISE=function(){},t.ERFC=function(e){},t.ERFC.PRECISE=function(){},t.GESTEP=function(t,n){return n=n||0,t=e.parseNumber(t),e.anyIsError(n,t)?t:t>=n?1:0},t.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return k.num;var n=10===e.length&&"f"===e.substring(0,1).toLowerCase();return-512>(e=n?parseInt(e,16)-1099511627776:parseInt(e,16))||511<e?k.num:n?"1"+REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2):(n=e.toString(2),void 0===t?n:isNaN(t)?k.value:0>t?k.num:(t=Math.floor(t))>=n.length?REPT("0",t-n.length)+n:k.num)},t.HEX2DEC=function(e){return/^[0-9A-Fa-f]{1,10}$/.test(e)?549755813888<=(e=parseInt(e,16))?e-1099511627776:e:k.num},t.HEX2OCT=function(e,t){return/^[0-9A-Fa-f]{1,10}$/.test(e)?536870911<(e=parseInt(e,16))&&0xffe0000000>e?k.num:0xffe0000000<=e?(e-0xffc0000000).toString(8):(e=e.toString(8),void 0===t?e:isNaN(t)?k.value:0>t?k.num:(t=Math.floor(t))>=e.length?REPT("0",t-e.length)+e:k.num):k.num},t.IMABS=function(n){var o=t.IMREAL(n);return n=t.IMAGINARY(n),e.anyIsError(o,n)?k.value:Math.sqrt(Math.pow(o,2)+Math.pow(n,2))},t.IMAGINARY=function(e){if(void 0===e||!0===e||!1===e)return k.value;if(0===e||"0"===e)return 0;if(0<=["i","j"].indexOf(e))return 1;var t=(e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));var o=e.substring(e.length-1,e.length);return o="i"===o||"j"===o,0<=t||0<=n?o?0<=t?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?k.num:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?k.num:-Number(e.substring(n+1,e.length-1)):k.num:o?isNaN(e.substring(0,e.length-1))?k.num:e.substring(0,e.length-1):isNaN(e)?k.num:0},t.IMARGUMENT=function(n){var o=t.IMREAL(n);return n=t.IMAGINARY(n),e.anyIsError(o,n)?k.value:0===o&&0===n?k.div0:0===o&&0<n?Math.PI/2:0===o&&0>n?-Math.PI/2:0===n&&0<o?0:0===n&&0>o?-Math.PI:0<o?Math.atan(n/o):0>o&&0<=n?Math.atan(n/o)+Math.PI:Math.atan(n/o)-Math.PI},t.IMCONJUGATE=function(n){var o=t.IMREAL(n),r=t.IMAGINARY(n);if(e.anyIsError(o,r))return k.value;var i=n.substring(n.length-1);return 0!==r?t.COMPLEX(o,-r,"i"===i||"j"===i?i:"i"):n},t.IMCOS=function(n){var o=t.IMREAL(n),r=t.IMAGINARY(n);return e.anyIsError(o,r)?k.value:(n=n.substring(n.length-1),t.COMPLEX(Math.cos(o)*(Math.exp(r)+Math.exp(-r))/2,-Math.sin(o)*(Math.exp(r)-Math.exp(-r))/2,"i"===n||"j"===n?n:"i"))},t.IMCOSH=function(n){var o=t.IMREAL(n),r=t.IMAGINARY(n);return e.anyIsError(o,r)?k.value:(n=n.substring(n.length-1),t.COMPLEX(Math.cos(r)*(Math.exp(o)+Math.exp(-o))/2,Math.sin(r)*(Math.exp(o)-Math.exp(-o))/2,"i"===n||"j"===n?n:"i"))},t.IMCOT=function(n){var o=t.IMREAL(n),r=t.IMAGINARY(n);return e.anyIsError(o,r)?k.value:t.IMDIV(t.IMCOS(n),t.IMSIN(n))},t.IMDIV=function(n,o){var r=t.IMREAL(n),i=t.IMAGINARY(n),a=t.IMREAL(o),l=t.IMAGINARY(o);if(e.anyIsError(r,i,a,l))return k.value;n=n.substring(n.length-1);var s=o.substring(o.length-1);return o="i",("j"===n||"j"===s)&&(o="j"),0===a&&0===l?k.num:(n=a*a+l*l,t.COMPLEX((r*a+i*l)/n,(i*a-r*l)/n,o))},t.IMEXP=function(n){var o=t.IMREAL(n),r=t.IMAGINARY(n);return e.anyIsError(o,r)?k.value:(n=n.substring(n.length-1),o=Math.exp(o),t.COMPLEX(o*Math.cos(r),o*Math.sin(r),"i"===n||"j"===n?n:"i"))},t.IMLN=function(n){var o=t.IMREAL(n),r=t.IMAGINARY(n);return e.anyIsError(o,r)?k.value:(n=n.substring(n.length-1),t.COMPLEX(Math.log(Math.sqrt(o*o+r*r)),Math.atan(r/o),"i"===n||"j"===n?n:"i"))},t.IMLOG10=function(n){var o=t.IMREAL(n),r=t.IMAGINARY(n);return e.anyIsError(o,r)?k.value:(n=n.substring(n.length-1),t.COMPLEX(Math.log(Math.sqrt(o*o+r*r))/Math.log(10),Math.atan(r/o)/Math.log(10),"i"===n||"j"===n?n:"i"))},t.IMLOG2=function(n){var o=t.IMREAL(n),r=t.IMAGINARY(n);return e.anyIsError(o,r)?k.value:(n=n.substring(n.length-1),t.COMPLEX(Math.log(Math.sqrt(o*o+r*r))/Math.log(2),Math.atan(r/o)/Math.log(2),"i"===n||"j"===n?n:"i"))},t.IMPOWER=function(n,o){o=e.parseNumber(o);var r=t.IMREAL(n),i=t.IMAGINARY(n);return e.anyIsError(o,r,i)?k.value:(r="i"===(r=n.substring(n.length-1))||"j"===r?r:"i",i=Math.pow(t.IMABS(n),o),n=t.IMARGUMENT(n),t.COMPLEX(i*Math.cos(o*n),i*Math.sin(o*n),r))},t.IMPRODUCT=function(){for(var n=arguments[0],o=1;o<arguments.length;o++){var r=t.IMREAL(n);n=t.IMAGINARY(n);var i=t.IMREAL(arguments[o]),a=t.IMAGINARY(arguments[o]);if(e.anyIsError(r,n,i,a))return k.value;n=t.COMPLEX(r*i-n*a,r*a+n*i)}return n},t.IMREAL=function(e){if(void 0===e||!0===e||!1===e)return k.value;if(0===e||"0"===e||0<="i +i 1i +1i -i -1i j +j 1j +1j -j -1j".split(" ").indexOf(e))return 0;var t=e.indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));var o=e.substring(e.length-1,e.length);return o="i"===o||"j"===o,0<=t||0<=n?o?0<=t?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?k.num:Number(e.substring(0,t)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?k.num:Number(e.substring(0,n)):k.num:o?isNaN(e.substring(0,e.length-1))?k.num:0:isNaN(e)?k.num:e},t.IMSEC=function(n){if(!0===n||!1===n)return k.value;var o=t.IMREAL(n),r=t.IMAGINARY(n);return e.anyIsError(o,r)?k.value:t.IMDIV("1",t.IMCOS(n))},t.IMSECH=function(n){var o=t.IMREAL(n),r=t.IMAGINARY(n);return e.anyIsError(o,r)?k.value:t.IMDIV("1",t.IMCOSH(n))},t.IMSIN=function(n){var o=t.IMREAL(n),r=t.IMAGINARY(n);return e.anyIsError(o,r)?k.value:(n=n.substring(n.length-1),t.COMPLEX(Math.sin(o)*(Math.exp(r)+Math.exp(-r))/2,Math.cos(o)*(Math.exp(r)-Math.exp(-r))/2,"i"===n||"j"===n?n:"i"))},t.IMSINH=function(n){var o=t.IMREAL(n),r=t.IMAGINARY(n);return e.anyIsError(o,r)?k.value:(n=n.substring(n.length-1),t.COMPLEX(Math.cos(r)*(Math.exp(o)-Math.exp(-o))/2,Math.sin(r)*(Math.exp(o)+Math.exp(-o))/2,"i"===n||"j"===n?n:"i"))},t.IMSQRT=function(n){var o=t.IMREAL(n),r=t.IMAGINARY(n);return e.anyIsError(o,r)?k.value:(o="i"===(o=n.substring(n.length-1))||"j"===o?o:"i",r=Math.sqrt(t.IMABS(n)),n=t.IMARGUMENT(n),t.COMPLEX(r*Math.cos(n/2),r*Math.sin(n/2),o))},t.IMCSC=function(n){if(!0===n||!1===n)return k.value;var o=t.IMREAL(n),r=t.IMAGINARY(n);return e.anyIsError(o,r)?k.num:t.IMDIV("1",t.IMSIN(n))},t.IMCSCH=function(n){if(!0===n||!1===n)return k.value;var o=t.IMREAL(n),r=t.IMAGINARY(n);return e.anyIsError(o,r)?k.num:t.IMDIV("1",t.IMSINH(n))},t.IMSUB=function(t,n){var o=this.IMREAL(t),r=this.IMAGINARY(t),i=this.IMREAL(n),a=this.IMAGINARY(n);if(e.anyIsError(o,r,i,a))return k.value;t=t.substring(t.length-1),n=n.substring(n.length-1);var l="i";return("j"===t||"j"===n)&&(l="j"),this.COMPLEX(o-i,r-a,l)},t.IMSUM=function(){for(var t=e.flatten(arguments),n=t[0],o=1;o<t.length;o++){var r=this.IMREAL(n);n=this.IMAGINARY(n);var i=this.IMREAL(t[o]),a=this.IMAGINARY(t[o]);if(e.anyIsError(r,n,i,a))return k.value;n=this.COMPLEX(r+i,n+a)}return n},t.IMTAN=function(n){if(!0===n||!1===n)return k.value;var o=t.IMREAL(n),r=t.IMAGINARY(n);return e.anyIsError(o,r)?k.value:this.IMDIV(this.IMSIN(n),this.IMCOS(n))},t.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return k.num;var n=10===e.length&&"7"===e.substring(0,1);return-512>(e=n?parseInt(e,8)-1073741824:parseInt(e,8))||511<e?k.num:n?"1"+REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2):(n=e.toString(2),void 0===t?n:isNaN(t)?k.value:0>t?k.num:(t=Math.floor(t))>=n.length?REPT("0",t-n.length)+n:k.num)},t.OCT2DEC=function(e){return/^[0-7]{1,10}$/.test(e)?536870912<=(e=parseInt(e,8))?e-1073741824:e:k.num},t.OCT2HEX=function(e,t){return/^[0-7]{1,10}$/.test(e)?536870912<=(e=parseInt(e,8))?"ff"+(e+3221225472).toString(16):(e=e.toString(16),void 0===t?e:isNaN(t)?k.value:0>t?k.num:(t=Math.floor(t))>=e.length?REPT("0",t-e.length)+e:k.num):k.num},t}(),y.financial=function(){function t(e){return e&&e.getTime&&!isNaN(e.getTime())}function n(e){return e instanceof Date?e:new Date(e)}var o={ACCRINT:function(e,o,r,i,a,l,s){return e=n(e),o=n(o),r=n(r),t(e)&&t(o)&&t(r)?0>=i||0>=a||-1===[1,2,4].indexOf(l)||-1===[0,1,2,3,4].indexOf(s)||r<=e?"#NUM!":(a||0)*i*YEARFRAC(e,r,s||0):"#VALUE!"},ACCRINTM:null,AMORDEGRC:null,AMORLINC:null,COUPDAYBS:null,COUPDAYS:null,COUPDAYSNC:null,COUPNCD:null,COUPNUM:null,COUPPCD:null,CUMIPMT:function(t,n,r,i,a,l){if(t=e.parseNumber(t),n=e.parseNumber(n),r=e.parseNumber(r),e.anyIsError(t,n,r))return k.value;if(0>=t||0>=n||0>=r||1>i||1>a||i>a||0!==l&&1!==l)return k.num;n=o.PMT(t,n,r,0,l);var s=0;for(1===i&&0===l&&(s=-r,i++);i<=a;i++)s=1===l?s+(o.FV(t,i-2,n,r,1)-n):s+o.FV(t,i-1,n,r,0);return s*t},CUMPRINC:function(t,n,r,i,a,l){if(t=e.parseNumber(t),n=e.parseNumber(n),r=e.parseNumber(r),e.anyIsError(t,n,r))return k.value;if(0>=t||0>=n||0>=r||1>i||1>a||i>a||0!==l&&1!==l)return k.num;n=o.PMT(t,n,r,0,l);var s=0;for(1===i&&(s=0===l?n+r*t:n,i++);i<=a;i++)s=0<l?s+(n-(o.FV(t,i-2,n,r,1)-n)*t):s+(n-o.FV(t,i-1,n,r,0)*t);return s},DB:function(t,n,o,r,i){if(i=void 0===i?12:i,t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),r=e.parseNumber(r),i=e.parseNumber(i),e.anyIsError(t,n,o,r,i))return k.value;if(0>t||0>n||0>o||0>r||-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(i)||r>o)return k.num;if(n>=t)return 0;for(var a=i=t*(n=(1-Math.pow(n/t,1/o)).toFixed(3))*i/12,l=0,s=r===o?o-1:r,u=2;u<=s;u++)a+=l=(t-a)*n;return 1===r?i:r===o?(t-a)*n:l},DDB:function(t,n,o,r,i){if(i=void 0===i?2:i,t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),r=e.parseNumber(r),i=e.parseNumber(i),e.anyIsError(t,n,o,r,i))return k.value;if(0>t||0>n||0>o||0>r||0>=i||r>o)return k.num;if(n>=t)return 0;for(var a=0,l=0,s=1;s<=r;s++)a+=l=Math.min(i/o*(t-a),t-n-a);return l},DISC:null,DOLLARDE:function(t,n){if(t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n))return k.value;if(0>n)return k.num;if(0<=n&&1>n)return k.div0;n=parseInt(n,10);var o=parseInt(t,10);return o+=t%1*Math.pow(10,Math.ceil(Math.log(n)/Math.LN10))/n,t=Math.pow(10,Math.ceil(Math.log(n)/Math.LN2)+1),Math.round(o*t)/t},DOLLARFR:function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:0>n?k.num:0<=n&&1>n?k.div0:(n=parseInt(n,10),parseInt(t,10)+t%1*Math.pow(10,-Math.ceil(Math.log(n)/Math.LN10))*n)},DURATION:null,EFFECT:function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:0>=t||1>n?k.num:(n=parseInt(n,10),Math.pow(1+t/n,n)-1)},FV:function(t,n,o,r,i){return r=r||0,i=i||0,t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),r=e.parseNumber(r),i=e.parseNumber(i),e.anyIsError(t,n,o,r,i)?k.value:(0===t?t=r+o*n:(n=Math.pow(1+t,n),t=1===i?r*n+o*(1+t)*(n-1)/t:r*n+o*(n-1)/t),-t)},FVSCHEDULE:function(t,n){if(t=e.parseNumber(t),n=e.parseNumberArray(e.flatten(n)),e.anyIsError(t,n))return k.value;for(var o=n.length,r=0;r<o;r++)t*=1+n[r];return t},INTRATE:null,IPMT:function(t,n,r,i,a,l){return a=a||0,l=l||0,t=e.parseNumber(t),n=e.parseNumber(n),r=e.parseNumber(r),i=e.parseNumber(i),a=e.parseNumber(a),l=e.parseNumber(l),e.anyIsError(t,n,r,i,a,l)?k.value:(r=o.PMT(t,r,i,a,l),(1===n?1===l?0:-i:1===l?o.FV(t,n-2,r,i,1)-r:o.FV(t,n-1,r,i,0))*t)},IRR:function(t,n){if(n=n||0,t=e.parseNumberArray(e.flatten(t)),n=e.parseNumber(n),e.anyIsError(t,n))return k.value;for(var o=function(e,t,n){n+=1;for(var o=e[0],r=1;r<e.length;r++)o+=e[r]/Math.pow(n,(t[r]-t[0])/365);return o},r=function(e,t,n){n+=1;for(var o=0,r=1;r<e.length;r++){var i=(t[r]-t[0])/365;o-=i*e[r]/Math.pow(n,i+1)}return o},i=[],a=!1,l=!1,s=0;s<t.length;s++)i[s]=0===s?0:i[s-1]+365,0<t[s]&&(a=!0),0>t[s]&&(l=!0);if(!a||!l)return k.num;n=void 0===n?.1:n,a=!0;do{a=n-(s=o(t,i,n))/r(t,i,n),l=Math.abs(a-n),n=a,a=1e-10<l&&1e-10<Math.abs(s)}while(a);return n},ISPMT:function(t,n,o,r){return t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),r=e.parseNumber(r),e.anyIsError(t,n,o,r)?k.value:r*t*(n/o-1)},MDURATION:null,MIRR:function(t,n,r){if(t=e.parseNumberArray(e.flatten(t)),n=e.parseNumber(n),r=e.parseNumber(r),e.anyIsError(t,n,r))return k.value;for(var i=t.length,a=[],l=[],s=0;s<i;s++)0>t[s]?a.push(t[s]):l.push(t[s]);return t=-o.NPV(r,l)*Math.pow(1+r,i-1),n=o.NPV(n,a)*(1+n),Math.pow(t/n,1/(i-1))-1},NOMINAL:function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:0>=t||1>n?k.num:(n=parseInt(n,10),(Math.pow(t+1,1/n)-1)*n)},NPER:function(t,n,o,r,i){return i=void 0===i?0:i,r=void 0===r?0:r,t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),r=e.parseNumber(r),i=e.parseNumber(i),e.anyIsError(t,n,o,r,i)?k.value:Math.log((n*(1+t*i)-r*t)/(o*t+n*(1+t*i)))/Math.log(1+t)},NPV:function(){var t=e.parseNumberArray(e.flatten(arguments));if(t instanceof Error)return t;for(var n=t[0],o=0,r=1;r<t.length;r++)o+=t[r]/Math.pow(1+n,r);return o},ODDFPRICE:null,ODDFYIELD:null,ODDLPRICE:null,ODDLYIELD:null,PDURATION:function(t,n,o){return t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),e.anyIsError(t,n,o)?k.value:0>=t?k.num:(Math.log(o)-Math.log(n))/Math.log(1+t)},PMT:function(t,n,o,r,i){return r=r||0,i=i||0,t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),r=e.parseNumber(r),i=e.parseNumber(i),e.anyIsError(t,n,o,r,i)?k.value:(0===t?t=(o+r)/n:(n=Math.pow(1+t,n),t=1===i?(r*t/(n-1)+o*t/(1-1/n))/(1+t):r*t/(n-1)+o*t/(1-1/n)),-t)},PPMT:function(t,n,r,i,a,l){return a=a||0,l=l||0,t=e.parseNumber(t),r=e.parseNumber(r),i=e.parseNumber(i),a=e.parseNumber(a),l=e.parseNumber(l),e.anyIsError(t,r,i,a,l)?k.value:o.PMT(t,r,i,a,l)-o.IPMT(t,n,r,i,a,l)},PRICE:null,PRICEDISC:null,PRICEMAT:null,PV:function(t,n,o,r,i){return r=r||0,i=i||0,t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),r=e.parseNumber(r),i=e.parseNumber(i),e.anyIsError(t,n,o,r,i)?k.value:0===t?-o*n-r:((1-Math.pow(1+t,n))/t*o*(1+t*i)-r)/Math.pow(1+t,n)},RATE:function(t,n,o,r,i,a){if(a=void 0===a?.01:a,r=void 0===r?0:r,i=void 0===i?0:i,t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),r=e.parseNumber(r),i=e.parseNumber(i),a=e.parseNumber(a),e.anyIsError(t,n,o,r,i,a))return k.value;for(var l=0,s=!1;100>l&&!s;){var u=Math.pow(a+1,t),c=Math.pow(a+1,t-1);u=a-(r+u*o+n*(u-1)*(a*i+1)/a)/(t*c*o-n*(u-1)*(a*i+1)/Math.pow(a,2)+(t*n*c*(a*i+1)/a+n*(u-1)*i/a)),1e-6>Math.abs(u-a)&&(s=!0),l++,a=u}return s?a:Number.NaN+a},RECEIVED:null,RRI:function(t,n,o){return t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),e.anyIsError(t,n,o)?k.value:0===t||0===n?k.num:Math.pow(o/n,1/t)-1},SLN:function(t,n,o){return t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),e.anyIsError(t,n,o)?k.value:0===o?k.num:(t-n)/o},SYD:function(t,n,o,r){return t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),r=e.parseNumber(r),e.anyIsError(t,n,o,r)?k.value:0===o||1>r||r>o?k.num:(t-n)*(o-(r=parseInt(r,10))+1)*2/(o*(o+1))},TBILLEQ:function(t,n,o){return t=e.parseDate(t),n=e.parseDate(n),o=e.parseNumber(o),e.anyIsError(t,n,o)?k.value:0>=o||t>n||31536e6<n-t?k.num:365*o/(360-o*DAYS360(t,n,!1))},TBILLPRICE:function(t,n,o){return t=e.parseDate(t),n=e.parseDate(n),o=e.parseNumber(o),e.anyIsError(t,n,o)?k.value:0>=o||t>n||31536e6<n-t?k.num:100*(1-o*DAYS360(t,n,!1)/360)},TBILLYIELD:function(t,n,o){return t=e.parseDate(t),n=e.parseDate(n),o=e.parseNumber(o),e.anyIsError(t,n,o)?k.value:0>=o||t>n||31536e6<n-t?k.num:360*(100-o)/(o*DAYS360(t,n,!1))},VDB:null,XIRR:function(t,n,o){if(t=e.parseNumberArray(e.flatten(t)),n=e.parseDateArray(e.flatten(n)),o=e.parseNumber(o),e.anyIsError(t,n,o))return k.value;for(var r=function(e,t,n){n+=1;for(var o=e[0],r=1;r<e.length;r++)o+=e[r]/Math.pow(n,DAYS(t[r],t[0])/365);return o},i=function(e,t,n){n+=1;for(var o=0,r=1;r<e.length;r++){var i=DAYS(t[r],t[0])/365;o-=i*e[r]/Math.pow(n,i+1)}return o},a=!1,l=!1,s=0;s<t.length;s++)0<t[s]&&(a=!0),0>t[s]&&(l=!0);if(!a||!l)return k.num;o=o||.1,a=!0;do{a=o-(s=r(t,n,o))/i(t,n,o),l=Math.abs(a-o),o=a,a=1e-10<l&&1e-10<Math.abs(s)}while(a);return o},XNPV:function(t,n,o){if(t=e.parseNumber(t),n=e.parseNumberArray(e.flatten(n)),o=e.parseDateArray(e.flatten(o)),e.anyIsError(t,n,o))return k.value;for(var r=0,i=0;i<n.length;i++)r+=n[i]/Math.pow(1+t,DAYS(o[i],o[0])/365);return r},YIELD:null,YIELDDISC:null,YIELDMAT:null};return o}(),y.information=function(){var e={CELL:null,ERROR:{}};return e.ERROR.TYPE=function(e){switch(e){case k.nil:return 1;case k.div0:return 2;case k.value:return 3;case k.ref:return 4;case k.name:return 5;case k.num:return 6;case k.na:return 7;case k.data:return 8}return k.na},e.INFO=null,e.ISBLANK=function(e){return null==e||""===e},e.ISBINARY=function(e){return/^[01]{1,10}$/.test(e)},e.ISERR=function(e){return 0<=[k.value,k.ref,k.div0,k.num,k.name,k.nil].indexOf(e)||"number"==typeof e&&(isNaN(e)||!isFinite(e))},e.ISERROR=function(t){return e.ISERR(t)||t===k.na},e.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},e.ISFORMULA=null,e.ISLOGICAL=function(e){return!0===e||!1===e},e.ISNA=function(e){return e===k.na},e.ISNONTEXT=function(e){return"string"!=typeof e},e.ISNUMBER=function(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)},e.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},e.ISREF=null,e.ISTEXT=function(e){return"string"==typeof e},e.N=function(e){return this.ISNUMBER(e)?e:e instanceof Date?e.getTime():!0===e?1:!1===e?0:this.ISERROR(e)?e:0},e.NA=function(){return k.na},e.SHEET=null,e.SHEETS=null,e.TYPE=function(e){return this.ISNUMBER(e)?1:this.ISTEXT(e)?2:this.ISLOGICAL(e)?4:this.ISERROR(e)?16:Array.isArray(e)?64:void 0},e}(),y.logical={AND:function(){for(var t=e.flatten(arguments),n=!0,o=0;o<t.length;o++)t[o]||(n=!1);return n},CHOOSE:function(){if(2>arguments.length)return k.na;var e=arguments[0];return 1>e||254<e||arguments.length<e+1?k.value:arguments[e]},FALSE:function(){return!1},IF:function(e,t,n){return e?t:n},IFERROR:function(e,t){return ISERROR(e)?t:e},IFNA:function(e,t){return e===k.na?t:e},NOT:function(e){return!e},OR:function(){for(var t=e.flatten(arguments),n=!1,o=0;o<t.length;o++)t[o]&&(n=!0);return n},TRUE:function(){return!0},XOR:function(){for(var t=e.flatten(arguments),n=0,o=0;o<t.length;o++)t[o]&&n++;return!!(1&Math.floor(Math.abs(n)))},SWITCH:function(){if(0<arguments.length){var e=arguments[0],t=arguments.length-1,n=Math.floor(t/2),o=!1;if(t=0==t%2?null:arguments[arguments.length-1],n)for(var r=0;r<n;r++)if(e===arguments[2*r+1]){var i=arguments[2*r+2];o=!0;break}!o&&t&&(i=t)}return i}},y.math=function(){var g={ABS:function(t){return(t=e.parseNumber(t))instanceof Error?t:Math.abs(e.parseNumber(t))},ACOS:function(t){return(t=e.parseNumber(t))instanceof Error?t:Math.acos(t)},ACOSH:function(t){return(t=e.parseNumber(t))instanceof Error?t:Math.log(t+Math.sqrt(t*t-1))},ACOT:function(t){return(t=e.parseNumber(t))instanceof Error?t:Math.atan(1/t)},ACOTH:function(t){return(t=e.parseNumber(t))instanceof Error?t:.5*Math.log((t+1)/(t-1))},AGGREGATE:null,ARABIC:function(e){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return k.value;var t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(function(e){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]})),t},ASIN:function(t){return(t=e.parseNumber(t))instanceof Error?t:Math.asin(t)},ASINH:function(t){return(t=e.parseNumber(t))instanceof Error?t:Math.log(t+Math.sqrt(t*t+1))},ATAN:function(t){return(t=e.parseNumber(t))instanceof Error?t:Math.atan(t)},ATAN2:function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:Math.atan2(t,n)},ATANH:function(t){return(t=e.parseNumber(t))instanceof Error?t:Math.log((1+t)/(1-t))/2},BASE:function(t,n,o){return o=o||0,t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),e.anyIsError(t,n,o)?k.value:(o=void 0===o?0:o,t=t.toString(n),Array(Math.max(o+1-t.length,0)).join("0")+t)},CEILING:function(t,n,o){return n=void 0===n?1:n,o=void 0===o?0:o,t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),e.anyIsError(t,n,o)?k.value:0===n?0:(n=Math.abs(n),0<=t?Math.ceil(t/n)*n:0===o?-1*Math.floor(Math.abs(t)/n)*n:-1*Math.ceil(Math.abs(t)/n)*n)}};g.CEILING.MATH=g.CEILING,g.CEILING.PRECISE=g.CEILING,g.COMBIN=function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:g.FACT(t)/(g.FACT(n)*g.FACT(t-n))},g.COMBINA=function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:0===t&&0===n?1:g.COMBIN(t+n-1,t-1)},g.COS=function(t){return(t=e.parseNumber(t))instanceof Error?t:Math.cos(t)},g.COSH=function(t){return(t=e.parseNumber(t))instanceof Error?t:(Math.exp(t)+Math.exp(-t))/2},g.COT=function(t){return(t=e.parseNumber(t))instanceof Error?t:1/Math.tan(t)},g.COTH=function(t){return(t=e.parseNumber(t))instanceof Error?t:((t=Math.exp(2*t))+1)/(t-1)},g.CSC=function(t){return(t=e.parseNumber(t))instanceof Error?t:1/Math.sin(t)},g.CSCH=function(t){return(t=e.parseNumber(t))instanceof Error?t:2/(Math.exp(t)-Math.exp(-t))},g.DECIMAL=function(e,t){return 1>arguments.length?k.value:parseInt(e,t)},g.DEGREES=function(t){return(t=e.parseNumber(t))instanceof Error?t:180*t/Math.PI},g.EVEN=function(t){return(t=e.parseNumber(t))instanceof Error?t:g.CEILING(t,-2,-1)},g.EXP=Math.exp;var b=[];return g.FACT=function(t){return(t=e.parseNumber(t))instanceof Error?t:0===(t=Math.floor(t))||1===t?1:(0<b[t]||(b[t]=g.FACT(t-1)*t),b[t])},g.FACTDOUBLE=function(t){return(t=e.parseNumber(t))instanceof Error?t:0>=(t=Math.floor(t))?1:t*g.FACTDOUBLE(t-2)},g.FLOOR=function(t,n,o){return n=void 0===n?1:n,o=void 0===o?0:o,t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),e.anyIsError(t,n,o)?k.value:0===n?0:(n=Math.abs(n),0<=t?Math.floor(t/n)*n:0===o?-1*Math.ceil(Math.abs(t)/n)*n:-1*Math.floor(Math.abs(t)/n)*n)},g.FLOOR.MATH=g.FLOOR,g.GCD=null,g.INT=function(t){return(t=e.parseNumber(t))instanceof Error?t:Math.floor(t)},g.LCM=function(){var t=e.parseNumberArray(e.flatten(arguments));if(t instanceof Error)return t;for(var n,o,r,i=1;void 0!==(r=t.pop());)for(;1<r;){if(r%2){for(n=3,o=Math.floor(Math.sqrt(r));n<=o&&r%n;n+=2);o=n<=o?n:r}else o=2;for(r/=o,i*=o,n=t.length;n;0==t[--n]%o&&1==(t[n]/=o)&&t.splice(n,1));}return i},g.LN=function(t){return(t=e.parseNumber(t))instanceof Error?t:Math.log(t)},g.LOG=function(t,n){return t=e.parseNumber(t),n=void 0===n?10:e.parseNumber(n),e.anyIsError(t,n)?k.value:Math.log(t)/Math.log(n)},g.LOG10=function(t){return(t=e.parseNumber(t))instanceof Error?t:0===t?k.num:Math.log(t)/Math.log(10)},g.MDETERM=null,g.MINVERSE=null,g.MMULT=null,g.MOD=function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:0===n?k.div0:(t=Math.abs(t%n),0<n?t:-t)},g.MROUND=function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:0>t*n?k.num:Math.round(t/n)*n},g.MULTINOMIAL=function(){var t=e.parseNumberArray(e.flatten(arguments));if(t instanceof Error)return t;for(var n=0,o=1,r=0;r<t.length;r++)n+=t[r],o*=g.FACT(t[r]);return g.FACT(n)/o},g.MUNIT=null,g.ODD=function(t){if((t=e.parseNumber(t))instanceof Error)return t;var n=Math.ceil(Math.abs(t));return n=1&n?n:n+1,0<t?n:-n},g.PI=function(){return Math.PI},g.POWER=function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:(t=Math.pow(t,n),isNaN(t)?k.num:t)},g.PRODUCT=function(){var t=e.parseNumberArray(e.flatten(arguments));if(t instanceof Error)return t;for(var n=1,o=0;o<t.length;o++)n*=t[o];return n},g.QUOTIENT=function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:parseInt(t/n,10)},g.RADIANS=function(t){return(t=e.parseNumber(t))instanceof Error?t:t*Math.PI/180},g.RAND=function(){return Math.random()},g.RANDBETWEEN=function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:t+Math.ceil((n-t+1)*Math.random())-1},g.ROMAN=null,g.ROUND=function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:Math.round(t*Math.pow(10,n))/Math.pow(10,n)},g.ROUNDDOWN=function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:(0<t?1:-1)*Math.floor(Math.abs(t)*Math.pow(10,n))/Math.pow(10,n)},g.ROUNDUP=function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:(0<t?1:-1)*Math.ceil(Math.abs(t)*Math.pow(10,n))/Math.pow(10,n)},g.SEC=function(t){return(t=e.parseNumber(t))instanceof Error?t:1/Math.cos(t)},g.SECH=function(t){return(t=e.parseNumber(t))instanceof Error?t:2/(Math.exp(t)+Math.exp(-t))},g.SERIESSUM=function(t,n,o,r){if(t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),r=e.parseNumberArray(r),e.anyIsError(t,n,o,r))return k.value;for(var i=r[0]*Math.pow(t,n),a=1;a<r.length;a++)i+=r[a]*Math.pow(t,n+a*o);return i},g.SIGN=function(t){return(t=e.parseNumber(t))instanceof Error?t:0>t?-1:0===t?0:1},g.SIN=function(t){return(t=e.parseNumber(t))instanceof Error?t:Math.sin(t)},g.SINH=function(t){return(t=e.parseNumber(t))instanceof Error?t:(Math.exp(t)-Math.exp(-t))/2},g.SQRT=function(t){return(t=e.parseNumber(t))instanceof Error?t:0>t?k.num:Math.sqrt(t)},g.SQRTPI=function(t){return(t=e.parseNumber(t))instanceof Error?t:Math.sqrt(t*Math.PI)},g.SUBTOTAL=null,g.ADD=function(t,n){return 2!==arguments.length?k.na:(t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:t+n)},g.MINUS=function(t,n){return 2!==arguments.length?k.na:(t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:t-n)},g.DIVIDE=function(t,n){return 2!==arguments.length?k.na:(t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:0===n?k.div0:t/n)},g.MULTIPLY=function(t,n){return 2!==arguments.length?k.na:(t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:t*n)},g.GTE=function(t,n){return 2!==arguments.length?k.na:(t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.error:t>=n)},g.LT=function(t,n){return 2!==arguments.length?k.na:(t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.error:t<n)},g.LTE=function(t,n){return 2!==arguments.length?k.na:(t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.error:t<=n)},g.EQ=function(e,t){return 2!==arguments.length?k.na:e===t},g.NE=function(e,t){return 2!==arguments.length?k.na:e!==t},g.POW=function(t,n){return 2!==arguments.length?k.na:(t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.error:g.POWER(t,n))},g.SUM=function(){for(var e=0,t=Object.keys(arguments),n=0;n<t.length;++n){var o=arguments[t[n]];"number"==typeof o?e+=o:"string"==typeof o?(o=parseFloat(o),!isNaN(o)&&(e+=o)):Array.isArray(o)&&(e+=g.SUM.apply(null,o))}return e},g.SUMIF=function(){var a=e.argsToArray(arguments),c=a.pop();if(a=e.parseNumberArray(e.flatten(a)),a instanceof Error)return a;for(var d=0,f=0;f<a.length;f++)d+=eval(a[f]+c)?a[f]:0;return d},g.SUMIFS=function(){var a=e.argsToArray(arguments),c=e.parseNumberArray(e.flatten(a.shift()));if(c instanceof Error)return c;for(var d=c.length,f=a.length,h=0,l=0;l<d;l++){for(var m=c[l],n="",p=0;p<f;p+=2)n=isNaN(a[p][l])?n+'"'+a[p][l]+'"'+a[p+1]:n+(a[p][l]+a[p+1]),p!==f-1&&(n+=" && ");n=n.slice(0,-4),eval(n)&&(h+=m)}return h},g.SUMPRODUCT=null,g.SUMSQ=function(){var t=e.parseNumberArray(e.flatten(arguments));if(t instanceof Error)return t;for(var n=0,o=t.length,r=0;r<o;r++)n+=ISNUMBER(t[r])?t[r]*t[r]:0;return n},g.SUMX2MY2=function(t,n){if(t=e.parseNumberArray(e.flatten(t)),n=e.parseNumberArray(e.flatten(n)),e.anyIsError(t,n))return k.value;for(var o=0,r=0;r<t.length;r++)o+=t[r]*t[r]-n[r]*n[r];return o},g.SUMX2PY2=function(t,n){if(t=e.parseNumberArray(e.flatten(t)),n=e.parseNumberArray(e.flatten(n)),e.anyIsError(t,n))return k.value;var o=0;t=e.parseNumberArray(e.flatten(t)),n=e.parseNumberArray(e.flatten(n));for(var r=0;r<t.length;r++)o+=t[r]*t[r]+n[r]*n[r];return o},g.SUMXMY2=function(t,n){if(t=e.parseNumberArray(e.flatten(t)),n=e.parseNumberArray(e.flatten(n)),e.anyIsError(t,n))return k.value;var o=0;t=e.flatten(t),n=e.flatten(n);for(var r=0;r<t.length;r++)o+=Math.pow(t[r]-n[r],2);return o},g.TAN=function(t){return(t=e.parseNumber(t))instanceof Error?t:Math.tan(t)},g.TANH=function(t){return(t=e.parseNumber(t))instanceof Error?t:((t=Math.exp(2*t))-1)/(t+1)},g.TRUNC=function(t,n){return n=void 0===n?0:n,t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:(0<t?1:-1)*Math.floor(Math.abs(t)*Math.pow(10,n))/Math.pow(10,n)},g}(),y.misc=function(){var t={UNIQUE:function(){for(var e=[],t=0;t<arguments.length;++t){for(var n=!1,o=arguments[t],r=0;r<e.length&&!(n=e[r]===o);++r);n||e.push(o)}return e}};return t.FLATTEN=e.flatten,t.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},t.REFERENCE=function(e,t){try{var n=t.split(".");for(t=0;t<n.length;++t){var o=n[t];if("]"===o[o.length-1]){var r=o.indexOf("["),i=o.substring(r+1,o.length-1);e=e[o.substring(0,r)][i]}else e=e[o]}return e}catch(e){}},t.JOIN=function(e,t){return e.join(t)},t.NUMBERS=function(){return e.flatten(arguments).filter((function(e){return"number"==typeof e}))},t.NUMERAL=null,t}(),y.text=function(){var t={ASC:null,BAHTTEXT:null,CHAR:function(t){return(t=e.parseNumber(t))instanceof Error?t:String.fromCharCode(t)},CLEAN:function(e){return(e||"").replace(/[\0-\x1F]/g,"")},CODE:function(e){return(e||"").charCodeAt(0)},CONCATENATE:function(){for(var t,n=e.flatten(arguments);-1<(t=n.indexOf(!0));)n[t]="TRUE";for(;-1<(t=n.indexOf(!1));)n[t]="FALSE";return n.join("")},DBCS:null,DOLLAR:null,EXACT:function(e,t){return e===t},FIND:function(e,t,n){return t?t.indexOf(e,(void 0===n?0:n)-1)+1:null},FIXED:null,HTML2TEXT:function(e){var t="";return e&&(e instanceof Array?e.forEach((function(e){""!==t&&(t+="\n"),t+=e.replace(/<(?:.|\n)*?>/gm,"")})):t=e.replace(/<(?:.|\n)*?>/gm,"")),t},LEFT:function(t,n){return(n=e.parseNumber(void 0===n?1:n))instanceof Error||"string"!=typeof t?k.value:t?t.substring(0,n):null},LEN:function(e){return 0===arguments.length?k.error:"string"==typeof e?e?e.length:0:e.length?e.length:k.value},LOWER:function(e){return"string"!=typeof e?k.value:e?e.toLowerCase():e},MID:function(t,n,o){return n=e.parseNumber(n),o=e.parseNumber(o),e.anyIsError(n,o)||"string"!=typeof t?o:(--n,t.substring(n,n+o))},NUMBERVALUE:null,PRONETIC:null,PROPER:function(e){return void 0===e||0===e.length?k.value:(!0===e&&(e="TRUE"),!1===e&&(e="FALSE"),isNaN(e)&&"number"==typeof e?k.value:("number"==typeof e&&(e=""+e),e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))))},REGEXEXTRACT:function(e,t){return(e=e.match(new RegExp(t)))?e[1<e.length?e.length-1:0]:null},REGEXMATCH:function(e,t,n){return e=e.match(new RegExp(t)),n?e:!!e},REGEXREPLACE:function(e,t,n){return e.replace(new RegExp(t),n)},REPLACE:function(t,n,o,r){return n=e.parseNumber(n),o=e.parseNumber(o),e.anyIsError(n,o)||"string"!=typeof t||"string"!=typeof r?k.value:t.substr(0,n-1)+r+t.substr(n-1+o)},REPT:function(t,n){return(n=e.parseNumber(n))instanceof Error?n:Array(n+1).join(t)},RIGHT:function(t,n){return(n=e.parseNumber(void 0===n?1:n))instanceof Error?n:t?t.substring(t.length-n):null},SEARCH:function(e,t,n){return"string"!=typeof e||"string"!=typeof t?k.value:(n=void 0===n?0:n,0===(e=t.toLowerCase().indexOf(e.toLowerCase(),n-1)+1)?k.value:e)},SPLIT:function(e,t){return e.split(t)},SUBSTITUTE:function(e,t,n,o){if(!(e&&t&&n))return e;if(void 0===o)return e.replace(new RegExp(t,"g"),n);for(var r=0,i=0;0<e.indexOf(t,r);)if(r=e.indexOf(t,r+1),++i===o)return e.substring(0,r)+n+e.substring(r+t.length)},T:function(e){return"string"==typeof e?e:""},TEXT:null,TRIM:function(e){return"string"!=typeof e?k.value:e.replace(/ +/g," ").trim()}};return t.UNICHAR=t.CHAR,t.UNICODE=t.CODE,t.UPPER=function(e){return"string"!=typeof e?k.value:e.toUpperCase()},t.VALUE=null,t}(),y.stats=function(){var g={AVEDEV:null,AVERAGE:function(){for(var t=e.numbers(e.flatten(arguments)),n=t.length,o=0,r=0,i=0;i<n;i++)o+=t[i],r+=1;return o/r},AVERAGEA:function(){for(var t=e.flatten(arguments),n=t.length,o=0,r=0,i=0;i<n;i++){var a=t[i];"number"==typeof a&&(o+=a),!0===a&&o++,null!==a&&r++}return o/r},AVERAGEIF:function(b,a,c){if(c=c||b,b=e.flatten(b),c=e.parseNumberArray(e.flatten(c)),c instanceof Error)return c;for(var d=0,f=0,h=0;h<b.length;h++)eval(b[h]+a)&&(f+=c[h],d++);return f/d},AVERAGEIFS:null,COUNT:function(){return e.numbers(e.flatten(arguments)).length},COUNTA:function(){var t=e.flatten(arguments);return t.length-g.COUNTBLANK(t)},COUNTIN:function(e,t){for(var n=0,o=0;o<e.length;o++)e[o]===t&&n++;return n},COUNTBLANK:function(){for(var t,n=e.flatten(arguments),o=0,r=0;r<n.length;r++)null!==(t=n[r])&&""!==t||o++;return o},COUNTIF:function(){var b=e.argsToArray(arguments),a=b.pop();b=e.flatten(b),/[<>=!]/.test(a)||(a='=="'+a+'"');for(var c=0,d=0;d<b.length;d++)"string"!=typeof b[d]?eval(b[d]+a)&&c++:eval('"'+b[d]+'"'+a)&&c++;return c},COUNTIFS:function(){for(var b=e.argsToArray(arguments),a=Array(e.flatten(b[0]).length),c=0;c<a.length;c++)a[c]=!0;for(c=0;c<b.length;c+=2){var d=e.flatten(b[c]),f=b[c+1];/[<>=!]/.test(f)||(f='=="'+f+'"');for(var h=0;h<d.length;h++)a[h]="string"!=typeof d[h]?a[h]&&eval(d[h]+f):a[h]&&eval('"'+d[h]+'"'+f)}for(c=b=0;c<a.length;c++)a[c]&&b++;return b},COUNTUNIQUE:function(){return UNIQUE.apply(null,e.flatten(arguments)).length},FISHER:function(t){return(t=e.parseNumber(t))instanceof Error?t:Math.log((1+t)/(1-t))/2},FISHERINV:function(t){return(t=e.parseNumber(t))instanceof Error?t:((t=Math.exp(2*t))-1)/(t+1)},FREQUENCY:function(t,n){if(t=e.parseNumberArray(e.flatten(t)),n=e.parseNumberArray(e.flatten(n)),e.anyIsError(t,n))return k.value;for(var o=t.length,r=n.length,i=[],a=0;a<=r;a++)for(var l=i[a]=0;l<o;l++)0===a?t[l]<=n[0]&&(i[0]+=1):a<r?t[l]>n[a-1]&&t[l]<=n[a]&&(i[a]+=1):a===r&&t[l]>n[r-1]&&(i[r]+=1);return i},LARGE:function(t,n){return t=e.parseNumberArray(e.flatten(t)),n=e.parseNumber(n),e.anyIsError(t,n)?t:t.sort((function(e,t){return t-e}))[n-1]},MAX:function(){var t=e.numbers(e.flatten(arguments));return 0===t.length?0:Math.max.apply(Math,t)},MAXA:function(){var t=e.arrayValuesToNumbers(e.flatten(arguments));return 0===t.length?0:Math.max.apply(Math,t)},MIN:function(){var t=e.numbers(e.flatten(arguments));return 0===t.length?0:Math.min.apply(Math,t)},MINA:function(){var t=e.arrayValuesToNumbers(e.flatten(arguments));return 0===t.length?0:Math.min.apply(Math,t)},MODE:{}};return g.MODE.MULT=function(){var t=e.parseNumberArray(e.flatten(arguments));if(t instanceof Error)return t;for(var n,o=t.length,r={},i=[],a=0,l=0;l<o;l++)r[n=t[l]]=r[n]?r[n]+1:1,r[n]>a&&(a=r[n],i=[]),r[n]===a&&(i[i.length]=n);return i},g.MODE.SNGL=function(){var t=e.parseNumberArray(e.flatten(arguments));return t instanceof Error?t:g.MODE.MULT(t).sort((function(e,t){return e-t}))[0]},g.PERCENTILE={},g.PERCENTILE.EXC=function(t,n){if(t=e.parseNumberArray(e.flatten(t)),n=e.parseNumber(n),e.anyIsError(t,n))return k.value;var o=(t=t.sort((function(e,t){return e-t}))).length;return n<1/(o+1)||n>1-1/(o+1)?k.num:(n=n*(o+1)-1,o=Math.floor(n),e.cleanFloat(n===o?t[n]:t[o]+(n-o)*(t[o+1]-t[o])))},g.PERCENTILE.INC=function(t,n){if(t=e.parseNumberArray(e.flatten(t)),n=e.parseNumber(n),e.anyIsError(t,n))return k.value;n*=(t=t.sort((function(e,t){return e-t}))).length-1;var o=Math.floor(n);return e.cleanFloat(n===o?t[n]:t[o]+(n-o)*(t[o+1]-t[o]))},g.PERCENTRANK={},g.PERCENTRANK.EXC=function(t,n,o){if(o=void 0===o?3:o,t=e.parseNumberArray(e.flatten(t)),n=e.parseNumber(n),o=e.parseNumber(o),e.anyIsError(t,n,o))return k.value;t=t.sort((function(e,t){return e-t}));var r=UNIQUE.apply(null,t),i=t.length,a=r.length;o=Math.pow(10,o);for(var l=0,s=!1,u=0;!s&&u<a;)n===r[u]?(l=(t.indexOf(r[u])+1)/(i+1),s=!0):n>=r[u]&&(n<r[u+1]||u===a-1)&&(l=(t.indexOf(r[u])+1+(n-r[u])/(r[u+1]-r[u]))/(i+1),s=!0),u++;return Math.floor(l*o)/o},g.PERCENTRANK.INC=function(t,n,o){if(o=void 0===o?3:o,t=e.parseNumberArray(e.flatten(t)),n=e.parseNumber(n),o=e.parseNumber(o),e.anyIsError(t,n,o))return k.value;t=t.sort((function(e,t){return e-t}));var r=UNIQUE.apply(null,t),i=t.length,a=r.length;o=Math.pow(10,o);for(var l=0,s=!1,u=0;!s&&u<a;)n===r[u]?(l=t.indexOf(r[u])/(i-1),s=!0):n>=r[u]&&(n<r[u+1]||u===a-1)&&(l=(t.indexOf(r[u])+(n-r[u])/(r[u+1]-r[u]))/(i-1),s=!0),u++;return Math.floor(l*o)/o},g.PERMUT=function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:FACT(t)/FACT(t-n)},g.PERMUTATIONA=function(t,n){return t=e.parseNumber(t),n=e.parseNumber(n),e.anyIsError(t,n)?k.value:Math.pow(t,n)},g.PHI=function(t){return(t=e.parseNumber(t))instanceof Error?k.value:Math.exp(-.5*t*t)/2.5066282746310002},g.PROB=function(t,n,o,r){if(void 0===o)return 0;if(r=void 0===r?o:r,t=e.parseNumberArray(e.flatten(t)),n=e.parseNumberArray(e.flatten(n)),o=e.parseNumber(o),r=e.parseNumber(r),e.anyIsError(t,n,o,r))return k.value;if(o===r)return 0<=t.indexOf(o)?n[t.indexOf(o)]:0;for(var i=t.sort((function(e,t){return e-t})),a=i.length,l=0,s=0;s<a;s++)i[s]>=o&&i[s]<=r&&(l+=n[t.indexOf(i[s])]);return l},g.QUARTILE={},g.QUARTILE.EXC=function(t,n){if(t=e.parseNumberArray(e.flatten(t)),n=e.parseNumber(n),e.anyIsError(t,n))return k.value;switch(n){case 1:return g.PERCENTILE.EXC(t,.25);case 2:return g.PERCENTILE.EXC(t,.5);case 3:return g.PERCENTILE.EXC(t,.75);default:return k.num}},g.QUARTILE.INC=function(t,n){if(t=e.parseNumberArray(e.flatten(t)),n=e.parseNumber(n),e.anyIsError(t,n))return k.value;switch(n){case 1:return g.PERCENTILE.INC(t,.25);case 2:return g.PERCENTILE.INC(t,.5);case 3:return g.PERCENTILE.INC(t,.75);default:return k.num}},g.RANK={},g.RANK.AVG=function(t,n,o){if(t=e.parseNumber(t),n=e.parseNumberArray(e.flatten(n)),e.anyIsError(t,n))return k.value;o=(n=(n=e.flatten(n)).sort(o?function(e,t){return e-t}:function(e,t){return t-e})).length;for(var r=0,i=0;i<o;i++)n[i]===t&&r++;return 1<r?(2*n.indexOf(t)+r+1)/2:n.indexOf(t)+1},g.RANK.EQ=function(t,n,o){return t=e.parseNumber(t),n=e.parseNumberArray(e.flatten(n)),e.anyIsError(t,n)?k.value:(n=n.sort(o?function(e,t){return e-t}:function(e,t){return t-e})).indexOf(t)+1},g.RSQ=function(t,n){return t=e.parseNumberArray(e.flatten(t)),n=e.parseNumberArray(e.flatten(n)),e.anyIsError(t,n)?k.value:Math.pow(g.PEARSON(t,n),2)},g.SMALL=function(t,n){return t=e.parseNumberArray(e.flatten(t)),n=e.parseNumber(n),e.anyIsError(t,n)?t:t.sort((function(e,t){return e-t}))[n-1]},g.STANDARDIZE=function(t,n,o){return t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),e.anyIsError(t,n,o)?k.value:(t-n)/o},g.STDEV={},g.STDEV.P=function(){var e=g.VAR.P.apply(this,arguments);return Math.sqrt(e)},g.STDEV.S=function(){var e=g.VAR.S.apply(this,arguments);return Math.sqrt(e)},g.STDEVA=function(){var e=g.VARA.apply(this,arguments);return Math.sqrt(e)},g.STDEVPA=function(){var e=g.VARPA.apply(this,arguments);return Math.sqrt(e)},g.VAR={},g.VAR.P=function(){for(var t=e.numbers(e.flatten(arguments)),n=t.length,o=0,r=g.AVERAGE(t),i=0;i<n;i++)o+=Math.pow(t[i]-r,2);return o/n},g.VAR.S=function(){for(var t=e.numbers(e.flatten(arguments)),n=t.length,o=0,r=g.AVERAGE(t),i=0;i<n;i++)o+=Math.pow(t[i]-r,2);return o/(n-1)},g.VARA=function(){for(var t=e.flatten(arguments),n=t.length,o=0,r=0,i=g.AVERAGEA(t),a=0;a<n;a++){var l=t[a];o="number"==typeof l?o+Math.pow(l-i,2):!0===l?o+Math.pow(1-i,2):o+Math.pow(0-i,2),null!==l&&r++}return o/(r-1)},g.VARPA=function(){for(var t=e.flatten(arguments),n=t.length,o=0,r=0,i=g.AVERAGEA(t),a=0;a<n;a++){var l=t[a];o="number"==typeof l?o+Math.pow(l-i,2):!0===l?o+Math.pow(1-i,2):o+Math.pow(0-i,2),null!==l&&r++}return o/r},g.WEIBULL={},g.WEIBULL.DIST=function(t,n,o,r){return t=e.parseNumber(t),n=e.parseNumber(n),o=e.parseNumber(o),e.anyIsError(t,n,o)?k.value:r?1-Math.exp(-Math.pow(t/o,n)):Math.pow(t,n-1)*Math.exp(-Math.pow(t/o,n))*n/Math.pow(o,n)},g.Z={},g.Z.TEST=function(t,n,o){if(t=e.parseNumberArray(e.flatten(t)),n=e.parseNumber(n),e.anyIsError(t,n))return k.value;o=o||g.STDEV.S(t);var r=t.length;return 1-g.NORM.S.DIST((g.AVERAGE(t)-n)/(o/Math.sqrt(r)),!0)},g}(),y.utils={PROGRESS:function(e,t){return'<div style="width:'+(e||"0")+"%;height:4px;background-color:"+(t||"red")+';margin-top:1px;"></div>'},RATING:function(e){for(var t='<div class="jrating">',n=0;5>n;n++)t=n<e?t+'<div class="jrating-selected"></div>':t+"<div></div>";return t+"</div>"}};for(var G=0;G<Object.keys(y).length;G++)for(var B=y[Object.keys(y)[G]],z=Object.keys(B),x=0;x<z.length;x++)if(B[z[x]])if("function"==typeof B[z[x]]||"object"==typeof B[z[x]]){if(w[z[x]]=B[z[x]],w[z[x]].toString=function(){return"#ERROR"},"object"==typeof B[z[x]])for(var J=Object.keys(B[z[x]]),H=0;H<J.length;H++)w[z[x]][J[H]].toString=function(){return"#ERROR"}}else w[z[x]]=function(){return z[x]+"Not implemented"};else w[z[x]]=function(){return z[x]+"Not implemented"};var I=null,D=null,E=null;w.TABLE=function(){return E},w.COLUMN=w.COL=function(){return parseInt(I)+1},w.ROW=function(){return parseInt(D)+1},w.CELL=function(){return A.getColumnNameFromCoords(I,D)},w.VALUE=function(e,t,n){return E.getValueFromCoords(parseInt(e)-1,parseInt(t)-1,n)},w.THISROWCELL=function(e){return E.getValueFromCoords(parseInt(e)-1,parseInt(D))};var K=function(e,t){for(var n=0;n<e.length;n++){var o=A.getTokensFromRange(e[n]);t=t.replace(e[n],"["+o.join(",")+"]")}return t},A=function(e,t,n,o,r){if(E=r,I=n,D=o,o="",(r=Object.keys(t)).length){var i={};for(n=0;n<r.length;n++)if(0<(a=r[n].replace(/!/g,".")).indexOf(".")){var a=a.split(".");i[a[0]]={}}for(a=Object.keys(i),n=0;n<a.length;n++)o+="var "+a[n]+" = {};";for(n=0;n<r.length;n++)a=r[n].replace(/!/g,"."),(i=null!==t[r[n]])&&(i=t[r[n]],i=!(!isNaN(i)&&null!==i&&""!==i)),i&&(i=t[r[n]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&i.length&&(t[r[n]]=K(i,t[r[n]])),o=0<a.indexOf(".")?o+(a+" = ")+t[r[n]]+";\n":o+"var "+a+" = "+t[r[n]]+";\n"}for(e=(e=e.replace(/\$/g,"")).replace(/!/g,"."),t="",n=0,r=["=","!",">","<"],a=0;a<e.length;a++)'"'==e[a]&&(n=0==n?1:0),1==n?t+=e[a]:(t+=e[a].toUpperCase(),0<a&&"="==e[a]&&-1==r.indexOf(e[a-1])&&-1==r.indexOf(e[a+1])&&(t+="="));return(i=(e=t=(t=(t=(t=t.replace(/\^/g,"**")).replace(/<>/g,"!=")).replace(/&/g,"+")).replace(/\$/g,"")).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&i.length&&(e=K(i,e)),null===(o=new Function(o+"; return "+e)())&&(o=0),o};return A.getColumnNameFromCoords=function(e,t){var n="";return 701<(e=parseInt(e))?(n+=String.fromCharCode(64+parseInt(e/676)),n+=String.fromCharCode(64+parseInt(e%676/26))):25<e&&(n+=String.fromCharCode(64+parseInt(e/26))),(n+=String.fromCharCode(65+e%26))+(parseInt(t)+1)},A.getCoordsFromColumnName=function(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var n=0,o=0;o<t[0].length;o++)n+=parseInt(t[0].charCodeAt(o)-64)*Math.pow(26,t[0].length-1-o);return 0>--n&&(n=0),0<(e=parseInt(/[0-9]+$/.exec(e))||null)&&e--,[n,e]}},A.getRangeFromTokens=function(e){e=e.filter((function(e){return"#REF!"!=e}));for(var t="",n="",o=0;o<e.length;o++)0<=e[o].indexOf(".")?t=".":0<=e[o].indexOf("!")&&(t="!"),t&&(n=e[o].split(t),e[o]=n[1],n=n[0]+t);return e.sort((function(e,t){return e=Helpers.getCoordsFromColumnName(e),t=Helpers.getCoordsFromColumnName(t),e[1]>t[1]?1:e[1]<t[1]?-1:e[0]>t[0]?1:e[0]<t[0]?-1:0})),e.length?n+(e[0]+":")+e[e.length-1]:"#REF!"},A.getTokensFromRange=function(e){if(0<e.indexOf(".")){var t=e.split(".");e=t[1],t=t[0]+"."}else 0<e.indexOf("!")?(t=e.split("!"),e=t[1],t=t[0]+"!"):t="";e=e.split(":");var n=A.getCoordsFromColumnName(e[0]),o=A.getCoordsFromColumnName(e[1]);if(n[0]<=o[0]){e=n[0];var r=o[0]}else e=o[0],r=n[0];if(null===n[1]&&null==o[1])for(var i=null,a=null,l=Object.keys(vars),s=0;s<l.length;s++){var u=A.getCoordsFromColumnName(l[s]);u[0]===n[0]&&(null===i||u[1]<i)&&(i=u[1]),u[0]===o[0]&&(null===a||u[1]>a)&&(a=u[1])}else n[1]<=o[1]?(i=n[1],a=o[1]):(i=o[1],a=n[1]);for(n=[];i<=a;i++){for(o=[],s=e;s<=r;s++)o.push(t+A.getColumnNameFromCoords(s,i));n.push(o)}return n},A.setFormula=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)"function"==typeof e[t[n]]&&(w[t[n]]=e[t[n]])},A};return"undefined"!=typeof window?F(window):null},"object"==typeof exports&&void 0!==module?module.exports=w():"function"==typeof define&&define.amd?define(w):F.formula=w()},{}],2:[function(e,t,n){!function(e,o){"object"==typeof n&&void 0!==t?t.exports=o():"function"==typeof define&&define.amd?define(o):e.jSuites=o()}(this,(function(){"use strict";var e={};"undefined"==typeof document||document.jsuitesComponents||function(){document.jsuitesComponents=[];var t=function(e,n){return!(!e[n.type]||e[n.type]!=n)||!(!e.component||e.component!=n)||!!e.parentNode&&t(e.parentNode,n)},n=15,o=null,r=!1,i={x:null,y:null},a=document.createElement("div");a.classList.add("jtooltip"),document.addEventListener("mouseup",(function(e){r&&r.e&&("function"==typeof r.e.refresh&&i.actioned&&r.e.refresh(),r.e.style.cursor=""),i={x:null,y:null},r=!1})),document.addEventListener("mousedown",(function(n){var i=e.findElement(n.target,"jpanel");if(i&&!i.classList.contains("readonly")){i.focus();var a=n.target.getBoundingClientRect();r={e:i,x:n.clientX,y:n.clientY,w:a.width,h:a.height,d:i.style.cursor,resizing:!!i.style.cursor,actioned:!1},i.style.width||(i.style.width=a.width+"px"),i.style.height||(i.style.height=a.height+"px");var l=window.getSelection();if(l.rangeCount)for(var s=0;s<l.rangeCount;s++)l.removeRange(l.getRangeAt(s));n.preventDefault(),n.stopPropagation()}else r=!1;if(n.changedTouches&&n.changedTouches[0])var u=n.changedTouches[0].clientX,c=n.changedTouches[0].clientY;else u=n.clientX,c=n.clientY;var d=event.path||event.composedPath&&event.composedPath();if(d)o=d[0];else{if(n.target&&n.target.shadowRoot)var p=n.target.shadowRoot;else p=document;o=p.elementFromPoint(u,c)}!function(e){if(document.jsuitesComponents&&document.jsuitesComponents.length>0)for(var n=0;n<document.jsuitesComponents.length;n++)document.jsuitesComponents[n]&&!t(e,document.jsuitesComponents[n])&&document.jsuitesComponents[n].close()}(o)})),document.addEventListener("mousemove",(function(t){if(r){var o=t.clientX||t.pageX,a=t.clientY||t.pageY;if(r.resizing){var l=null,s=null;if("e-resize"==r.d||"ne-resize"==r.d||"se-resize"==r.d)if(l=r.w+(o-r.x),r.e.style.width=l+"px",t.shiftKey){var u=(o-r.x)*(r.h/r.w);s=r.h+u,r.e.style.height=s+"px"}else u=!1;u||"s-resize"!=r.d&&"se-resize"!=r.d&&"sw-resize"!=r.d||(s=r.h+(a-r.y),r.e.style.height=s+"px"),"function"==typeof r.e.refresh&&(i.actioned=!0,r.e.refresh("dimensions",l,s))}else{null==i.x&&null==i.y&&(i.x=o,i.y=a);var c=o-i.x,d=a-i.y,p=r.e.offsetTop+d,f=r.e.offsetLeft+c;r.e.style.top=p+"px",r.e.style.left=f+"px",r.e.style.cursor="move",i.x=o,i.y=a,"function"==typeof r.e.refresh&&(i.actioned=!0,r.e.refresh("position",p,f))}}else{var h=e.findElement(t.target,"jpanel");if(h&&h.getAttribute("tabindex")){var b=h.getBoundingClientRect();t.clientY-b.top<n?b.width-(t.clientX-b.left)<n?h.style.cursor="ne-resize":t.clientX-b.left<n?h.style.cursor="nw-resize":h.style.cursor="n-resize":b.height-(t.clientY-b.top)<n?b.width-(t.clientX-b.left)<n?h.style.cursor="se-resize":t.clientX-b.left<n?h.style.cursor="sw-resize":h.style.cursor="s-resize":b.width-(t.clientX-b.left)<n?h.style.cursor="e-resize":t.clientX-b.left<n?h.style.cursor="w-resize":h.style.cursor=""}}})),document.addEventListener("mouseover",(function(e){var t=e.target.getAttribute("data-tooltip");if(t){if(a.innerText=t,e.changedTouches&&e.changedTouches[0])var n=e.changedTouches[0].clientX,o=e.changedTouches[0].clientY;else n=e.clientX,o=e.clientY;a.style.top=o+"px",a.style.left=n+"px",document.body.appendChild(a)}else a.innerText&&(a.innerText="",document.body.removeChild(a))})),document.addEventListener("dblclick",(function(t){var n=e.findElement(t.target,"jpanel");n&&"function"==typeof n.dblclick&&n.dblclick(t)})),document.addEventListener("keydown",(function(e){var t=document.activeElement;t&&"Delete"==e.key&&"function"==typeof t.delete&&(t.delete(),e.preventDefault(),e.stopImmediatePropagation()),document.jsuitesComponents&&document.jsuitesComponents.length&&(t=document.jsuitesComponents[document.jsuitesComponents.length-1])&&"Escape"==e.key&&"function"==typeof t.close&&(t.close(),e.preventDefault(),e.stopImmediatePropagation())})),document.addEventListener("contextmenu",(function(t){var n=document.activeElement;if(n&&"function"==typeof n.contextmenu)n.contextmenu(t),t.preventDefault(),t.stopImmediatePropagation();else if(n=e.findElement(t.target,(function(e){return e.tagName&&e.getAttribute("aria-contextmenu-id")})),n){var o=document.querySelector("#"+n);o?(o.contextmenu.open(t),t.preventDefault(),t.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+n)}}))}(),e.version="4.13.5",e.setExtensions=function(t){if("object"==typeof t)for(var n=Object.keys(t),o=0;o<n.length;o++)e[n[o]]=t[n[o]]},e.tracking=function(e,t){if(1==t)document.jsuitesComponents=document.jsuitesComponents.filter((function(e){return null!==e})),setTimeout((function(){document.jsuitesComponents.push(e)}),0);else{var n=document.jsuitesComponents.indexOf(e);n>=0&&document.jsuitesComponents.splice(n,1)}},e.path=function(e,t){if((e=e.split(".")).length){for(var n=this,o=null;e.length>1;)if(o=e.shift(),n.hasOwnProperty(o))n=n[o];else{if(void 0===t)return;n[o]={},n=n[o]}if(o=e.shift(),void 0!==t)return n[o]=t,!0;if(n)return n[o]}return!1},e.setDictionary=function(t){document.dictionary||(document.dictionary={});for(var n=Object.keys(t),o=0;o<n.length;o++)document.dictionary[n[o]]=t[n[o]];var r=null;for(o=0;o<e.calendar.weekdays.length;o++)r=e.translate(e.calendar.weekdays[o]),e.calendar.weekdays[o]&&(e.calendar.weekdays[o]=r,e.calendar.weekdaysShort[o]=r.substr(0,3));for(o=0;o<e.calendar.months.length;o++)(r=e.translate(e.calendar.months[o]))&&(e.calendar.months[o]=r,e.calendar.monthsShort[o]=r.substr(0,3))},e.translate=function(e){return document.dictionary&&document.dictionary[e]||e},e.ajax=function(t,n){if(Array.isArray(t)){var o={instance:[],complete:n};if(t.length>0)for(var r=0;r<t.length;r++)t[r].multiple=o,o.instance.push(e.ajax(t[r]));return o}if(t.data||(t.data={}),t.type&&(t.method=t.type),t.method||(t.method="GET"),t.dataType||(t.dataType="json"),t.data){var i=function(e,t){var n=[];if(e){var o=Object.keys(e);if(o.length)for(var r=0;r<o.length;r++){if(t)var a=t+"["+o[r]+"]";else a=o[r];if(e[a]instanceof FileList)n[a]=e[o[r]];else if(null===e[o[r]]||void 0===e[o[r]])n[a]="";else if("object"==typeof e[o[r]])for(var l=i(e[o[r]],a),s=Object.keys(l),u=0;u<s.length;u++)n[s[u]]=l[s[u]];else n[a]=e[o[r]]}}return n},a=i(t.data),l=Object.keys(a);if("GET"==t.method){if(l.length){var s=[];for(r=0;r<l.length;r++)s.push(l[r]+"="+encodeURIComponent(a[l[r]]));t.url.indexOf("?")<0&&(t.url+="?"),t.url+=s.join("&")}}else for(s=new FormData,r=0;r<l.length;r++)if(a[l[r]]instanceof FileList){if(a[l[r]].length)for(var u=0;u<a[l[r]].length;u++)s.append(l[r],a[l[r]][u],a[l[r]][u].name)}else s.append(l[r],a[l[r]])}var c=new XMLHttpRequest;return c.open(t.method,t.url,!0),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.contentType&&c.setRequestHeader("Content-Type",t.contentType),"POST"==t.method?c.setRequestHeader("Accept","application/json"):"blob"==t.dataType?c.responseType="blob":t.contentType||("json"==t.dataType?c.setRequestHeader("Content-Type","text/json"):"html"==t.dataType&&c.setRequestHeader("Content-Type","text/html")),1!=t.cache&&(c.setRequestHeader("pragma","no-cache"),c.setRequestHeader("cache-control","no-cache")),1==t.withCredentials&&(c.withCredentials=!0),"function"==typeof t.beforeSend&&t.beforeSend(c),"function"==typeof e.ajax.beforeSend&&e.ajax.beforeSend(c),document.ajax&&"function"==typeof document.ajax.beforeSend&&document.ajax.beforeSend(c),c.onload=function(){if(200===c.status)if("json"==t.dataType)try{var n=JSON.parse(c.responseText);t.success&&"function"==typeof t.success&&t.success(n)}catch(e){t.error&&"function"==typeof t.error&&t.error(e,n)}else{if("blob"==t.dataType)n=c.response;else n=c.responseText;t.success&&"function"==typeof t.success&&t.success(n)}else t.error&&"function"==typeof t.error&&t.error(c.responseText,c.status);if(e.ajax.queue&&e.ajax.queue.length>0&&e.ajax.send(e.ajax.queue.shift()),e.ajax.requests&&e.ajax.requests.length){var o=e.ajax.requests.indexOf(c);if(e.ajax.requests.splice(o,1),e.ajax.requests.length||t.complete&&"function"==typeof t.complete&&t.complete(n),t.group&&e.ajax.oncomplete&&"function"==typeof e.ajax.oncomplete[t.group]&&(e.ajax.pending(t.group)||(e.ajax.oncomplete[t.group](),e.ajax.oncomplete[t.group]=null)),t.multiple&&t.multiple.instance){o=t.multiple.instance.indexOf(c);t.multiple.instance.splice(o,1),t.multiple.instance.length||t.multiple.complete&&"function"==typeof t.multiple.complete&&t.multiple.complete(n)}}},c.options=t,c.data=s,1==t.queue&&e.ajax.requests.length>0?e.ajax.queue.push(c):e.ajax.send(c),c},e.ajax.send=function(t){t.data?Array.isArray(t.data)?t.send(t.data.join("&")):t.send(t.data):t.send(),e.ajax.requests.push(t)},e.ajax.exists=function(e,t){var n=new XMLHttpRequest;n.open("HEAD",e,!1),n.send(),n.status&&t(n.status)},e.ajax.pending=function(t){var n=0,o=e.ajax.requests;if(o&&o.length)for(var r=0;r<o.length;r++)t&&t!=o[r].options.group||n++;return n},e.ajax.oncomplete={},e.ajax.requests=[],e.ajax.queue=[],e.alert=function(t){e.getWindowWidth()<800&&e.dialog?e.dialog.open({title:"Alert",message:t}):alert(t)},e.animation={},e.animation.slideLeft=function(e,t,n){1==t?(e.classList.add("slide-left-in"),setTimeout((function(){e.classList.remove("slide-left-in"),"function"==typeof n&&n()}),400)):(e.classList.add("slide-left-out"),setTimeout((function(){e.classList.remove("slide-left-out"),"function"==typeof n&&n()}),400))},e.animation.slideRight=function(e,t,n){1==t?(e.classList.add("slide-right-in"),setTimeout((function(){e.classList.remove("slide-right-in"),"function"==typeof n&&n()}),400)):(e.classList.add("slide-right-out"),setTimeout((function(){e.classList.remove("slide-right-out"),"function"==typeof n&&n()}),400))},e.animation.slideTop=function(e,t,n){1==t?(e.classList.add("slide-top-in"),setTimeout((function(){e.classList.remove("slide-top-in"),"function"==typeof n&&n()}),400)):(e.classList.add("slide-top-out"),setTimeout((function(){e.classList.remove("slide-top-out"),"function"==typeof n&&n()}),400))},e.animation.slideBottom=function(e,t,n){1==t?(e.classList.add("slide-bottom-in"),setTimeout((function(){e.classList.remove("slide-bottom-in"),"function"==typeof n&&n()}),400)):(e.classList.add("slide-bottom-out"),setTimeout((function(){e.classList.remove("slide-bottom-out"),"function"==typeof n&&n()}),100))},e.animation.fadeIn=function(e,t){e.style.display="",e.classList.add("fade-in"),setTimeout((function(){e.classList.remove("fade-in"),"function"==typeof t&&t()}),2e3)},e.animation.fadeOut=function(e,t){e.classList.add("fade-out"),setTimeout((function(){e.style.display="none",e.classList.remove("fade-out"),"function"==typeof t&&t()}),1e3)},e.calendar=function(t,n){if(t.calendar)return t.calendar.setOptions(n,!0);var o={type:"calendar",options:{},date:null,setOptions:function(n,r){for(var i={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:e.calendar.monthsShort,monthsFull:e.calendar.months,weekdays:e.calendar.weekdays,weekdays_short:e.calendar.weekdays,textDone:e.translate("Done"),textReset:e.translate("Reset"),textUpdate:e.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null},a=0;a<i.weekdays_short.length;a++)i.weekdays_short[a]=i.weekdays_short[a].substr(0,1);for(var l in i)n&&n.hasOwnProperty(l)?o.options[l]=n[l]:void 0!==o.options[l]&&!0!==r||(o.options[l]=i[l]);if(0==o.options.resetButton?s.style.display="none":s.style.display="",o.options.readonly?t.setAttribute("readonly","readonly"):t.removeAttribute("readonly"),o.options.placeholder?t.setAttribute("placeholder",o.options.placeholder):t.removeAttribute("placeholder"),e.isNumeric(o.options.value)&&o.options.value>0&&(o.options.value=e.calendar.numToDate(o.options.value),o.options.dataType="numeric"),s.innerHTML=o.options.textReset,u.innerHTML=o.options.textDone,v.innerHTML=o.options.textUpdate,t.setAttribute("data-mask",o.options.format.toLowerCase()),!o.options.value&&o.options.today)var c=e.calendar.now();else c=o.options.value;return c&&(o.options.value=null,o.setValue(c)),o},open:function(n){if(!l.classList.contains("jcalendar-focus")&&!l.classList.contains("jcalendar-inline")){if(e.calendar.current=o,e.tracking(o,!0),o.getDays(),"year-month-picker"==o.options.type&&o.getMonths(),o.options.time&&(y.value=o.date[3],x.value=o.date[4]),l.classList.add("jcalendar-focus"),e.getWindowWidth()<800||o.options.fullscreen)l.classList.add("jcalendar-fullsize"),e.animation.slideBottom(d,1);else{l.classList.remove("jcalendar-fullsize");var r=t.getBoundingClientRect(),i=d.getBoundingClientRect();if(o.options.position)c.style.position="fixed",window.innerHeight<r.bottom+i.height?c.style.top=r.top-(i.height+2)+"px":c.style.top=r.top+r.height+2+"px",c.style.left=r.left+"px";else{if(window.innerHeight<r.bottom+i.height)(a=-1*(r.height+i.height+2))+r.top<0&&(a=-1*(r.top+r.height)),c.style.top=a+"px";else c.style.top="2px";if(window.innerWidth<r.left+i.width){var a=window.innerWidth-(r.left+i.width+20);c.style.left=a+"px"}else c.style.left="0px"}}"function"==typeof o.options.onopen&&o.options.onopen(t)}},close:function(n,r){if(l.classList.contains("jcalendar-focus")){if(!1!==r){var i=l.querySelector(".jcalendar-selected");if("string"==typeof r)var a=r;else if(!i||i.classList.contains("jcalendar-disabled"))a=o.options.value;else a=o.getValue();o.setValue(a)}n||"function"!=typeof o.options.onclose||o.options.onclose(t),l.classList.remove("jcalendar-focus"),e.tracking(o,!1),e.calendar.current=null}return o.options.value},prev:function(){"years"==o.options.mode?(o.date[0]=o.date[0]-12,o.getYears()):"months"==o.options.mode?(o.date[0]=parseInt(o.date[0])-1,o.getMonths()):(o.date[1]<2?(o.date[0]=o.date[0]-1,o.date[1]=12):o.date[1]=o.date[1]-1,o.getDays())},next:function(){"years"==o.options.mode?(o.date[0]=parseInt(o.date[0])+12,o.getYears()):"months"==o.options.mode?(o.date[0]=parseInt(o.date[0])+1,o.getMonths()):(o.date[1]>11?(o.date[0]=parseInt(o.date[0])+1,o.date[1]=1):o.date[1]=parseInt(o.date[1])+1,o.getDays())},setToday:function(){var e=(new Date).toISOString().substr(0,10);return o.setValue(e),e},setValue:function(e){e||(e=""+e);var n=e,r=o.options.value;if(r!=n){if(n){o.setLabel(n,o.options);(a=n.split(" "))[1]||(a[1]="00:00:00");var i=a[1].split(":"),a=a[0].split("-"),l=parseInt(a[0]),s=parseInt(a[1]),u=parseInt(a[2]),c=parseInt(i[0]),d=parseInt(i[1]);o.date=[l,s,u,c,d,0];e=o.setLabel(n,o.options)}else{o.date=null;var e=""}o.options.value=n,"function"==typeof o.options.onchange&&o.options.onchange(t,n,r),t.value!=e&&(t.value=e,"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value}))}o.getDays()},getValue:function(){return o.date?o.options.time?e.two(o.date[0])+"-"+e.two(o.date[1])+"-"+e.two(o.date[2])+" "+e.two(o.date[3])+":"+e.two(o.date[4])+":"+e.two(0):e.two(o.date[0])+"-"+e.two(o.date[1])+"-"+e.two(o.date[2])+" "+e.two(0)+":"+e.two(0)+":"+e.two(0):""},update:function(e,t){if(e.classList.contains("jcalendar-disabled"));else{var n=l.querySelector(".jcalendar-selected");n&&n.classList.remove("jcalendar-selected"),e.classList.add("jcalendar-selected"),e.classList.contains("jcalendar-set-month")?(o.date[1]=t,o.date[2]=1):o.date[2]=e.innerText,o.options.time?(o.date[3]=y.value,o.date[4]=x.value):o.close()}a()},reset:function(){o.setValue(""),o.date=null,o.close(!1,!1)},getDays:function(){o.options.mode="days";var t=new Date,n=o.date&&e.isNumeric(o.date[0])?o.date[0]:parseInt(t.getFullYear()),r=o.date&&e.isNumeric(o.date[1])?o.date[1]:parseInt(t.getMonth())+1,i=o.date&&e.isNumeric(o.date[2])?o.date[2]:parseInt(t.getDate()),l=o.date&&e.isNumeric(o.date[3])?o.date[3]:parseInt(t.getHours()),s=o.date&&e.isNumeric(o.date[4])?o.date[4]:parseInt(t.getMinutes());o.date=[n,r,i,l,s,0],p.innerHTML=n,f.innerHTML=o.options.months[r-1];var u=t.getMonth()==r-1&&t.getFullYear()==n,c=t.getDate(),d=(t=new Date(n,r,0,0,0)).getDate(),h=(t=new Date(n,r-1,0,0,0)).getDay()+1;h-=j=o.options.startingDay||0,b.innerHTML="",(x=document.createElement("tr")).setAttribute("align","center"),b.appendChild(x);for(var g=0;g<7;g++){(w=document.createElement("td")).classList.add("jcalendar-weekday"),w.innerHTML=o.options.weekdays_short[j],x.appendChild(w),++j>6&&(j=0)}for(var j=0,v=0,y=0;y<6;y++){var x;(x=document.createElement("tr")).setAttribute("align","center");var C=!0;for(g=0;g<7;g++){var w;if((w=document.createElement("td")).classList.add("jcalendar-set-day"),j>=h&&j<h+d){v++,w.innerHTML=v,v==i&&w.classList.add("jcalendar-selected"),u&&c==v&&(w.style.fontWeight="bold");var E=e.calendar.now(new Date(n,r-1,v),!0);if(o.options.validRange){if(!o.options.validRange[0]||E>=o.options.validRange[0])var A=!0;else A=!1;if(!o.options.validRange[1]||E<=o.options.validRange[1])var L=!0;else L=!1;A&&L||w.classList.add("jcalendar-disabled")}C=!1}x.appendChild(w),j++}0==C&&b.appendChild(x)}o.options.time?m.style.display="":m.style.display="none",a()},getMonths:function(){o.options.mode="months";var t=o.options.months,n=(o.options.value,new Date),r=parseInt(n.getFullYear()),i=parseInt(n.getMonth())+1,l=o.date&&e.isNumeric(o.date[0])?o.date[0]:r,s=o.date&&e.isNumeric(o.date[1])?o.date[1]:i;p.innerHTML=o.date[0],f.innerHTML=t[s-1];var u=document.createElement("table");u.setAttribute("width","100%");for(var c=null,d=0;d<12;d++){if(!(d%4))(c=document.createElement("tr")).setAttribute("align","center"),u.appendChild(c);var h=document.createElement("td");if(h.classList.add("jcalendar-set-month"),h.setAttribute("data-value",d+1),h.innerText=t[d],o.options.validRange){var g=l+"-"+e.two(d+1);if(!o.options.validRange[0]||g>=o.options.validRange[0].substr(0,7))var m=!0;else m=!1;if(!o.options.validRange[1]||g<=o.options.validRange[1].substr(0,7))var j=!0;else j=!1;m&&j||h.classList.add("jcalendar-disabled")}d+1==s&&h.classList.add("jcalendar-selected"),r==l&&d+1==i&&(h.style.fontWeight="bold"),c.appendChild(h)}b.innerHTML='<tr><td colspan="7"></td></tr>',b.children[0].children[0].appendChild(u),a()},getYears:function(){o.options.mode="years";for(var t=new Date,n=t.getFullYear(),r=o.date&&e.isNumeric(o.date[0])?o.date[0]:parseInt(t.getFullYear()),i=[],l=0;l<25;l++)i[l]=parseInt(o.date[0])+(l-12);var s=document.createElement("table");s.setAttribute("width","100%");for(l=0;l<25;l++){if(!(l%5)){var u=document.createElement("tr");u.setAttribute("align","center"),s.appendChild(u)}var c=document.createElement("td");c.classList.add("jcalendar-set-year"),c.innerText=i[l],r==i[l]&&c.classList.add("jcalendar-selected"),n==i[l]&&(c.style.fontWeight="bold"),u.appendChild(c)}b.innerHTML='<tr><td colspan="7"></td></tr>',b.firstChild.firstChild.appendChild(s),a()},setLabel:function(t,n){return e.calendar.getDateString(t,n)},fromFormatted:function(t,n){return e.calendar.extractDateFromString(t,n)}},r=function(t){if(e.findElement(t.target,"jcalendar-container")){var n=t.target.className;if("jcalendar-prev"==n)o.prev();else if("jcalendar-next"==n)o.next();else if("jcalendar-month"==n)o.getMonths();else if("jcalendar-year"==n)o.getYears();else if("jcalendar-set-year"==n)o.date[0]=t.target.innerText,"year-month-picker"==o.options.type?o.getMonths():o.getDays();else if(t.target.classList.contains("jcalendar-set-month")){var r=parseInt(t.target.getAttribute("data-value"));"year-month-picker"==o.options.type?o.update(t.target,r):(o.date[1]=r,o.getDays())}else"jcalendar-confirm"==n||"jcalendar-update"==n||"jcalendar-close"==n?o.close():"jcalendar-backdrop"==n?o.close(!1,!1):"jcalendar-reset"==n?o.reset():t.target.classList.contains("jcalendar-set-day")&&t.target.innerText&&o.update(t.target)}else o.close()},i=function(t){if(t.target.value&&t.target.value.length>3){var n=e.calendar.extractDateFromString(t.target.value,o.options.format);n&&o.setValue(n)}},a=function(){var e=l.querySelector(".jcalendar-selected");e&&e.classList.contains("jcalendar-disabled")?(v.setAttribute("disabled","disabled"),y.setAttribute("disabled","disabled"),x.setAttribute("disabled","disabled")):(v.removeAttribute("disabled"),y.removeAttribute("disabled"),x.removeAttribute("disabled")),"function"==typeof o.options.onupdate&&o.options.onupdate(t,o.getValue())},l=null,s=null,u=null,c=null,d=null,p=null,f=null,h=null,b=null,g=null,m=null,j=null,v=null,y=null,x=null;return function(){"INPUT"==t.tagName&&t.value&&(n.value=t.value),(s=document.createElement("div")).className="jcalendar-reset",(u=document.createElement("div")).className="jcalendar-confirm",(g=document.createElement("div")).className="jcalendar-controls",g.style.borderBottom="1px solid #ddd",g.appendChild(s),g.appendChild(u),(c=document.createElement("div")).className="jcalendar-container",(d=document.createElement("div")).className="jcalendar-content",c.appendChild(d),"DIV"==t.tagName?(l=t).classList.add("jcalendar-inline"):(d.appendChild(g),(l=document.createElement("div")).className="jcalendar"),l.classList.add("jcalendar-container"),l.appendChild(c);var a=document.createElement("div");a.className="jcalendar-table",d.appendChild(a);var C=document.createElement("td");C.setAttribute("colspan","2"),C.className="jcalendar-prev",(p=document.createElement("span")).className="jcalendar-year",(f=document.createElement("span")).className="jcalendar-month";var w=document.createElement("td");w.className="jcalendar-header",w.setAttribute("colspan","3"),w.appendChild(f),w.appendChild(p);var E=document.createElement("td");E.setAttribute("colspan","2"),E.className="jcalendar-next";var A=document.createElement("thead"),L=document.createElement("tr");L.appendChild(C),L.appendChild(w),L.appendChild(E),A.appendChild(L),h=document.createElement("table"),b=document.createElement("tbody"),h.setAttribute("cellpadding","0"),h.setAttribute("cellspacing","0"),h.appendChild(A),h.appendChild(b),a.appendChild(h),(y=document.createElement("select")).className="jcalendar-select",y.onchange=function(){o.date[3]=this.value,"function"==typeof o.options.onupdate&&o.options.onupdate(t,o.getValue())};for(var N=0;N<24;N++){(I=document.createElement("option")).value=N,I.innerHTML=e.two(N),y.appendChild(I)}(x=document.createElement("select")).className="jcalendar-select",x.onchange=function(){o.date[4]=this.value,"function"==typeof o.options.onupdate&&o.options.onupdate(t,o.getValue())};for(N=0;N<60;N++){var I;(I=document.createElement("option")).value=N,I.innerHTML=e.two(N),x.appendChild(I)}var M=document.createElement("div");M.className="jcalendar-controls",(m=document.createElement("div")).className="jcalendar-time",m.style.maxWidth="140px",m.appendChild(y),m.appendChild(x),(v=document.createElement("button")).setAttribute("type","button"),v.className="jcalendar-update",(j=document.createElement("div")).style.flexGrow="10",j.appendChild(v),M.appendChild(m),"INPUT"==t.tagName&&M.appendChild(j),d.appendChild(M);var k=document.createElement("div");k.className="jcalendar-backdrop",l.appendChild(k),t.addEventListener("keyup",i),l.addEventListener("swipeleft",(function(t){e.animation.slideLeft(h,0,(function(){o.next(),e.animation.slideRight(h,1)})),t.preventDefault(),t.stopPropagation()})),l.addEventListener("swiperight",(function(t){e.animation.slideRight(h,0,(function(){o.prev(),e.animation.slideLeft(h,1)})),t.preventDefault(),t.stopPropagation()})),t.onmouseup=function(){o.open()},"ontouchend"in document.documentElement==!0?l.addEventListener("touchend",r):l.addEventListener("mouseup",r),e.calendar.hasEvents||(e.calendar.hasEvents=!0,document.addEventListener("keydown",e.calendar.keydown)),o.setOptions(n),"INPUT"==t.tagName?(t.parentNode.insertBefore(l,t.nextSibling),t.setAttribute("autocomplete","off"),t.classList.add("jcalendar-input"),t.value=o.setLabel(o.getValue(),o.options)):(o.getDays(),o.options.time&&(y.value=o.date[3],x.value=o.date[4])),1==o.options.opened&&o.open(),t.change=o.setValue,t.val=function(e){if(void 0===e)return o.getValue();o.setValue(e)},t.calendar=l.calendar=o}(),o},e.calendar.keydown=function(t){var n=null;(n=e.calendar.current)&&(13==t.which?n.close(!1,!0):27==t.which&&n.close(!1,!1))},e.calendar.prettify=function(e,t){if(!t)t={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};var n=new Date,o=new Date(e),r=parseInt((n-o)/1e3/60);if(String.prototype.format=function(e){return this.replace("{0}",e)},0==r)var i=t.justNow;else if(r<90)i=t.xMinutesAgo.format(r);else if(r<1440)i=t.xHoursAgo.format(Math.round(r/60));else if(r<20160)i=t.xDaysAgo.format(Math.round(r/1440));else if(r<43200)i=t.xWeeksAgo.format(Math.round(r/10080));else if(r<1036800)i=t.xMonthsAgo.format(Math.round(r/43200));else i=t.xYearsAgo.format(Math.round(r/525600));return i},e.calendar.prettifyAll=function(){for(var t=document.querySelectorAll(".prettydate"),n=0;n<t.length;n++)t[n].getAttribute("data-date")?t[n].innerHTML=e.calendar.prettify(t[n].getAttribute("data-date")):t[n].innerHTML&&(t[n].setAttribute("title",t[n].innerHTML),t[n].setAttribute("data-date",t[n].innerHTML),t[n].innerHTML=e.calendar.prettify(t[n].innerHTML))},e.calendar.now=function(t,n){if(Array.isArray(t))var o=t[0],r=t[1],i=t[2],a=t[3],l=t[4],s=t[5];else{if(!t)t=new Date;o=t.getFullYear(),r=t.getMonth()+1,i=t.getDate(),a=t.getHours(),l=t.getMinutes(),s=t.getSeconds()}return 1==n?e.two(o)+"-"+e.two(r)+"-"+e.two(i):e.two(o)+"-"+e.two(r)+"-"+e.two(i)+" "+e.two(a)+":"+e.two(l)+":"+e.two(s)},e.calendar.toArray=function(e){var t=(n=e.split(-1!==e.indexOf("T")?"T":" "))[1],n=n[0].split("-"),o=parseInt(n[0]),r=parseInt(n[1]),i=parseInt(n[2]);if(t){t=t.split(":");var a=parseInt(t[0]),l=parseInt(t[1])}else a=0,l=0;return[o,r,i,a,l,0]},e.calendar.extractDateFromString=function(t,n){if(t>0&&Number(t)==t){var o=new Date(Math.round(86400*(t-25569)*1e3));return o.getFullYear()+"-"+e.two(o.getMonth())+"-"+e.two(o.getDate())+" 00:00:00"}var r=e.mask(t,{mask:n},!0);return r.date[0]&&r.date[1]?(r.date[2]||(r.date[2]=1),r.date[0]+"-"+e.two(r.date[1])+"-"+e.two(r.date[2])+" "+e.two(r.date[3])+":"+e.two(r.date[4])+":"+e.two(r.date[5])):""};var t,n,o=Date.UTC(1900,0,0),r=Date.UTC(1900,1,29),i=864e5;return e.calendar.dateToNum=function(e){"string"==typeof e&&(e=new Date(e+"  GMT+0"));var t=e.getTime();return t>=r&&(t+=i),(t-=o)/i},e.calendar.numToDate=function(t){var n=o+t*i;n>=r&&(n-=i);const a=new Date(n);var l=[a.getUTCFullYear(),a.getUTCMonth()+1,a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds()];return e.calendar.now(l)},e.calendar.getDateString=function(t,n){if(!n)n={};if(n&&"object"==typeof n)var o=n.format;else o=n;if(o||(o="YYYY-MM-DD"),"number"==typeof t&&o.indexOf("[h]")>=0){var r=parseFloat(24*Number(t));if(o.indexOf("mm")>=0){if((d=(""+r).split("."))[1]){var i=60*parseFloat("0."+d[1]);i=parseFloat(i.toFixed(2))}else i=0;r=parseInt(d[0])+":"+e.two(i)}return r}t instanceof Date?t=e.calendar.now(t):t&&e.isNumeric(t)&&(t=e.calendar.numToDate(t));for(var a=new RegExp(["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."].join("|"),"gi"),l=o.match(a),s=0;s<l.length;s++)"MM"==l[s].toUpperCase()&&(l[s-1]&&l[s-1].toUpperCase().indexOf("H")>=0||l[s-2]&&l[s-2].toUpperCase().indexOf("H")>=0||l[s+1]&&l[s+1].toUpperCase().indexOf("S")>=0||l[s+2]&&l[s+2].toUpperCase().indexOf("S")>=0)&&(l[s]="mi");var u={tokens:l};if(t){var c=-1!==(i=""+t).indexOf("T")?"T":" ",d=0,p=0,f=0;if((i=i.split(c))[1]&&(p=(d=i[1].split(":"))[1]?d[1]:0,f=d[2]?d[2]:0,d=d[0]?d[0]:0),(i=i[0].split("-"))[0]&&i[1]&&i[2]&&i[0]>0&&i[1]>0&&i[1]<13&&i[2]>0&&i[2]<32){u.data=[i[0],i[1],i[2],d,p,f],u.value=[];var h=new Date(u.data[0],u.data[1]-1,u.data[2],u.data[3],u.data[4],u.data[5]),b=function(t){var n=this.tokens[t],o=n.toUpperCase(),r=null;"YYYY"===o?r=this.data[0]:"YYY"===o?r=this.data[0].substring(1,4):"YY"===o?r=this.data[0].substring(2,4):"Y"===o?r=this.data[0].substring(3,4):"MON"===n?r=e.calendar.months[h.getMonth()].substr(0,3).toUpperCase():"mon"===n?r=e.calendar.months[h.getMonth()].substr(0,3).toLowerCase():"MONTH"===n?r=e.calendar.months[h.getMonth()].toUpperCase():"month"===n?r=e.calendar.months[h.getMonth()].toLowerCase():"MMMMM"===o?r=e.calendar.months[h.getMonth()].substr(0,1):"MMMM"===o||"Month"===n?r=e.calendar.months[h.getMonth()]:"MMM"===o||"Mon"==n?r=e.calendar.months[h.getMonth()].substr(0,3):"MM"===o?r=e.two(this.data[1]):"M"===o?r=h.getMonth()+1:"DAY"===n?r=e.calendar.weekdays[h.getDay()].toUpperCase():"day"===n?r=e.calendar.weekdays[h.getDay()].toLowerCase():"DDDD"===o||"Day"==n?r=e.calendar.weekdays[h.getDay()]:"DDD"===o?r=e.calendar.weekdays[h.getDay()].substr(0,3):"DD"===o?r=e.two(this.data[2]):"D"===o?r=this.data[2]:"Q"===o?r=Math.floor((h.getMonth()+3)/3):"HH24"===o||"HH"===o?r=e.two(this.data[3]):"HH12"===o?r=this.data[3]>12?e.two(this.data[3]-12):e.two(this.data[3]):"H"===o?r=this.data[3]:"MI"===o?r=e.two(this.data[4]):"SS"===o?r=e.two(this.data[5]):"MS"===o?r=h.getMilliseconds():"AM/PM"===o?r=this.data[3]>=12?"PM":"AM":"WD"===o&&(r=e.calendar.weekdays[h.getDay()]),this.value[t]=null===r?this.tokens[t]:r};for(s=0;s<u.tokens.length;s++)b.call(u,s);t=u.value.join("")}else t=""}return t},e.calendar.weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],e.calendar.months=["January","February","March","April","May","June","July","August","September","October","November","December"],e.calendar.weekdaysShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],e.calendar.monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e.color=function(t,n){if(t.color)return t.color.setOptions(n,!0);var o={type:"color",options:{}},r=null,i=null,a=null,l=null,s=null,u=null,c=null;o.setOptions=function(n,r){var i={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};for(var a in n||(n={}),n&&!n.palette&&(n.palette=e.palette()),i)n&&n.hasOwnProperty(a)?o.options[a]=n[a]:void 0!==o.options[a]&&!0!==r||(o.options[a]=i[a]);return l&&(l.innerHTML=o.options.resetLabel),s&&(s.innerHTML=o.options.doneLabel),o.options.palette&&c&&c.updateContent(0,b()),"string"==typeof o.options.value&&(t.value=o.options.value,"INPUT"===t.tagName&&(t.style.color=t.value,t.style.backgroundColor=t.value)),o.options.placeholder?t.setAttribute("placeholder",o.options.placeholder):t.getAttribute("placeholder")&&t.removeAttribute("placeholder"),o},o.select=function(e){var t=r.querySelector(".jcolor-selected");t&&t.classList.remove("jcolor-selected"),o.values[e]&&o.values[e].classList.add("jcolor-selected"),o.options.value=e},o.open=function(){if(!r.classList.contains("jcolor-focus")){e.tracking(o,!0),r.classList.add("jcolor-focus"),o.options.value&&o.select(o.options.value),a.style.marginTop="",a.style.marginLeft="";var n=a.getBoundingClientRect(),l=e.getWindowWidth(),s=e.getWindowHeight();if(l<800||1==o.options.fullscreen?(a.classList.add("jcolor-fullscreen"),e.animation.slideBottom(a,1),i.style.display="block"):(a.classList.contains("jcolor-fullscreen")&&(a.classList.remove("jcolor-fullscreen"),i.style.display=""),o.options.position?a.style.position="fixed":a.style.position="",n.left+n.width>l&&(a.style.marginLeft=-1*(n.left+n.width-(l-20))+"px"),n.top+n.height>s&&(a.style.marginTop=-1*(n.top+n.height-(s-20))+"px")),"function"==typeof o.options.onopen&&o.options.onopen(t),c.setBorder(c.getActive()),o.options.value){var u=h(o.options.value);C.forEach((function(e,t){e.value=u[t],e.dispatchEvent(new Event("input"))}))}}},o.close=function(n){return r.classList.contains("jcolor-focus")&&(r.classList.remove("jcolor-focus"),i.style.display="",n||"function"!=typeof o.options.onclose||o.options.onclose(t),e.tracking(o,!1)),o.options.value},o.setValue=function(e){e||(e=""),e!=o.options.value&&(o.options.value=e,x=e,o.select(e),"function"==typeof o.options.onchange&&o.options.onchange(t,e),t.value!=o.options.value&&(t.value=o.options.value,"INPUT"===t.tagName&&(t.style.color=t.value,t.style.backgroundColor=t.value),"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value})),1==o.options.closeOnChange&&o.close())},o.getValue=function(){return o.options.value};var d=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},p=function(e,t,n){return"#"+d(e)+d(t)+d(n)},f=function(e){return parseInt("0x"+e)},h=function(e){return[f(e.substr(1,2)),f(e.substr(3,2)),f(e.substr(5,2))]},b=function(){var e=document.createElement("div");e.className="jcolor-grid",o.values=[];var t=document.createElement("table");t.setAttribute("cellpadding","7"),t.setAttribute("cellspacing","0");for(var n=0;n<o.options.palette.length;n++){for(var r=document.createElement("tr"),i=0;i<o.options.palette[n].length;i++){var a=document.createElement("td"),l=o.options.palette[n][i];l.length<7&&"#"!==l.substr(0,1)&&(l="#"+l),a.style.backgroundColor=l,a.setAttribute("data-value",l),a.innerHTML="",r.appendChild(a),o.options.value==l&&a.classList.add("jcolor-selected"),o.values[l]=a}t.appendChild(r)}return e.appendChild(t),e},g=document.createElement("canvas");g.width=200,g.height=160;var m=g.getContext("2d"),j=function(){var e=u.firstChild.getBoundingClientRect();g.width=e.width-14,v()},v=function(){var e=m.createLinearGradient(0,0,g.width,0);e.addColorStop(0,"rgb(255,0,0)"),e.addColorStop(.15,"rgb(255,0,255)"),e.addColorStop(.33,"rgb(0,0,255)"),e.addColorStop(.49,"rgb(0,255,255)"),e.addColorStop(.67,"rgb(0,255,0)"),e.addColorStop(.84,"rgb(255,255,0)"),e.addColorStop(1,"rgb(255,0,0)"),m.fillStyle=e,m.fillRect(0,0,g.width,g.height),(e=m.createLinearGradient(0,0,0,g.height)).addColorStop(0,"rgba(255,255,255,1)"),e.addColorStop(.5,"rgba(255,255,255,0)"),e.addColorStop(.5,"rgba(0,0,0,0)"),e.addColorStop(1,"rgba(0,0,0,1)"),m.fillStyle=e,m.fillRect(0,0,g.width,g.height)},y=function(){var e=document.createElement("div");e.className="jcolor-hsl";var t=document.createElement("div");t.className="jcolor-point";var n=document.createElement("div");n.appendChild(g),n.appendChild(t),e.appendChild(n);var o=function(n,o,r){if(1===n){var i=e.getBoundingClientRect(),a=o-i.left,l=r-i.top;a<0&&(a=0),l<0&&(l=0),a>i.width&&(a=i.width),l>i.height&&(l=i.height),t.style.left=a+"px",t.style.top=l+"px";var s=m.getImageData(a,l,1,1).data;x=p(s[0],s[1],s[2])}};return e.addEventListener("mousedown",(function(e){o(e.buttons,e.clientX,e.clientY)})),e.addEventListener("mousemove",(function(e){o(e.buttons,e.clientX,e.clientY)})),e.addEventListener("touchmove",(function(e){o(1,e.changedTouches[0].clientX,e.changedTouches[0].clientY)})),e},x="",C=[],w=function(){var e=document.createElement("div");e.className="jcolor-sliders";var t=document.createElement("div"),n=function(e){var n=document.createElement("div");n.className="jcolor-sliders-input-container";var o=document.createElement("label");o.innerText=e;var r=document.createElement("div");r.className="jcolor-sliders-input-subcontainer";var i=document.createElement("input");i.type="range",i.min=0,i.max=255,i.value=0,n.appendChild(o),r.appendChild(i);var a=document.createElement("div");return a.innerText=i.value,i.addEventListener("input",(function(){a.innerText=i.value})),r.appendChild(a),n.appendChild(r),t.appendChild(n),i};C=[n("Red"),n("Green"),n("Blue")],e.appendChild(t);var o=document.createElement("div");o.className="jcolor-sliders-final-color";var r=document.createElement("div");r.style.visibility="hidden",r.innerText="a",o.appendChild(r);return C.forEach((function(e){e.addEventListener("input",(function(){var e;e=p(parseInt(C[0].value),parseInt(C[1].value),parseInt(C[2].value)),r.innerText=e,r.style.color=e,r.style.removeProperty("visibility"),x=e,function(){if(""!==x)for(var e=0;e<C.length;e++){var t=h(x);t[e]=0;var n="linear-gradient(90deg, rgb(";n+=t.join(", "),n+="), rgb(",t[e]=255,n+=t.join(", "),n+="))",C[e].style.backgroundImage=n}}()}))})),e.appendChild(o),e};return o.toHex=function(e){var t=function(e){return("0"+parseInt(e).toString(16)).slice(-2)};return/^#[0-9A-F]{6}$/i.test(e)?e:"#"+t((e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))[1])+t(e[2])+t(e[3])},function(){o.setOptions(n),"INPUT"==t.tagName&&(t.classList.add("jcolor-input"),t.readOnly=!0),(r=document.createElement("div")).className="jcolor",(i=document.createElement("div")).className="jcolor-backdrop",r.appendChild(i),(a=document.createElement("div")).className="jcolor-content";var d=document.createElement("div");d.className="jcolor-controls",a.appendChild(d),(l=document.createElement("div")).className="jcolor-reset",l.innerHTML=o.options.resetLabel,d.appendChild(l),(s=document.createElement("div")).className="jcolor-close",s.innerHTML=o.options.doneLabel,d.appendChild(s),u=document.createElement("div"),a.appendChild(u),c=e.tabs(u,{animation:!0,data:[{title:"Grid",contentElement:b()},{title:"Spectrum",contentElement:y()},{title:"Sliders",contentElement:w()}],onchange:function(e,t,n){if(1===n)j();else{var r=""!==x?x:o.getValue();if(2===n&&r){var i=h(r);C.forEach((function(e,t){e.value=i[t],e.dispatchEvent(new Event("input"))}))}}},palette:"modern"}),r.appendChild(a),"INPUT"==t.tagName?t.parentNode.insertBefore(r,t.nextSibling):t.appendChild(r),r.addEventListener("click",(function(e){if("TD"==e.target.tagName){var t=e.target.getAttribute("data-value");t&&o.setValue(t)}else e.target.classList.contains("jcolor-reset")?(o.setValue(""),o.close()):e.target.classList.contains("jcolor-close")?(c.getActive()>0&&o.setValue(x),o.close()):e.target.classList.contains("jcolor-backdrop")?o.close():o.open()})),t.addEventListener("mouseup",(function(e){o.open()})),window.addEventListener("resize",(function(){r.classList.contains("jcolor-focus")&&1==c.getActive()&&j()})),1==o.options.opened&&o.open(),t.change=o.setValue,t.val=function(e){if(void 0===e)return o.getValue();o.setValue(e)},t.color=o,r.color=o}(),o},e.contextmenu=function(t,n){var o={type:"contextmenu",options:{}},r={items:null,onclick:null};for(var i in r)n&&n.hasOwnProperty(i)?o.options[i]=n[i]:o.options[i]=r[i];function a(e){if(!e.type||"line"!=e.type&&"divisor"!=e.type){u=document.createElement("div");var t=document.createElement("a");if(t.innerHTML=e.title,e.tooltip&&u.setAttribute("title",e.tooltip),e.icon&&u.setAttribute("data-icon",e.icon),e.id&&(u.id=e.id),e.disabled?u.className="jcontextmenu-disabled":e.onclick&&(u.method=e.onclick,u.addEventListener("mousedown",(function(e){e.preventDefault()})),u.addEventListener("mouseup",(function(e){this.method(this,e)}))),u.appendChild(t),e.submenu){var n=document.createElement("span");n.innerHTML="&#9658;",u.appendChild(n),u.classList.add("jcontexthassubmenu");var o=document.createElement("div");o.classList.add("jcontextmenu"),o.setAttribute("tabindex","900");for(var r=e.submenu,i=0;i<r.length;i++){var l=a(r[i]);o.appendChild(l)}u.appendChild(o)}else if(e.shortcut){var s=document.createElement("span");s.innerHTML=e.shortcut,u.appendChild(s)}}else var u=document.createElement("hr");return u}return t.classList.add("jcontextmenu"),o.open=function(n,r){if(r&&(o.options.items=r,o.create(r)),e.contextmenu.current&&e.contextmenu.current.close(),e.tracking(o,!0),t.classList.add("jcontextmenu-focus"),e.contextmenu.current=o,o.options.items&&o.options.items.length>0||t.children.length){if(n.target)if(n.changedTouches&&n.changedTouches[0])i=n.changedTouches[0].clientX,a=n.changedTouches[0].clientY;else var i=n.clientX,a=n.clientY;else i=n.x,a=n.y;var l=t.getBoundingClientRect();if(window.innerHeight<a+l.height){var s=a-l.height;s<0&&(s=0),t.style.top=s+"px"}else t.style.top=a+"px";window.innerWidth<i+l.width?i-l.width>0?t.style.left=i-l.width+"px":t.style.left="10px":t.style.left=i+"px"}},o.isOpened=function(){return!!t.classList.contains("jcontextmenu-focus")},o.close=function(){t.classList.contains("jcontextmenu-focus")&&t.classList.remove("jcontextmenu-focus"),e.tracking(o,!1)},o.create=function(n){t.innerHTML="";var r=function(){var t=document.createElement("div");t.classList.add("header"),t.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation()}));var n=document.createElement("a");n.classList.add("title"),n.innerHTML=e.translate("Menu"),t.appendChild(n);var r=document.createElement("a");return r.classList.add("close"),r.innerHTML=e.translate("close"),r.addEventListener("click",(function(e){o.close()})),t.appendChild(r),t}();t.appendChild(r);for(var i=0;i<n.length;i++){var l=a(n[i]);t.appendChild(l)}},"function"==typeof o.options.onclick&&t.addEventListener("click",(function(e){o.options.onclick(o,e)})),o.options.items&&o.create(o.options.items),window.addEventListener("mousewheel",(function(){o.close()})),t.contextmenu=o,o},e.dropdown=function(t,n){if(t.dropdown)return t.dropdown.setOptions(n,!0);var o={type:"dropdown",options:{}},r=function(e,n){e&&e.length&&(!1!==o.options.sortResults&&("function"==typeof o.options.sortResults?e.sort(o.options.sortResults):e.sort(i)),o.setData(e)),"function"==typeof o.options.onload&&o.options.onload(t,o,e,n),n&&l(n),null==n&&(o.options.value=""),t.value=o.options.value,1==o.options.opened&&o.open()},i=function(e,t){var n,o;return"string"==typeof e?n=e:e.text?n=e.text:e.name&&(n=e.name),"string"==typeof t?o=t:t.text?o=t.text:t.name&&(o=t.name),"string"==typeof n||"string"==typeof o?("string"!=typeof n&&(n=""+n),"string"!=typeof o&&(o=""+o),n.localeCompare(o)):n-o},a=function(){o.value={};for(var e=0;e<o.items.length;e++)1==o.items[e].selected&&(o.items[e].element&&o.items[e].element.classList.remove("jdropdown-selected"),o.items[e].selected=null);o.options.value=""},l=function(e){if(a(),null!==e)if(e){Array.isArray(e)||(e=(""+e).split(";"));for(var t=0;t<e.length;t++)o.value[e[t]]=""}else void 0!==o.value[""]&&(o.value[""]="");for(t=0;t<o.items.length;t++)void 0!==o.value[s(t)]&&(o.items[t].element&&o.items[t].element.classList.add("jdropdown-selected"),o.items[t].selected=!0,o.value[s(t)]=u(t));o.options.value=Object.keys(o.value).join(";"),o.header.value=o.getText()},s=function(e,t){if(o.options.format)n="id";else var n="value";return o.items[e]?void 0!==t?o.items[e].data[n]=t:o.items[e].data[n]:""},u=function(e,t){if(o.options.format)n="name";else var n="text";return o.items[e]?void 0!==t?o.items[e].data[n]=t:o.items[e].data[n]:""},c=function(){return Object.keys(o.value)},d=function(){for(var e=[],t=Object.keys(o.value),n=0;n<t.length;n++)e.push(o.value[t[n]]);return e};o.setOptions=function(n,i){n||(n={});var a={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,sortResults:!1,autofocus:!1};for(var l in a)n&&n.hasOwnProperty(l)?o.options[l]=n[l]:void 0!==o.options[l]&&!0!==i||(o.options[l]=a[l]);return 1!=o.options.remoteSearch&&"searchbar"!==o.options.type||(o.options.autocomplete=!0),1==o.options.newOptions?o.header.classList.add("jdropdown-add"):o.header.classList.remove("jdropdown-add"),1==o.options.autocomplete?o.header.removeAttribute("readonly"):o.header.setAttribute("readonly","readonly"),o.options.placeholder?o.header.setAttribute("placeholder",o.options.placeholder):o.header.removeAttribute("placeholder"),t.classList.remove("jdropdown-searchbar"),t.classList.remove("jdropdown-picker"),t.classList.remove("jdropdown-list"),"searchbar"==o.options.type?t.classList.add("jdropdown-searchbar"):"list"==o.options.type?t.classList.add("jdropdown-list"):"picker"==o.options.type?t.classList.add("jdropdown-picker"):e.getWindowWidth()<800?o.options.autocomplete?(t.classList.add("jdropdown-searchbar"),o.options.type="searchbar"):(t.classList.add("jdropdown-picker"),o.options.type="picker"):(o.options.width?(t.style.width=o.options.width,t.style.minWidth=o.options.width):(t.style.removeProperty("width"),t.style.removeProperty("min-width")),t.classList.add("jdropdown-default"),o.options.type="default"),"searchbar"==o.options.type?p.appendChild(b):f.insertBefore(b,f.firstChild),o.options.url&&!n.data?e.ajax({url:o.options.url,method:"GET",dataType:"json",success:function(e){e&&r(e,o.options.value)}}):r(o.options.data,o.options.value),o};var p=null,f=null,h=null,b=null,g=null,m=null,j=null;o.getUrl=function(){return o.options.url},o.setUrl=function(t,n){o.options.url=t,e.ajax({url:o.options.url,method:"GET",dataType:"json",success:function(e){o.setData(e),"function"==typeof n&&n(o)}})},o.setId=function(e,t){if(o.options.format)n="id";else var n="value";"object"==typeof e?e[n]=t:o.items[e].data[n]=t},o.add=function(t,n){if(!t){var r=1==o.options.autocomplete?o.header.value:"";if(!(t=prompt(e.translate("Add A New Option"),r)))return!1}if(n||(n=e.guid()),o.options.format)i={id:n,name:t};else var i={value:n,text:t};if("function"==typeof o.options.onbeforeinsert){var a=o.options.onbeforeinsert(o,i);if(!1===a)return!1;a&&(i=a)}o.options.data.push(i);var l=o.createItem(i);return h.appendChild(l.element),"function"==typeof o.options.oninsert&&o.options.oninsert(o,i,l),"none"==h.style.display&&(h.style.display=""),o.results&&o.results.push(l),i},o.createItem=function(e,t,n){o.options.format?(e.id||void 0===e.value||(e.id=e.value),e.name||void 0===e.text||(e.name=e.text)):(e.value||void 0===e.id||(e.value=e.id),e.text||void 0===e.name||(e.text=e.name));var r={};if(r.element=document.createElement("div"),r.element.className="jdropdown-item",r.element.indexValue=o.items.length,r.data=e,t&&(r.group=t),e.id&&r.element.setAttribute("id",e.id),1==e.disabled&&r.element.setAttribute("data-disabled",!0),e.tooltip&&r.element.setAttribute("title",e.tooltip),e.image){var i=document.createElement("img");i.className="jdropdown-image",i.src=e.image,e.title||i.classList.add("jdropdown-image-small"),r.element.appendChild(i)}else if(e.icon){var a=document.createElement("span");a.className="jdropdown-icon material-icons",a.innerText=e.icon,e.title||a.classList.add("jdropdown-icon-small"),e.color&&(a.style.color=e.color),r.element.appendChild(a)}else if(e.color){var l=document.createElement("div");l.className="jdropdown-color",l.style.backgroundColor=e.color,r.element.appendChild(l)}if(o.options.format)s=e.name;else var s=e.text;var u=document.createElement("div");if(u.className="jdropdown-description",u.innerHTML=s||"&nbsp;",e.title){var c=document.createElement("div");c.className="jdropdown-title",c.innerText=e.title,u.appendChild(c)}if(o.options.format)d=e.id;else var d=e.value;return o.value[d]&&(r.element.classList.add("jdropdown-selected"),r.selected=!0),o.items.push(r),r.element.appendChild(u),r},o.appendData=function(e){if(e.length){for(var t=[],n=[],r=0;r<e.length;r++)e[r].group?(n[e[r].group]||(n[e[r].group]=[]),n[e[r].group].push(r)):t.push(r);var i=0,a=Object.keys(n);if(a.length>0)for(r=0;r<a.length;r++){var l=document.createElement("div");l.className="jdropdown-group";var s=document.createElement("div");s.className="jdropdown-group-name",s.innerHTML=a[r];var u=document.createElement("i");u.className="jdropdown-group-arrow jdropdown-group-arrow-down",s.appendChild(u);var c=document.createElement("div");c.className="jdropdown-group-items";for(var d=0;d<n[a[r]].length;d++){var p=o.createItem(e[n[a[r]][d]],l,a[r]);(0==o.options.lazyLoading||i<200)&&(c.appendChild(p.element),i++)}l.appendChild(s),l.appendChild(c),o.groups.push(l),c.children.length>0&&h.appendChild(l)}if(t.length)for(r=0;r<t.length;r++){p=o.createItem(e[t[r]]);(0==o.options.lazyLoading||i<200)&&(h.appendChild(p.element),i++)}}},o.setData=function(e){if(a(),h.innerHTML="",o.header.value="",o.items=[],e&&e.length){for(var t=0;t<e.length;t++)"object"!=typeof e[t]&&(o.options.format?e[t]={id:e[t],name:e[t]}:e[t]={value:e[t],text:e[t]});o.appendData(e),o.options.data=e}else o.options.data=[];o.close()},o.getData=function(){return o.options.data},o.getPosition=function(e){for(var t=0;t<o.items.length;t++)if(s(t)==e)return t;return!1},o.getText=function(e){var t=d();return e?t:t.join("; ")},o.getValue=function(e){var t=c();return e?t:t.join(";")};var v=function(e){t.value!=o.options.value&&(t.value=o.options.value,"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value})),"function"==typeof o.options.onchange&&o.options.onchange(t,o,e,o.options.value)};o.setValue=function(e){var t=o.getValue();Array.isArray(e)&&(e=e.join(";")),t!==e&&(l(e),v(t))},o.resetSelected=function(){o.setValue(null)},o.selectIndex=function(e,t){e=parseInt(e);if(o.items&&o.items[e]&&(!0===t||!0!==o.items[e].data.disabled))if(o.setCursor(e,!1),o.options.multiple){var n=o.options.value;o.items[e].selected?(o.items[e].element.classList.remove("jdropdown-selected"),o.items[e].selected=!1,delete o.value[s(e)]):(o.items[e].element.classList.add("jdropdown-selected"),o.items[e].selected=!0,o.value[s(e)]=u(e)),o.options.value=Object.keys(o.value).join(";"),0==o.options.autocomplete&&(o.header.value=d().join("; ")),v(n)}else o.items[e].selected?o.setValue(null):o.setValue(s(e)),o.close()},o.selectItem=function(e){o.selectIndex(e.indexValue)};var y=function(e,t){for(var n=0;n<t.length;n++)if(o.options.format){if(t[n].id==e)return!0}else if(t[n].value==e)return!0;return!1};return o.find=function(t){if(o.search==t.trim())return!1;if(o.search=t,o.setCursor(),o.groups.length)for(var n=0;n<o.groups.length;n++)o.groups[n].lastChild.innerHTML="";if(h.innerHTML="",1==o.options.remoteSearch){o.results=null;var r=o.options.url+(o.options.url.indexOf("?")>0?"&":"?")+"q="+t;e.ajax({url:r,method:"GET",dataType:"json",success:function(e){o.items=[];var t=Object.keys(o.value);if(t.length)for(var n=0;n<t.length;n++)y(t[n],e)||(o.options.format?e.unshift({id:t[n],name:o.value[t[n]]}):e.unshift({value:t[n],text:o.value[t[n]]}));o.appendData(e),e.length?h.style.display="":h.style.display="none"}})}else{t=new RegExp(t,"gi");var i=[];for(n=0;n<o.items.length;n++){var a=u(n),l=o.items[n].data.title||"",s=o.items[n].data.group||"",c=o.items[n].data.synonym||"";c&&(c=c.join(" ")),(null==t||1==o.items[n].selected||a.match(t)||l.match(t)||s.match(t)||c.match(t))&&i.push(o.items[n])}if(i.length){h.style.display="",o.results=i;var d=i.length||0;1==o.options.lazyLoading&&d>200&&(d=200);for(n=0;n<d;n++)o.results[n].group?(o.results[n].group.parentNode||h.appendChild(o.results[n].group),o.results[n].group.lastChild.appendChild(o.results[n].element)):h.appendChild(o.results[n].element)}else h.style.display="none",o.results=null}1==o.options.autofocus&&o.first()},o.open=function(){if(!t.classList.contains("jdropdown-focus")){e.dropdown.current=o,e.tracking(o,!0),t.classList.add("jdropdown-focus"),e.getWindowWidth()<800&&(null!=o.options.type&&"picker"!=o.options.type||e.animation.slideBottom(f,1)),1==o.options.autocomplete&&(o.header.value=o.search,o.header.focus());var n=c();if(n[0]){var r=o.getPosition(n[0]);!1!==r&&o.setCursor(r)}if(!o.options.type||"default"==o.options.type){var i=t.getBoundingClientRect(),a=f.getBoundingClientRect();o.options.position?(f.style.position="fixed",window.innerHeight<i.bottom+a.height?(f.style.top="",f.style.bottom=window.innerHeight-i.top+1+"px"):(f.style.top=i.bottom+"px",f.style.bottom=""),f.style.left=i.left+"px"):window.innerHeight<i.bottom+a.height?(f.style.top="",f.style.bottom=i.height+1+"px"):(f.style.top="",f.style.bottom=""),f.style.minWidth=i.width+"px",o.options.maxWidth&&(f.style.maxWidth=o.options.maxWidth),o.items.length||1!=o.options.autocomplete?h.style.display="":h.style.display="none"}}"function"==typeof o.options.onopen&&o.options.onopen(t)},o.close=function(n){return t.classList.contains("jdropdown-focus")&&(o.header.value=o.getText(),o.setCursor(),n||"function"!=typeof o.options.onclose||o.options.onclose(t),o.header.blur&&o.header.blur(),t.classList.remove("jdropdown-focus"),e.tracking(o,!1),e.dropdown.current=null),o.getValue()},o.setCursor=function(e,t){if(null!=o.currentIndex&&o.items&&o.items[o.currentIndex]&&o.items[o.currentIndex].element.classList.remove("jdropdown-cursor"),null==e)o.currentIndex=null;else if(e=parseInt(e),o.items[e].element.parentNode&&(o.items[e].element.classList.add("jdropdown-cursor"),o.currentIndex=e,!1!==t&&o.items[o.currentIndex].element)){h.scrollTop;var n=o.items[o.currentIndex].element;h.scrollTop=n.offsetTop-n.scrollTop+n.clientTop-95}},o.resetCursor=o.setCursor,o.updateCursor=o.setCursor,o.reset=function(){o.setCursor(),o.setValue(null)},o.first=function(){!0===o.options.lazyLoading&&o.loadFirst();var e=h.querySelectorAll(".jdropdown-item");if(e.length){var t=e[0].indexValue;o.setCursor(t)}},o.last=function(){!0===o.options.lazyLoading&&o.loadLast();var e=h.querySelectorAll(".jdropdown-item");if(e.length){var t=e[e.length-1].indexValue;o.setCursor(t)}},o.next=function(e){var t=null;if(e){if(1==e.length){var n=o.currentIndex||-1;e=e.toLowerCase();var r=null,i=null,a=h.querySelectorAll(".jdropdown-item");if(a.length){for(var l=0;l<a.length;l++)if(a[l].indexValue>n&&(r=o.items[a[l].indexValue])&&(i=r.element.innerText[0])&&e==(i=i.toLowerCase())){t=a[l].indexValue;break}o.setCursor(t)}}}else if(null==o.currentIndex||null==o.currentIndex)o.first();else{var s=o.items[o.currentIndex].element,u=s.nextElementSibling;u?(u.classList.contains("jdropdown-group")&&(u=u.lastChild.firstChild),t=u.indexValue):s.parentNode.classList.contains("jdropdown-group-items")&&((u=s.parentNode.parentNode.nextElementSibling)&&(u.classList.contains("jdropdown-group")?u=u.lastChild.firstChild:u.classList.contains("jdropdown-item")?t=u.indexValue:u=null),u&&(t=u.indexValue)),null!==t&&o.setCursor(t)}},o.prev=function(){var e=null;if(null===o.currentIndex)o.first();else{var t=o.items[o.currentIndex].element,n=t.previousElementSibling;n?(n.classList.contains("jdropdown-group")&&(n=n.lastChild.lastChild),e=n.indexValue):t.parentNode.classList.contains("jdropdown-group-items")&&((n=t.parentNode.parentNode.previousElementSibling)&&(n.classList.contains("jdropdown-group")?n=n.lastChild.lastChild:n.classList.contains("jdropdown-item")?e=n.indexValue:n=null),n&&(e=n.indexValue))}null!==e&&o.setCursor(e)},o.loadFirst=function(){if(o.results)var e=o.results;else e=o.items;var t=e.length||0;1==o.options.lazyLoading&&t>200&&(t=200),h.innerHTML="";for(var n=0;n<t;n++)e[n].group?(e[n].group.parentNode||h.appendChild(e[n].group),e[n].group.lastChild.appendChild(e[n].element)):h.appendChild(e[n].element);h.scrollTop=0},o.loadLast=function(){if(o.results)var e=o.results;else e=o.items;var t=e.length;if(t>200){t-=200,h.innerHTML="";for(var n=t;n<e.length;n++)e[n].group?(e[n].group.parentNode||h.appendChild(e[n].group),e[n].group.lastChild.appendChild(e[n].element)):h.appendChild(e[n].element);h.scrollTop=h.scrollHeight}},o.loadUp=function(){var e=!1;if(o.results)var t=o.results;else t=o.items;var n=h.querySelectorAll(".jdropdown-item")[0].indexValue;n=o.items[n];var r=t.indexOf(n)-1;if(r>0){for(var i=0;r>0&&t[r]&&i<200;)t[r].group?(t[r].group.parentNode||h.insertBefore(t[r].group,h.firstChild),t[r].group.lastChild.insertBefore(t[r].element,t[r].group.lastChild.firstChild)):h.insertBefore(t[r].element,h.firstChild),r--,i++;e=!0}return e},o.loadDown=function(){var e=!1;if(o.results)var t=o.results;else t=o.items;var n=h.querySelectorAll(".jdropdown-item"),r=n[n.length-1].indexValue;r=o.items[r];var i=t.indexOf(r)+1;if(i<t.length){for(var a=0;i<t.length&&t[i]&&a<200;)t[i].group?(t[i].group.parentNode||h.appendChild(t[i].group),t[i].group.lastChild.appendChild(t[i].element)):h.appendChild(t[i].element),i++,a++;e=!0}return e},function(){if(n||(n={}),"SELECT"==t.tagName){var r=e.dropdown.extractFromDom(t,n);t=r.el,n=r.options}!n.placeholder&&t.getAttribute("placeholder")&&(n.placeholder=t.getAttribute("placeholder")),o.value={},o.items=[],o.groups=[],o.search="",o.results=null,t.classList.add("jdropdown"),(p=document.createElement("div")).className="jdropdown-container-header",o.header=document.createElement("input"),o.header.className="jdropdown-header",o.header.type="text",o.header.setAttribute("autocomplete","off"),o.header.onfocus=function(){"function"==typeof o.options.onfocus&&o.options.onfocus(t)},o.header.onblur=function(){"function"==typeof o.options.onblur&&o.options.onblur(t)},o.header.onkeyup=function(e){1!=o.options.autocomplete||j?o.options.autocomplete||o.next(e.key):(o.search!=o.header.value.trim()&&(j=setTimeout((function(){o.find(o.header.value.trim()),j=null}),400)),t.classList.contains("jdropdown-focus")||o.open())},e.dropdown.hasEvents||(e.dropdown.hasEvents=!0,document.addEventListener("keydown",e.dropdown.keydown)),(f=document.createElement("div")).className="jdropdown-container",(h=document.createElement("div")).className="jdropdown-content",(b=document.createElement("div")).className="jdropdown-close",b.innerHTML="Done",(g=document.createElement("div")).className="jdropdown-reset",g.innerHTML="x",g.onclick=function(){o.reset(),o.close()},(m=document.createElement("div")).className="jdropdown-backdrop",p.appendChild(o.header),f.appendChild(h),t.appendChild(p),t.appendChild(f),t.appendChild(m),o.setOptions(n),"ontouchsend"in document.documentElement==!0?t.addEventListener("touchsend",e.dropdown.mouseup):t.addEventListener("mouseup",e.dropdown.mouseup),1==o.options.lazyLoading&&e.lazyLoading(h,{loadUp:o.loadUp,loadDown:o.loadDown}),h.onwheel=function(e){e.stopPropagation()},t.change=o.setValue,t.val=function(e){if(void 0===e)return o.getValue(!!o.options.multiple);o.setValue(e)},t.dropdown=o}(),o},e.dropdown.keydown=function(t){var n=null;if(n=e.dropdown.current)if(13==t.which||9==t.which)n.header.value&&null==n.currentIndex&&n.options.newOptions?n.add():(null==n.currentIndex&&1==n.options.autocomplete&&""!=n.header.value&&n.find(n.header.value),n.selectIndex(n.currentIndex));else if(38==t.which)null==n.currentIndex?n.first():n.currentIndex>0&&n.prev(),t.preventDefault();else if(40==t.which)null==n.currentIndex?n.first():n.currentIndex+1<n.items.length&&n.next(),t.preventDefault();else if(36==t.which)n.first(),t.target.classList.contains("jdropdown-header")||t.preventDefault();else if(35==t.which)n.last(),t.target.classList.contains("jdropdown-header")||t.preventDefault();else if(27==t.which)n.close();else if(33==t.which){if(null==n.currentIndex)n.first();else if(n.currentIndex>0)for(var o=0;o<7;o++)n.prev();t.preventDefault()}else if(34==t.which){if(null==n.currentIndex)n.first();else if(n.currentIndex+1<n.items.length)for(o=0;o<7;o++)n.next();t.preventDefault()}},e.dropdown.mouseup=function(t){var n=e.findElement(t.target,"jdropdown");if(n){var o=n.dropdown;if(t.target.classList.contains("jdropdown-header"))if(n.classList.contains("jdropdown-focus")&&n.classList.contains("jdropdown-default")){var r=n.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0]){var i=t.changedTouches[0].clientX;t.changedTouches[0].clientY}else i=t.clientX,t.clientY;r.width-(i-r.left)<30?t.target.classList.contains("jdropdown-add")?o.add():o.close():0==o.options.autocomplete&&o.close()}else o.open();else if(t.target.classList.contains("jdropdown-group-name")){var a=t.target.nextSibling.children;if("none"!=t.target.nextSibling.style.display)for(var l=0;l<a.length;l++)"none"!=a[l].style.display&&o.selectItem(a[l])}else t.target.classList.contains("jdropdown-group-arrow")?t.target.classList.contains("jdropdown-group-arrow-down")?(t.target.classList.remove("jdropdown-group-arrow-down"),t.target.classList.add("jdropdown-group-arrow-up"),t.target.parentNode.nextSibling.style.display="none"):(t.target.classList.remove("jdropdown-group-arrow-up"),t.target.classList.add("jdropdown-group-arrow-down"),t.target.parentNode.nextSibling.style.display=""):t.target.classList.contains("jdropdown-item")?o.selectItem(t.target):t.target.classList.contains("jdropdown-image")||t.target.classList.contains("jdropdown-description")?o.selectItem(t.target.parentNode):t.target.classList.contains("jdropdown-title")?o.selectItem(t.target.parentNode.parentNode):(t.target.classList.contains("jdropdown-close")||t.target.classList.contains("jdropdown-backdrop"))&&o.close()}},e.dropdown.extractFromDom=function(e,t){var n=e;if(t||(t={}),!e.getAttribute("multiple")||t&&null!=t.multiple||(t.multiple=!0),!e.getAttribute("placeholder")||t&&null!=t.placeholder||(t.placeholder=e.getAttribute("placeholder")),!e.getAttribute("data-autocomplete")||t&&null!=t.autocomplete||(t.autocomplete=!0),t&&null!=t.width||(t.width=e.offsetWidth),!e.value||t&&null!=t.value||(t.value=e.value),!t||null==t.data){t.data=[];for(var o=0;o<e.children.length;o++)if("OPTGROUP"==e.children[o].tagName)for(var r=0;r<e.children[o].children.length;r++)t.data.push({value:e.children[o].children[r].value,text:e.children[o].children[r].innerHTML,group:e.children[o].getAttribute("label")});else t.data.push({value:e.children[o].value,text:e.children[o].innerHTML})}t&&null!=t.onchange||(t.onchange=function(e,o,r,i){1==t.multiple?obj.items[o].classList.contains("jdropdown-selected")?n.options[o].setAttribute("selected","selected"):n.options[o].removeAttribute("selected"):n.value=i});var i=document.createElement("div");return e.parentNode.insertBefore(i,e),e.style.display="none",{el:e=i,options:t}},e.editor=function(t,n){var o={type:"editor",options:{}},r={value:null,snippet:null,toolbar:null,remoteParser:null,placeholder:null,parseURL:!1,filterPaste:!0,dropZone:!1,dropAsSnippet:!1,acceptImages:!1,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,border:!0,padding:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,userSearch:null};for(var i in r)n&&n.hasOwnProperty(i)?o.options[i]=n[i]:o.options[i]=r[i];var a=null,l=null,s=[];t.innerHTML="",o.el=t,"function"==typeof o.options.onclick&&(t.onclick=function(e){o.options.onclick(t,o,e)}),t.classList.add("jeditor-container"),1==o.options.padding&&t.classList.add("jeditor-padding"),0==o.options.border&&(t.style.border="0px");var u=document.createElement("div");u.className="jsnippet",u.setAttribute("contenteditable",!1);var c=document.createElement("div");c.className="jeditor-toolbar";var d=document.createElement("div");if(d.setAttribute("contenteditable",!0),d.setAttribute("spellcheck",!1),d.className="jeditor",o.options.placeholder&&d.setAttribute("data-placeholder",o.options.placeholder),(o.options.maxHeight||o.options.height)&&(d.style.overflowY="auto",o.options.maxHeight&&(d.style.maxHeight=o.options.maxHeight),o.options.height&&(d.style.height=o.options.height)),o.options.value)var p=o.options.value;else p=t.innerHTML?t.innerHTML:"";if(!p)p="";var f=function(e){"function"==typeof o.options.onchange&&o.options.onchange(t,o,e),o.options.value=o.getData(),t.value!=o.options.value&&(t.value=o.options.value,"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value}))},h=function(e){var t,n;if(window.getSelection&&(t=window.getSelection()).rangeCount){(n=t.getRangeAt(0)).toString();n.deleteContents(),n.insertNode(e),n.setStartAfter(e),n.setEndAfter(e),t.removeAllRanges(),t.addRange(n)}},b=function(){var e=null;if(e=u.children[0]){e.classList.contains("jslider-grid")||e.classList.add("jslider-grid");var t=e.children.length;e.setAttribute("data-number",t>4?4:t),t>4?e.setAttribute("data-total",t-4):e.removeAttribute("data-total")}},g=function(e){u.innerHTML="";for(var t=["image","title","description","host","url"],n=0;n<t.length;n++){var o=document.createElement("div");if(o.className="jsnippet-"+t[n],o.setAttribute("data-k",t[n]),u.appendChild(o),e[t[n]])if("image"==t[n]){Array.isArray(e.image)||(e.image=[e.image]);for(var r=0;r<e.image.length;r++){var i=document.createElement("img");i.src=e.image[r],o.appendChild(i)}}else o.innerHTML=e[t[n]]}d.appendChild(document.createElement("br")),d.appendChild(u)},m=function(){clearTimeout(a),a=setTimeout((function(){if(!d.querySelector(".jsnippet")){var t=d.innerHTML.replace(/\n/g," "),n=document.createElement("div");n.innerHTML=t;var r=n.innerText,i=e.editor.detectUrl(r);if(i)if("jpg"==i[0].substr(-3)||"png"==i[0].substr(-3)||"gif"==i[0].substr(-3))o.addImage(i[0],!0);else{var a=e.editor.youtubeParser(i[0]);o.parseWebsite(i[0],a)}}}),1e3)};o.parseContent=function(){m()},o.parseWebsite=function(t,n){if(o.options.remoteParser){if(n)t="https://www.youtube.com/watch?v="+n;var r={title:"",description:"",image:"",host:t.split("/")[2],url:t};e.ajax({url:o.options.remoteParser+encodeURI(t.trim()),method:"GET",dataType:"json",success:function(e){e.title&&(r.title=e.title),e.description&&(r.description=e.description),e.host&&(r.host=e.host),e.url&&(r.url=e.url),g(r),e.image?o.addImage(e.image,!0):e["og:image"]&&o.addImage(e["og:image"],!0)}})}else console.log("The remoteParser is not defined")},o.setData=function(t){d.innerHTML="object"==typeof t?t.content:t,o.options.focus&&e.editor.setCursor(d,!0),s=[]},o.getFiles=function(){for(var e=d.querySelectorAll(".jfile"),t=[],n=0;n<e.length;n++)s[e[n].src]&&t.push(s[e[n].src]);return t},o.getText=function(){return d.innerText},o.getData=function(e){if(e){f={content:""};if(u.innerHTML){f.snippet={};for(var t=0;t<u.children.length;t++){var n=u.children[t].getAttribute("data-k");if(n)if("image"==n){f.snippet.image||(f.snippet.image=[]);for(var o=0;o<u.children[t].children.length;o++)f.snippet.image.push(u.children[t].children[o].getAttribute("src"))}else f.snippet[n]=u.children[t].innerHTML}}var r=Object.keys(s);if(r.length){f.files=[];for(t=0;t<r.length;t++)f.files.push(s[r[t]])}if(R){var i=d.querySelectorAll("a[data-user]");if(i.length){f.users=[];for(t=0;t<i.length;t++){var a=i[t].getAttribute("data-user");a&&f.users.push(a)}f.users=f.users.join(",")}}var l=document.createElement("div");l.innerHTML=d.innerHTML;var c=l.querySelector(".jsnippet");c&&c.remove();var p=l.innerHTML;p=(p=(p=p.replace(/<br>/g,"\n")).replace(/<\/div>/g,"</div>\n")).replace(/<(?:.|\n)*?>/gm,""),f.content=p.trim()}else var f=d.innerHTML;return f},o.reset=function(){d.innerHTML="",u.innerHTML="",s=[]},o.addPdf=function(e){if("data"!=e.result.substr(0,4))console.error("Invalid source");else{var t=document.createElement("canvas");t.width=60,t.height=60;var n=new Image;t.getContext("2d").drawImage(n,0,0,t.width,t.height),t.toBlob((function(t){var n=document.createElement("img");n.src=window.URL.createObjectURL(t),n.title=e.name,n.className="jfile pdf",s[n.src]={file:n.src,extension:"pdf",content:e.result},h(n)}))}},o.addImage=function(e,t){if(e||(e=""),"data"==e.substr(0,4)||o.options.remoteParser){if("data"==e.substr(0,4)){n=(n=(n=e.split(";"))[0].split("/"))[1]}else{var n=e.substr(e.lastIndexOf(".")+1);e=o.options.remoteParser+e}var r=new Image;r.onload=function(){var e=document.createElement("canvas");e.width=r.width,e.height=r.height,e.getContext("2d").drawImage(r,0,0,e.width,e.height),e.toBlob((function(r){var i,a=document.createElement("img");a.src=window.URL.createObjectURL(r),a.classList.add("jfile"),a.setAttribute("tabindex","900"),s[a.src]={file:a.src,extension:n,content:e.toDataURL()},o.options.dropAsSnippet||t?(i=a,u.innerHTML||g({}),u.children[0].appendChild(i),b(),s[a.src].snippet=!0):h(a),f()}))},r.src=e}else console.error("remoteParser not defined in your initialization")},o.addFile=function(e){for(var t=[],n=0;n<e.length;n++)if(e[n].size>o.options.maxFileSize)alert("The file is too big");else{var r=e[n].type.split("/");(r="image"==r[0]?1:"pdf"==r[1]?2:0)?(t[n]=new FileReader,t[n].index=n,t[n].type=r,t[n].name=e[n].name,t[n].date=e[n].lastModified,t[n].size=e[n].size,t[n].addEventListener("load",(function(e){2==e.target.type?1==o.options.acceptFiles&&o.addPdf(e.target):o.addImage(e.target.result)}),!1),t[n].readAsDataURL(e[n])):alert("The extension is not allowed")}},o.destroy=function(){d.removeEventListener("mouseup",j),d.removeEventListener("mousedown",v),d.removeEventListener("mousemove",y),d.removeEventListener("keyup",x),d.removeEventListener("keydown",C),d.removeEventListener("dragstart",I),d.removeEventListener("dragenter",M),d.removeEventListener("dragover",k),d.removeEventListener("drop",T),d.removeEventListener("paste",N),d.removeEventListener("blur",D),d.removeEventListener("focus",S),t.editor=null,t.classList.remove("jeditor-container"),c.remove(),u.remove(),d.remove()};var j=function(e){l&&l.e&&l.e.classList.remove("resizing"),l=!1},v=function(e){var t=function(t){var n=t.getBoundingClientRect();n.width-(e.clientX-n.left)<40&&e.clientY-n.top<40&&(t.innerHTML="",t.remove())};if("IMG"==e.target.tagName)if(e.target.style.cursor){var n=e.target.getBoundingClientRect();l={e:e.target,x:e.clientX,y:e.clientY,w:n.width,h:n.height,d:e.target.style.cursor},e.target.width||(e.target.width=n.width+"px"),e.target.height||(e.target.height=n.height+"px");var o=window.getSelection();if(o.rangeCount)for(var r=0;r<o.rangeCount;r++)o.removeRange(o.getRangeAt(r));e.target.classList.add("resizing")}else l=!0;else e.target.classList.contains("jsnippet")?t(e.target):e.target.parentNode.classList.contains("jsnippet")&&t(e.target.parentNode),l=!0},y=function(e){if("IMG"==e.target.tagName&&!e.target.parentNode.classList.contains("jsnippet-image")&&1==o.options.allowImageResize&&e.target.getAttribute("tabindex")){var t=e.target.getBoundingClientRect();e.clientY-t.top<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="ne-resize":e.clientX-t.left<5?e.target.style.cursor="nw-resize":e.target.style.cursor="n-resize":t.height-(e.clientY-t.top)<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="se-resize":e.clientX-t.left<5?e.target.style.cursor="sw-resize":e.target.style.cursor="s-resize":t.width-(e.clientX-t.left)<5?e.target.style.cursor="e-resize":e.clientX-t.left<5?e.target.style.cursor="w-resize":e.target.style.cursor=""}if(1==e.which&&l&&l.d){if("e-resize"==l.d||"ne-resize"==l.d||"se-resize"==l.d)if(l.e.width=l.w+(e.clientX-l.x),e.shiftKey){var n=(e.clientX-l.x)*(l.h/l.w);l.e.height=l.h+n}else n=null;n||"s-resize"!=l.d&&"se-resize"!=l.d&&"sw-resize"!=l.d||e.shiftKey||(l.e.height=l.h+(e.clientY-l.y))}},x=function(n){if(d.innerHTML||(d.innerHTML="<div><br></div>"),R){var r=e.getNode();r&&(!0===r.searchable?r.innerText&&"@"==r.innerText.substr(0,1)&&O(r.innerText.substr(1)):!1===r.searchable&&r.innerText!==r.getAttribute("data-label")&&(r.searchable=!0,r.removeAttribute("href")))}"function"==typeof o.options.onkeyup&&o.options.onkeyup(t,o,n)},C=function(e){1==o.options.parseURL&&m(),R&&("@"==e.key?(!function(){var e=(window.getSelection?window.getSelection():document.selection).getRangeAt(0);e.deleteContents();var t=document.createElement("a");t.innerText="@",t.searchable=!0,e.insertNode(t);var n=e.getBoundingClientRect();e.collapse(!1),R.style.position="fixed",R.style.top=n.top+n.height+10+"px",R.style.left=n.left+2+"px"}(),e.preventDefault()):O.isOpened()&&O.keydown(e)),"function"==typeof o.options.onkeydown&&o.options.onkeydown(t,o,e),"Delete"==e.key&&"IMG"==e.target.tagName&&e.target.parentNode.classList.contains("jsnippet-image")&&(e.target.remove(),b())},w=[HTMLUnknownElement,HTMLAudioElement,HTMLEmbedElement,HTMLIFrameElement,HTMLTextAreaElement,HTMLInputElement,HTMLScriptElement],E=["width","height","align","border","src","tabindex"],A=["color","font-weight","font-size","background","background-color","margin"],L=function(e){if(e.attributes&&e.attributes.length){var t=null,n=e.getAttribute("style");if(n){t=[];for(var r=n.split(";"),i=0;i<r.length;i++){var a=r[i].trim().split(":");if(A.indexOf(a[0].trim())>=0){var l=a.shift();a=a.join(":");t.push(l+":"+a)}}}"IMG"==e.tagName.toUpperCase()&&(o.options.acceptImages&&e.src?(e.setAttribute("tabindex","900"),o.addImage(e.src)):e.parentNode.removeChild(e));var s=[],u=e.attributes.length-1;if(u>0){for(var c=u;c>=0;c--)s.push(e.attributes[c].name);s.forEach((function(t){-1==E.indexOf(t)&&e.removeAttribute(t)}))}e.style="",t&&t.length&&e.setAttribute("style",t.join(";"))}if(e.children.length)for(c=0;c<e.children.length;c++)L(e.children[c]);w.indexOf(e.constructor)>=0&&e.remove()},N=function(e){if(1==o.options.filterPaste){if(e.clipboardData||e.originalEvent.clipboardData)var t=(e.originalEvent||e).clipboardData.getData("text/html"),n=(e.originalEvent||e).clipboardData.getData("text/plain"),r=(e.originalEvent||e).clipboardData.files;else if(window.clipboardData)t=window.clipboardData.getData("Html"),n=window.clipboardData.getData("Text"),r=window.clipboardData.files;if(r.length)o.addFile(r);else if(t){var i=function(e){e&&(e=e.replace(new RegExp("\x3c!--(.*?)--\x3e","gsi"),""));var t=(new DOMParser).parseFromString(e,"text/html");L(t);var n=document.createElement("span");return n.innerHTML=t.firstChild.innerHTML,n}(t);document.execCommand("insertHtml",!1,i.innerHTML)}else t=n.split("\r\n"),e.target.innerText?(t=t.map((function(e){return"<div>"+e+"</div>"})),document.execCommand("insertHtml",!1,t.join(""))):t.map((function(e){var t=document.createElement("div");t.innerText=e,d.appendChild(t)}));e.preventDefault()}},I=function(e){l&&l.e&&e.preventDefault()},M=function(e){l||0==o.options.dropZone||(t.classList.add("jeditor-dragging"),e.preventDefault())},k=function(e){l||0==o.options.dropZone||(a&&clearTimeout(a),a=setTimeout((function(){t.classList.remove("jeditor-dragging")}),100),e.preventDefault())},T=function(e){if(l||0==o.options.dropZone);else{var n=null;document.caretRangeFromPoint?n=document.caretRangeFromPoint(e.clientX,e.clientY):e.rangeParent&&(n=document.createRange()).setStart(e.rangeParent,e.rangeOffset);var r=window.getSelection();r.removeAllRanges(),r.addRange(n),r.anchorNode.parentNode.focus();var i=(e.originalEvent||e).dataTransfer.getData("text/html"),a=(e.originalEvent||e).dataTransfer.getData("text/plain"),s=(e.originalEvent||e).dataTransfer.files;s.length?o.addFile(s):a&&function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelectorAll("img");if(n.length)for(var r=0;r<n.length;r++)o.addImage(n[r].src)}(i),t.classList.remove("jeditor-dragging"),e.preventDefault()}},D=function(e){R&&O.isOpened()&&O.close(),"function"==typeof o.options.onblur&&o.options.onblur(t,o,e),f(e)},S=function(e){"function"==typeof o.options.onfocus&&o.options.onfocus(t,o,e)};d.addEventListener("mouseup",j),d.addEventListener("mousedown",v),d.addEventListener("mousemove",y),d.addEventListener("keyup",x),d.addEventListener("keydown",C),d.addEventListener("dragstart",I),d.addEventListener("dragenter",M),d.addEventListener("dragover",k),d.addEventListener("drop",T),d.addEventListener("paste",N),d.addEventListener("focus",S),d.addEventListener("blur",D),"function"==typeof o.options.onload&&o.options.onload(t,o,d),d.innerHTML=p,t.appendChild(d),o.options.snippet&&g(o.options.snippet),null==o.options.toolbar&&(o.options.toolbar=e.editor.getDefaultToolbar()),o.options.toolbar&&(t.appendChild(c),e.toolbar(c,{container:!0,responsive:!0,items:o.options.toolbar}));var R=null,O=null;return o.options.userSearch&&(R=document.createElement("div"),t.appendChild(R),O=e.search(R,{data:o.options.userSearch,placeholder:e.translate("Type the name a user"),onselect:function(t,n,o,r){if(O.isOpened()){var i=e.getNode();i&&1==i.searchable&&i.innerText.trim()&&i.innerText.substr(1)&&(i.innerText="@"+o,i.href="/"+o,i.setAttribute("data-user",r),i.setAttribute("data-label",i.innerText),i.searchable=!1,e.focus(i))}}})),o.options.focus&&e.editor.setCursor(d,"initial"==o.options.focus),t.change=o.setData,t.val=function(e){if(void 0===e){var n="true"!==t.getAttribute("data-html");return o.getData(n)}o.setData(e)},t.editor=o,o},e.editor.setCursor=function(e,t){e.focus(),document.execCommand("selectAll");var n=window.getSelection(),o=n.getRangeAt(0);if(1==t)var r=o.startContainer,i=0;else i=(r=o.endContainer).length;o.setStart(r,i),o.setEnd(r,i),n.removeAllRanges(),n.addRange(o)},e.editor.getDomain=function(e){return e.replace("http://","").replace("https://","").replace("www.","").split(/[/?#]/)[0].split(/:/g)[0]},e.editor.detectUrl=function(e){var t=e.match(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi);return t&&"www"==t[0].substr(0,3)&&(t[0]="http://"+t[0]),t},e.editor.youtubeParser=function(e){var t=e.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/);return!(!t||11!=t[7].length)&&t[7]},e.editor.getDefaultToolbar=function(){return[{content:"undo",onclick:function(){document.execCommand("undo")}},{content:"redo",onclick:function(){document.execCommand("redo")}},{type:"divisor"},{content:"format_bold",onclick:function(e,t,n){document.execCommand("bold"),document.queryCommandState("bold")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_italic",onclick:function(e,t,n){document.execCommand("italic"),document.queryCommandState("italic")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_underline",onclick:function(e,t,n){document.execCommand("underline"),document.queryCommandState("underline")?n.classList.add("selected"):n.classList.remove("selected")}},{type:"divisor"},{content:"format_list_bulleted",onclick:function(e,t,n){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_list_numbered",onclick:function(e,t,n){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_indent_increase",onclick:function(e,t,n){document.execCommand("indent",!0,null),document.queryCommandState("indent")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}]},e.form=function(t,n){var o={options:{}},r={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(t,n){e.alert(n)}};for(var i in r)n&&n.hasOwnProperty(i)?o.options[i]=n[i]:o.options[i]=r[i];o.options.validations||(o.options.validations={}),o.options.submitButton||(o.options.submitButton=t.querySelector("input[type=submit]")),o.options.submitButton&&o.options.url&&(o.options.submitButton.onclick=function(){o.save()}),o.options.validations.email||(o.options.validations.email=e.validations.email),o.options.validations.length||(o.options.validations.length=e.validations.length),o.options.validations.required||(o.options.validations.required=e.validations.required),o.setUrl=function(e){o.options.url=e},o.load=function(){e.ajax({url:o.options.url,method:"GET",dataType:"json",queue:!0,success:function(n){if("function"==typeof o.options.onbeforeload){var r=o.options.onbeforeload(t,n);r&&(n=r)}e.form.setElements(t,n),"function"==typeof o.options.onload&&o.options.onload(t,n)}})},o.save=function(){var n=o.validate();if(n)o.options.onerror(t,n);else{var r=e.form.getElements(t,!0);if("function"==typeof o.options.onbeforesave)if(!1===(r=o.options.onbeforesave(t,r)))return;e.ajax({url:o.options.url,method:"POST",dataType:"json",data:r,success:function(e){"function"==typeof o.options.onsave&&o.options.onsave(t,r,e)}})}},o.remove=function(){if("function"==typeof o.options.onbeforeremove&&!1===o.options.onbeforeremove(t,o))return!1;e.ajax({url:o.options.url,method:"DELETE",dataType:"json",success:function(e){"function"==typeof o.options.onremove&&o.options.onremove(t,o,e),o.reset()}})};return o.validateElement=function(n){var r=!1,i=e.form.getValue(n),a=n.getAttribute("data-validation");return"function"!=typeof o.options.validations[a]||o.options.validations[a](i,n)?n.classList.contains("error")&&function(e){var n=!1;e.classList.remove("error"),e.removeAttribute("title");for(var r=t.querySelectorAll("input, select, textarea, div[name]"),i=0;i<r.length;i++)r[i].getAttribute("data-validation")&&r[i].classList.contains("error")&&(n=!0);o.options.submitButton&&(n?o.options.submitButton.setAttribute("disabled",!0):o.options.submitButton.removeAttribute("disabled"))}(n):r=function(e){e.classList.add("error"),o.options.submitButton&&o.options.submitButton.setAttribute("disabled",!0);var t=e.getAttribute("data-error")||"There is an error in the form";return e.setAttribute("title",t),t}(n),r},o.reset=function(){for(var e=t.querySelectorAll("input, select, textarea, div[name]"),n=0;n<e.length;n++)e[n].getAttribute("name")&&("checkbox"==e[n].type||"radio"==e[n].type?e[n].checked=!1:"function"==typeof e[n].val?e[n].val(""):e[n].value="")},o.validate=function(){for(var e=[],n=t.querySelectorAll("input, select, textarea, div[name]"),r=0;r<n.length;r++)if(n[r].getAttribute("data-validation")){var i=o.validateElement(n[r]);i&&e.push(i)}return e.length>0&&e.join("<br>")},o.getError=function(){return!!o.validation()},o.setHash=function(){return o.getHash(e.form.getElements(t))},o.getHash=function(e){var t,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},o.isChanged=function(){var e=o.setHash();return o.options.currentHash!=e},o.resetTracker=function(){o.options.currentHash=o.setHash(),o.options.ignore=!1},o.setIgnore=function(e){o.options.ignore=!!e},setTimeout((function(){o.options.currentHash=o.setHash()}),1e3),t.addEventListener("keyup",(function(e){e.target.getAttribute("data-validation")&&o.validateElement(e.target)})),e.form.hasEvents||(window.addEventListener("beforeunload",(function(e){if(o.isChanged()&&0==o.options.ignore){var t=o.options.message?o.options.message:"o/";return t?(void 0===e&&(e=window.event),e&&(e.returnValue=t),t):void 0}})),e.form.hasEvents=!0),t.form=o,o},e.form.getValue=function(e){var t=null;if("checkbox"==e.type)1==e.checked&&(t=e.value||!0);else if("radio"==e.type)1==e.checked&&(t=e.value);else if("file"==e.type)t=e.files;else if("select"==e.tagName&&1==e.multiple){t=[];for(var n=e.querySelectorAll("options[selected]"),o=0;o<n.length;o++)t.push(n[o].value)}else t="function"==typeof e.val?e.val():e.value||"";return t},e.form.getElements=function(t,n){for(var o={},r=null,i=t.querySelectorAll("input, select, textarea, div[name]"),a=0;a<i.length;a++)(r=i[a].getAttribute("name"))&&(o[r]=e.form.getValue(i[a])||"");return 1==n?o:JSON.stringify(o)},e.form.setElements=function(t,n){for(var o=null,r=null,i=t.querySelectorAll("input, select, textarea, div[name]"),a=0;a<i.length;a++){var l=i[a].getAttribute("type");if(o=i[a].getAttribute("name")){if(r=null,(o=o.replace(new RegExp(/\[(.*?)\]/gi),".$1")).match(/\./)){var s=e.path.call(n,o)||"";void 0!==s&&(r=s)}else void 0!==n[o]&&(r=n[o]);null!==r&&("checkbox"==l||"radio"==l?i[a].checked=!!r:"file"==l||("function"==typeof i[a].val?i[a].val(r):i[a].value=r))}}},e.tracker=e.form,e.focus=function(e){if(e.innerText.length){var t=document.createRange(),n=window.getSelection(),o=e.childNodes[e.childNodes.length-1];t.setStart(o,o.length),t.collapse(!0),n.removeAllRanges(),n.addRange(t),e.scrollLeft=e.scrollWidth}},e.isNumeric=function(e){return"string"==typeof e&&(e=e.trim()),!isNaN(e)&&null!==e&&""!==e},e.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},e.getNode=function(){var e=document.getSelection().anchorNode;return e?3==e.nodeType?e.parentNode:e:null},e.hash=function(e){var t,n,o=0;if(0===e.length)return o;for(t=0;t<e.length;t++)(n=e.charCodeAt(t))>32&&(o=(o<<5)-o+n,o|=0);return o},e.randomColor=function(t){var n=String("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");n.length<6&&(n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]);var o,r,i=[];for(r=0;r<3;r++)o=parseInt(n.substr(2*r,2),16),o=Math.round(Math.min(Math.max(0,o+-.25*o),255)).toString(16),i.push(("00"+o).substr(o.length));return 1==t?"#"+e.two(i[0].toString(16))+e.two(i[1].toString(16))+e.two(i[2].toString(16)):i},e.getWindowWidth=function(){var e=window,t=document,n=t.documentElement,o=t.getElementsByTagName("body")[0];return e.innerWidth||n.clientWidth||o.clientWidth},e.getWindowHeight=function(){var e=window,t=document,n=t.documentElement,o=t.getElementsByTagName("body")[0];return e.innerHeight||n.clientHeight||o.clientHeight},e.getPosition=function(e){if(e.changedTouches&&e.changedTouches[0])var t=e.changedTouches[0].pageX,n=e.changedTouches[0].pageY;else t=window.Event?e.pageX:e.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),n=window.Event?e.pageY:e.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[t,n]},e.click=function(e){if(e.click)e.click();else{var t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});e.dispatchEvent(t)}},e.findElement=function(e,t){var n=!1;return function e(o){o&&!n&&("function"==typeof t?n=t(o):"string"==typeof t&&o.classList&&o.classList.contains(t)&&(n=o)),o.parentNode&&!n&&e(o.parentNode)}(e),n},e.two=function(e){return 1==(e=""+e).length&&(e="0"+e),e},e.sha512=function(e){function t(e,t){this.highOrder=e,this.lowOrder=t}var n,o,r,i,a,l,s,u,c,d,p=[new t(1779033703,4089235720),new t(3144134277,2227873595),new t(1013904242,4271175723),new t(2773480762,1595750129),new t(1359893119,2917565137),new t(2600822924,725511199),new t(528734635,4215389547),new t(1541459225,327033209)],f=[new t(1116352408,3609767458),new t(1899447441,602891725),new t(3049323471,3964484399),new t(3921009573,2173295548),new t(961987163,4081628472),new t(1508970993,3053834265),new t(2453635748,2937671579),new t(2870763221,3664609560),new t(3624381080,2734883394),new t(310598401,1164996542),new t(607225278,1323610764),new t(1426881987,3590304994),new t(1925078388,4068182383),new t(2162078206,991336113),new t(2614888103,633803317),new t(3248222580,3479774868),new t(3835390401,2666613458),new t(4022224774,944711139),new t(264347078,2341262773),new t(604807628,2007800933),new t(770255983,1495990901),new t(1249150122,1856431235),new t(1555081692,3175218132),new t(1996064986,2198950837),new t(2554220882,3999719339),new t(2821834349,766784016),new t(2952996808,2566594879),new t(3210313671,3203337956),new t(3336571891,1034457026),new t(3584528711,2466948901),new t(113926993,3758326383),new t(338241895,168717936),new t(666307205,1188179964),new t(773529912,1546045734),new t(1294757372,1522805485),new t(1396182291,2643833823),new t(1695183700,2343527390),new t(1986661051,1014477480),new t(2177026350,1206759142),new t(2456956037,344077627),new t(2730485921,1290863460),new t(2820302411,3158454273),new t(3259730800,3505952657),new t(3345764771,106217008),new t(3516065817,3606008344),new t(3600352804,1432725776),new t(4094571909,1467031594),new t(275423344,851169720),new t(430227734,3100823752),new t(506948616,1363258195),new t(659060556,3750685593),new t(883997877,3785050280),new t(958139571,3318307427),new t(1322822218,3812723403),new t(1537002063,2003034995),new t(1747873779,3602036899),new t(1955562222,1575990012),new t(2024104815,1125592928),new t(2227730452,2716904306),new t(2361852424,442776044),new t(2428436474,593698344),new t(2756734187,3733110249),new t(3204031479,2999351573),new t(3329325298,3815920427),new t(3391569614,3928383900),new t(3515267271,566280711),new t(3940187606,3454069534),new t(4118630271,4000239992),new t(116418474,1914138554),new t(174292421,2731055270),new t(289380356,3203993006),new t(460393269,320620315),new t(685471733,587496836),new t(852142971,1086792851),new t(1017036298,365543100),new t(1126000580,2618297676),new t(1288033470,3409855158),new t(1501505948,4234509866),new t(1607167915,987167468),new t(1816402316,1246189591)],h=new Array(64);function b(e,n){var o,r,i;return o=(65535&e.lowOrder)+(65535&n.lowOrder),i=(65535&(r=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(o>>>16)))<<16|65535&o,o=(65535&e.highOrder)+(65535&n.highOrder)+(r>>>16),new t((65535&(r=(e.highOrder>>>16)+(n.highOrder>>>16)+(o>>>16)))<<16|65535&o,i)}function g(e,n,o,r){var i,a,l;return i=(65535&e.lowOrder)+(65535&n.lowOrder)+(65535&o.lowOrder)+(65535&r.lowOrder),l=(65535&(a=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(o.lowOrder>>>16)+(r.lowOrder>>>16)+(i>>>16)))<<16|65535&i,i=(65535&e.highOrder)+(65535&n.highOrder)+(65535&o.highOrder)+(65535&r.highOrder)+(a>>>16),new t((65535&(a=(e.highOrder>>>16)+(n.highOrder>>>16)+(o.highOrder>>>16)+(r.highOrder>>>16)+(i>>>16)))<<16|65535&i,l)}function m(e,n,o,r,i){var a,l,s;return a=(65535&e.lowOrder)+(65535&n.lowOrder)+(65535&o.lowOrder)+(65535&r.lowOrder)+(65535&i.lowOrder),s=(65535&(l=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(o.lowOrder>>>16)+(r.lowOrder>>>16)+(i.lowOrder>>>16)+(a>>>16)))<<16|65535&a,a=(65535&e.highOrder)+(65535&n.highOrder)+(65535&o.highOrder)+(65535&r.highOrder)+(65535&i.highOrder)+(l>>>16),new t((65535&(l=(e.highOrder>>>16)+(n.highOrder>>>16)+(o.highOrder>>>16)+(r.highOrder>>>16)+(i.highOrder>>>16)+(a>>>16)))<<16|65535&a,s)}function j(e,n,o){return new t(e.highOrder&n.highOrder^e.highOrder&o.highOrder^n.highOrder&o.highOrder,e.lowOrder&n.lowOrder^e.lowOrder&o.lowOrder^n.lowOrder&o.lowOrder)}function v(e,n,o){return new t(e.highOrder&n.highOrder^~e.highOrder&o.highOrder,e.lowOrder&n.lowOrder^~e.lowOrder&o.lowOrder)}function y(e,n){return n<=32?new t(e.highOrder>>>n|e.lowOrder<<32-n,e.lowOrder>>>n|e.highOrder<<32-n):new t(e.lowOrder>>>n|e.highOrder<<32-n,e.highOrder>>>n|e.lowOrder<<32-n)}function x(e){var n=y(e,28),o=y(e,34),r=y(e,39);return new t(n.highOrder^o.highOrder^r.highOrder,n.lowOrder^o.lowOrder^r.lowOrder)}function C(e){var n=y(e,14),o=y(e,18),r=y(e,41);return new t(n.highOrder^o.highOrder^r.highOrder,n.lowOrder^o.lowOrder^r.lowOrder)}function w(e){var n=y(e,1),o=y(e,8),r=E(e,7);return new t(n.highOrder^o.highOrder^r.highOrder,n.lowOrder^o.lowOrder^r.lowOrder)}function E(e,n){return n<=32?new t(e.highOrder>>>n,e.lowOrder>>>n|e.highOrder<<32-n):new t(0,e.highOrder<<32-n)}var A,L,N,I,M=8*(e=function(e){return unescape(encodeURIComponent(e))}(e)).length;e=function(e){for(var t=[],n=8*e.length,o=0;o<n;o+=8)t[o>>5]|=(255&e.charCodeAt(o/8))<<24-o%32;return t}(e),e[M>>5]|=128<<24-M%32,e[31+(M+128>>10<<5)]=M;for(var k=0;k<e.length;k+=32){n=p[0],o=p[1],r=p[2],i=p[3],a=p[4],l=p[5],s=p[6],u=p[7];for(var T=0;T<80;T++)h[T]=T<16?new t(e[2*T+k],e[2*T+k+1]):g((A=h[T-2],L=void 0,N=void 0,I=void 0,L=y(A,19),N=y(A,61),I=E(A,6),new t(L.highOrder^N.highOrder^I.highOrder,L.lowOrder^N.lowOrder^I.lowOrder)),h[T-7],w(h[T-15]),h[T-16]),c=m(u,C(a),v(a,l,s),f[T],h[T]),d=b(x(n),j(n,o,r)),u=s,s=l,l=a,a=b(i,c),i=r,r=o,o=n,n=b(c,d);p[0]=b(n,p[0]),p[1]=b(o,p[1]),p[2]=b(r,p[2]),p[3]=b(i,p[3]),p[4]=b(a,p[4]),p[5]=b(l,p[5]),p[6]=b(s,p[6]),p[7]=b(u,p[7])}var D=[];for(k=0;k<p.length;k++)D.push(p[k].highOrder),D.push(p[k].lowOrder);return function(e){for(var t,n="0123456789abcdef",o="",r=4*e.length,i=0;i<r;i+=1)t=e[i>>2]>>8*(3-i%4),o+=n.charAt(t>>4&15)+n.charAt(15&t);return o}(D)},e.login||(e.login={},e.login.sha512=e.sha512),e.image=e.upload=function(t,n){var o={options:{}},r={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null,text:{extensionNotAllowed:"The extension is not allowed"}};for(var i in r)n&&n.hasOwnProperty(i)?o.options[i]=n[i]:o.options[i]=r[i];1==o.options.multiple&&t.setAttribute("data-multiple",!0),t.content=[],t.classList.add("jupload"),1==o.options.input&&t.classList.add("input"),o.add=function(n){if(0==o.options.multiple&&(t.content=[],t.innerText=""),"image"==o.options.type){var r=document.createElement("img");r.setAttribute("src",n.file),r.setAttribute("tabindex",-1),t.getAttribute("name")||(r.className="jfile",r.content=n),t.appendChild(r)}else{if(n.name)var i=n.name;else i=n.file;var a=document.createElement("div");a.innerText=i||o.options.type,a.classList.add("jupload-item"),a.setAttribute("tabindex",-1),t.appendChild(a)}n.content&&(n.file=e.guid()),t.content.push(n),"function"==typeof o.options.onchange&&o.options.onchange(t,n)},o.addFromFile=function(e){if(e.type.split("/")[0]==o.options.type){var t=new FileReader;t.addEventListener("load",(function(t){var n={file:t.srcElement.result,extension:e.name.substr(e.name.lastIndexOf(".")+1),name:e.name,size:e.size,lastmodified:e.lastModified,content:t.srcElement.result};o.add(n)})),t.readAsDataURL(e)}else alert(o.options.text.extensionNotAllowed)},o.addFromUrl=function(t){if("data"==t.substr(0,4)||o.options.remoteParser)if("data"==t.substr(0,4)){if((r=(r=t.split(";"))[0].split("/"))[0].replace("data:","")==o.options.type){var n={file:t,name:"",extension:r[1],content:t};o.add(n)}else alert(o.options.text.extensionNotAllowed)}else{var r=t.substr(t.lastIndexOf(".")+1);t=o.options.remoteParser+t,e.ajax({url:t,type:"GET",dataType:"blob",success:function(e){}})}else console.error("remoteParser not defined in your initialization")};var a=o.options.type+"/"+o.options.extension,l=document.createElement("input");l.type="file",l.setAttribute("accept",a),l.onchange=function(){for(var e=0;e<this.files.length;e++)o.addFromFile(this.files[e])},1==o.options.multiple&&l.setAttribute("multiple",!0);var s=null;return t.addEventListener("click",(function(n){s=null,t.children.length&&n.target!==t?n.target.parentNode==t&&(s=n.target):e.click(l)})),t.addEventListener("dblclick",(function(t){e.click(l)})),t.addEventListener("dragenter",(function(e){t.style.border="1px dashed #000"})),t.addEventListener("dragleave",(function(e){t.style.border="1px solid #eee"})),t.addEventListener("dragstop",(function(e){t.style.border="1px solid #eee"})),t.addEventListener("dragover",(function(e){e.preventDefault()})),t.addEventListener("keydown",(function(e){if(s&&46==e.which){var n=Array.prototype.indexOf.call(t.children,s);n>=0&&(t.content.splice(n,1),s.remove(),s=null)}})),t.addEventListener("drop",(function(e){e.preventDefault(),e.stopPropagation();var n=(e.originalEvent||e).dataTransfer.getData("text/html");if((e.originalEvent||e).dataTransfer.files.length)for(var r=0;r<e.dataTransfer.files.length;r++)o.addFromFile(e.dataTransfer.files[r]);else if(n){0==o.options.multiple&&(t.innerText="");var i=document.createElement("div");i.innerHTML=n;var a=i.querySelectorAll("img");if(a.length)for(r=0;r<a.length;r++)o.addFromUrl(a[r].src)}return t.style.border="1px solid #eee",!1})),t.val=function(e){if(void 0===e)return t.content&&t.content.length?t.content:null;if(t.innerText="",t.content=[],e)if(Array.isArray(e))for(var n=0;n<e.length;n++)"string"==typeof e[n]?o.add({file:e[n]}):o.add(e[n]);else"string"==typeof e&&o.add({file:e})},t.upload=t.image=o,o},e.image.create=function(e){var t=document.createElement("img");return t.setAttribute("src",e.file),t.className="jfile",t.setAttribute("tabindex",-1),t.content=e,t},e.lazyLoading=function(e,t){t.loadUp&&"function"==typeof t.loadUp||(t.loadUp=function(){return!1}),t.loadDown&&"function"==typeof t.loadDown||(t.loadDown=function(){return!1}),t.timer||(t.timer=100);var n=null,o=function(o){if(null==n){var r=!1,i=e.scrollTop;e.scrollTop+2*e.clientHeight>=e.scrollHeight?t.loadDown()&&(i==e.scrollTop&&(e.scrollTop=e.scrollTop-e.clientHeight),r=!0):e.scrollTop<=e.clientHeight&&t.loadUp()&&(i==e.scrollTop&&(e.scrollTop=e.scrollTop+e.clientHeight),r=!0),n=setTimeout((function(){n=null}),t.timer),r&&"function"==typeof t.onupdate&&t.onupdate()}};return e.onscroll=function(e){o()},e.onwheel=function(e){o()},{}},e.loading=function(){var e={},t=null;return e.show=function(){t||((t=document.createElement("div")).className="jloading"),document.body.appendChild(t)},e.hide=function(){t&&t.parentNode&&document.body.removeChild(t)},e}(),e.mask=function(){var t={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","HH24","HH12","HH","\\[H\\]","H","AM/PM","PM","AM","MI","SS","MS","MONTH","MON","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},n=function(){if(-1!==this.mask.toLowerCase().indexOf("[h]")){var t=0;this.date[4]&&(t=parseFloat(this.date[4]/60));var n=parseInt(this.date[3])+t;n/=24}else this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]?(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),n=e.two(this.date[0])+"-"+e.two(this.date[1])+"-"+e.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(n+=" "+e.two(this.date[3])+":"+e.two(this.date[4])+":"+e.two(this.date[5]))):n=e.two(this.date[3])+":"+e.two(this.date[4])+":"+e.two(this.date[5]);return n},o=function(e){return null===e||""===e||void 0===e},r=function(e){return"currency"===e||"percentage"===e||"numeric"===e},i=function(e){if(e&&Number(e)==e)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var t=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=t[1]}return e||(e=this.mask),(t=new RegExp("0{1}(.{1})0+","ig").exec(e))&&t[1]&&1==t[1].length?(this.options.decimal=t[1],t[1]):((t=new RegExp("#{1}(.{1})#+","ig").exec(e))&&t[1]&&1==t[1].length?","===t[1]?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2),this.options.decimal?this.options.decimal:null)},a=function(e,t){return""==e?"":(t||(t=i.call(this)),(e=(""+e).split(t))[0]=e[0].match(/[\-0-9]+/g),e[0]&&(e[0]=e[0].join("")),e[0]||e[1]?(void 0!==e[1]&&(e[1]=e[1].match(/[0-9]+/g),e[1]?e[1]=e[1].join(""):e[1]=""),e):"")},l=function(e,t){if(""==e)return"";var n=i.call(this),o=this.options;if(""==(e=a.call(this,e)))return"";if(e[0]){var r=parseFloat(e[0]+".1");"percent"==o.style&&(r/=100)}else r=null;if(("-"==e[0]||"-00"==e[0])&&!e[1]&&t&&"deleteContentBackward"==t.inputType)return"";var l=new Intl.NumberFormat(this.locale,o).format(r);if(void 0!==(l=l.split(n))[1]){var s=l[1].replace(/[0-9]*/g,"");s&&(l[2]=s)}return void 0!==e[1]?l[1]=n+e[1]:l[1]="",l.join("")},s=function(e,t){var n=d.call(e);if(n){i.call(this);var o=l.call(this,n,t),r=o.length-n.length,a=c.call(e)+r;d.call(e,o,a,!0)}},u=function(e){var t=a.call(this,e);return t?("-"===t[0]&&(t[0]="-0"),parseFloat(t.join("."))):null},c=function(e,t){if(void 0===e){if("DIV"==this.tagName){var n=0;if(a=window.getSelection())if(0!==a.rangeCount)(r=(l=a.getRangeAt(0)).cloneRange()).selectNodeContents(this),r.setEnd(l.endContainer,l.endOffset),n=r.toString().length;return n}return this.selectionStart}var o=d.call(this);if(t){for(var r=null,i=0;i<o.length;i++)(o[i].match(/[\-0-9]/g)||"."==o[i]||","==o[i])&&(r=i);null===r&&(r=o.indexOf(" ")),e>=r&&(e=r+1)}if(e>o.length&&(e=o.length),e)if("DIV"==this.tagName){var a=window.getSelection(),l=document.createRange();this.childNodes[0]&&(l.setStart(this.childNodes[0],e),a.removeAllRanges(),a.addRange(l))}else this.selectionStart=e,this.selectionEnd=e},d=function(e,t,n){if("DIV"==this.tagName){if(void 0===e){e=this.innerText;return this.value&&this.value.length>e.length&&(e=this.value),e}this.innerText!==e&&(this.innerText=e,t&&c.call(this,t,n))}else{if(void 0===e)return this.value;this.value!==e&&(this.value=e,t&&c.call(this,t,n))}},p=e.calendar.weekdays,f=e.calendar.weekdaysShort,h=e.calendar.months,b=e.calendar.monthsShort,g={YEAR:function(e,t){var n=""+(new Date).getFullYear();if(void 0===this.values[this.index]&&(this.values[this.index]=""),parseInt(e)>=0&&parseInt(e)<=10&&this.values[this.index].length<t&&(this.values[this.index]+=e),this.values[this.index].length==t){if(2==t)n=n.substr(0,2)+this.values[this.index];else if(3==t)n=n.substr(0,1)+this.values[this.index];else if(4==t)n=this.values[this.index];this.date[0]=n,this.index++}},YYYY:function(e){g.YEAR.call(this,e,4)},YYY:function(e){g.YEAR.call(this,e,3)},YY:function(e){g.YEAR.call(this,e,2)},FIND:function(e,t){o(this.values[this.index])&&(this.values[this.index]="");for(var n=0,r=0,i=(this.values[this.index]+e).toLowerCase(),a=0;a<t.length;a++)0==t[a].toLowerCase().indexOf(i)&&(n=a,r++);if(r>1)this.values[this.index]+=e;else if(1==r){var l=t[n].length-this.values[this.index].length-1;return this.position+=l,this.values[this.index]=t[n],this.index++,n}},MMM:function(e){var t=g.FIND.call(this,e,b);void 0!==t&&(this.date[1]=t+1)},MMMM:function(e){var t=g.FIND.call(this,e,h);void 0!==t&&(this.date[1]=t+1)},MMMMM:function(e){o(this.values[this.index])&&(this.values[this.index]="");for(var t=(this.values[this.index]+e).toLowerCase(),n=0;n<h.length;n++)if(0==h[n][0].toLowerCase().indexOf(t)){this.values[this.index]=h[n][0],this.date[1]=n+1,this.index++;break}},MM:function(e){o(this.values[this.index])?parseInt(e)>1&&parseInt(e)<10?(this.date[1]=this.values[this.index]="0"+e,this.index++):parseInt(e)<2&&(this.values[this.index]=e):(1==this.values[this.index]&&parseInt(e)<3||0==this.values[this.index]&&parseInt(e)>0&&parseInt(e)<10)&&(this.date[1]=this.values[this.index]+=e,this.index++)},M:function(e){var t=!1;if(parseInt(e)>=0&&parseInt(e)<10)if(o(this.values[this.index]))this.values[this.index]=e,e>1&&(this.date[1]=this.values[this.index],this.index++);else if(1==this.values[this.index]&&parseInt(e)<3)this.date[1]=this.values[this.index]+=e,this.index++;else if(0==this.values[this.index]&&parseInt(e)>0)this.date[1]=this.values[this.index]+=e,this.index++;else t=!0;else t=!0;if(1==t){var n=parseInt(this.values[this.index]);n>0&&n<12&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},D:function(e){var t=!1;if(parseInt(e)>=0&&parseInt(e)<10)if(o(this.values[this.index]))this.values[this.index]=e,parseInt(e)>3&&(this.date[2]=this.values[this.index],this.index++);else if(3==this.values[this.index]&&parseInt(e)<2)this.date[2]=this.values[this.index]+=e,this.index++;else if(1==this.values[this.index]||2==this.values[this.index])this.date[2]=this.values[this.index]+=e,this.index++;else if(0==this.values[this.index]&&parseInt(e)>0)this.date[2]=this.values[this.index]+=e,this.index++;else t=!0;else t=!0;if(1==t){var n=parseInt(this.values[this.index]);n>0&&n<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(e){o(this.values[this.index])?parseInt(e)>3&&parseInt(e)<10?(this.date[2]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(3==this.values[this.index]&&parseInt(e)<2||(1==this.values[this.index]||2==this.values[this.index])&&parseInt(e)<10||0==this.values[this.index]&&parseInt(e)>0&&parseInt(e)<10)&&(this.date[2]=this.values[this.index]+=e,this.index++)},DDD:function(e){g.FIND.call(this,e,f)},DDDD:function(e){g.FIND.call(this,e,p)},HH12:function(e,t){o(this.values[this.index])?parseInt(e)>1&&parseInt(e)<10?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(1==this.values[this.index]&&parseInt(e)<3||this.values[this.index]<1&&parseInt(e)<10)&&(this.date[3]=this.values[this.index]+=e,this.index++)},HH24:function(e,t){parseInt(e)>=0&&parseInt(e)<10&&(null==this.values[this.index]||""==this.values[this.index]?parseInt(e)>2&&parseInt(e)<10?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(2==this.values[this.index]&&parseInt(e)<4||this.values[this.index]<2&&parseInt(e)<10)&&(this.date[3]=this.values[this.index]+=e,this.index++))},HH:function(e){g.HH24.call(this,e,1)},H:function(e){g.HH24.call(this,e,0)},"\\[H\\]":function(e){null==this.values[this.index]&&(this.values[this.index]=""),e.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=e:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(e,t){null==this.values[this.index]||""==this.values[this.index]?parseInt(e)>5&&parseInt(e)<10?(this.date[t]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):parseInt(e)<10&&(this.date[t]=this.values[this.index]+=e,this.index++)},MI:function(e){g.N60.call(this,e,4)},SS:function(e){g.N60.call(this,e,5)},"AM/PM":function(e){this.values[this.index]="",e&&(this.date[3]>12?this.values[this.index]="PM":this.values[this.index]="AM"),this.index++},WD:function(e){void 0===this.values[this.index]&&(this.values[this.index]=""),parseInt(e)>=0&&parseInt(e)<7&&(this.values[this.index]=e),1==this.value[this.index].length&&this.index++},"0{1}(.{1}0+)?":function(e){var t=i.call(this),n=!1;o(this.values[this.index])?this.values[this.index]="":"-"==this.values[this.index]&&(n=!0);var r=a.call(this,this.values[this.index],t);r&&(this.values[this.index]=r.join(t)),parseInt(e)>=0&&parseInt(e)<10?("0"==this.values[this.index]&&e>0?this.values[this.index]="":"-0"==this.values[this.index]&&e>0&&(this.values[this.index]="-"),("0"!=this.values[this.index]&&"-0"!=this.values[this.index]||e==t)&&(this.values[this.index]+=e)):t&&e==t?-1==this.values[this.index].indexOf(t)&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=e):"-"==e&&(n=!0),!0===n&&"-"!==this.values[this.index][0]&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?%":function(e){g["0{1}(.{1}0+)?"].call(this,e),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&-1==this.values[this.index].indexOf("%")&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(e){g["0{1}(.{1}0+)?"].call(this,e);var t=i.call(this),n=this.tokens[this.index].substr(1,1),o="-"===this.values[this.index][0],r=a.call(this,this.values[this.index],t);if(""!==r){var l=r[0].match(/[0-9]/g);if(l){for(var s=[],u=0,c=(l=l.join("")).length-1;c>=0;c--)s.push(l[c]),++u%3||s.push(n);s=s.reverse(),r[0]=s.join(""),r[0].substr(0,1)==n&&(r[0]=r[0].substr(1))}else r[0]="";this.values[this.index]=r.join(t),o&&(this.values[this.index]="-"+this.values[this.index])}},0:function(e){e.match(/[0-9]/g)&&(this.values[this.index]=e,this.index++)},"[0-9a-zA-Z$]+":function(e){o(this.values[this.index])&&(this.values[this.index]="");var t=this.tokens[this.index];t[this.values[this.index].length]==e?(this.values[this.index]+=e,this.values[this.index]==t&&this.index++):(this.values[this.index]=t,this.index++,e.match(/[\-0-9]/g)&&this.position--)},A:function(e){e.match(/[a-zA-Z]/gi)&&(this.values[this.index]=e,this.index++)},".":function(e){g["[0-9a-zA-Z$]+"].call(this,e)},"@":function(e){o(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=e}},m=function(e){if("general"==this.type)var n=[].concat(t.general);else n=[].concat(t.currency,t.datetime,t.percentage,t.numeric,t.text,t.general);var o=new RegExp(n.join("|"),"gi");return e.match(o)},j=function(e){if(this.type)if("text"==this.type)n=["text"];else if("general"==this.type)n=["general"];else if("datetime"==this.type)n=["numeric","datetime","general"];else n=["currency","percentage","numeric","general"];else var n=Object.keys(t);for(var o=0;o<n.length;o++)for(var r=n[o],i=0;i<t[r].length;i++){var a=new RegExp(t[r][i],"gi");if(e.match(a))return{type:r,method:t[r][i]}}},v=function(e){for(var t=[],n=0;n<e.length;n++){var o=j.call(this,e[n]);o?t.push(o.method):t.push(null)}for(n=0;n<t.length;n++)"MM"==t[n]&&(t[n-1]&&t[n-1].indexOf("H")>=0||t[n-2]&&t[n-2].indexOf("H")>=0||t[n+1]&&t[n+1].indexOf("S")>=0||t[n+2]&&t[n+2].indexOf("S")>=0)&&(t[n]="MI");return t},y=function(e){var t=j.call(this,e);if(t)var n=t.type;if(n){for(var o=0,i=m.call(this,e),a=0;a<i.length;a++)(t=j.call(this,i[a]))&&r(t.type)&&o++;o>1&&(n="general")}return n},x=function(){"function"==typeof g[this.methods[this.index]]?(g[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},C=function(t,o,a){var p=null,f={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if("object"==typeof t){if(f.input=t.target,f.value=d.call(t.target),f.caret=c.call(t.target),(p=t.target.getAttribute("data-mask"))&&(f.mask=p),(p=t.target.getAttribute("data-type"))&&(f.type=p),t.target.mask?(t.target.mask.options&&(f.options=t.target.mask.options),t.target.mask.locale&&(f.locale=t.target.mask.locale)):(p=t.target.getAttribute("data-locale"))&&(f.locale=p,f.mask&&(f.options.style=f.mask)),t.target.attributes&&t.target.attributes.length)for(var h=0;h<t.target.attributes.length;h++){var b=t.target.attributes[h].name,g=t.target.attributes[h].value;"data"==b.substr(0,4)&&(f.options[b.substr(5)]=g)}}else{if("string"==typeof o)f.mask=o;else for(b=Object.keys(o),h=0;h<b.length;h++)f[b[h]]=o[b[h]];"number"==typeof t&&(i.call(f,f.mask),t=(""+t).replace(".",f.options.decimal)),f.value=t,f.input&&(d.call(f.input,t),e.focus(f.input),f.caret=c.call(f.input))}if("="!=(""+f.value)[0]&&(f.mask||f.locale)){if(f.mask){if(f.mask=f.mask.replace(new RegExp(/\[.*?\]/),""),-1!==f.mask.indexOf(";")){p=f.mask.split(";");f.mask=p[0]}if(-1!==f.mask.indexOf("##")){var C=f.mask.split(";");C[0]&&(C[0]=C[0].replace("*","\t"),C[0]=C[0].replace(new RegExp(/_-/g)," "),C[0]=C[0].replace(new RegExp(/_/g),""),C[0]=C[0].replace("##0.###","##0.000"),C[0]=C[0].replace("##0.##","##0.00"),C[0]=C[0].replace("##0.#","##0.0")),f.mask=C[0]}f.type||(f.type=y.call(f,f.mask)),f.tokens=m.call(f,f.mask)}if("object"!=typeof t||!t.inputType||!t.inputType.indexOf("insert")||!t.inputType.indexOf("delete"))if(f.locale)if(f.input)s.call(f,f.input,t);else var w=l.call(f,f.value);else{for(f.methods=v.call(f,f.tokens);f.position<f.value.length&&void 0!==f.tokens[f.index];)x.call(f);w=f.values.join("");if(r(f.type)&&""!==w){for(;void 0!==f.tokens[f.index];){(p=j.call(f,f.tokens[f.index]))&&"general"==p.type&&(f.values[f.index]=f.tokens[f.index]),f.index++}var E=!0}else E=!1;if(w=f.values.join(""),f.input){if((p=w.length-f.value.length)>0)var A=f.caret+p;else A=f.caret;d.call(f.input,w,A,E)}}if(f.input){var L=null;r(f.type)?(f.number=u.call(f,d.call(f.input)),L="percentage"==f.type?f.number/100:f.number):"datetime"==f.type&&(L=n.call(f),f.date[0]&&f.date[1]&&f.date[2]&&f.input.setAttribute("data-completed",!0)),L&&f.input.setAttribute("data-value",L)}if(void 0!==w)return a?f:w}};return C.getType=y,C.prepare=function(e,t){return t||(t={}),m.call(t,e)},C.apply=function(e){var t=d.call(e.target);1==e.key.length&&(t+=e.key),d.call(e.target,C(t,e.target.getAttribute("data-mask")))},C.run=function(e,t,n){return C(e,{mask:t,decimal:n})},C.extract=function(t,r,a){if(o(t))return t;if("object"!=typeof r)return d;if((r=Object.assign({},r)).options||(r.options={}),!r.mask&&r.format&&(r.mask=r.format),r.mask){if(-1!==r.mask.indexOf(";")){var l=r.mask.split(";");r.mask=l[0]}r.mask=r.mask.replace(new RegExp(/\[.*?\]/),"")}i.call(r,r.mask);var s=null;if("percent"==r.type||"percent"==r.options.style?s="percentage":r.mask&&(s=y.call(r,r.mask)),"general"===s){var c=C(t,r,!0);d=t}else if("datetime"===s){if(t instanceof Date)l=e.calendar.getDateString(d,r.mask);c=C(t,r,!0);if(e.isNumeric(t))d=t;else{var d=n.call(c);l=e.calendar.now(c.date);d=e.calendar.dateToNum(l)}}else{d=u.call(r,t);"percentage"==s&&(d/=100);c=r}return c.value=d,!c.type&&s&&(c.type=s),a?c:d},C.render=function(t,n,r){if(o(t))return t;if("object"!=typeof n)return t;if((n=Object.assign({},n)).options||(n.options={}),!n.mask&&n.format&&(n.mask=n.format),n.mask){if(-1!==n.mask.indexOf(";")){var a=n.mask.split(";");n.mask=a[0]}n.mask=n.mask.replace(new RegExp(/\[.*?\]/),"")}var l=null;"percent"==n.type||"percent"==n.options.style?l="percentage":n.mask?l=y.call(n,n.mask):t instanceof Date&&(l="datetime");var s=!1;if("datetime"==l||"calendar"==n.type)(a=e.calendar.getDateString(t,n.mask))&&(t=a),n.mask&&r&&(s=!0);else if("percentage"==l&&(t*=100),"number"==typeof t){a=null;if(n.mask&&r){var u=i.call(n,n.mask);-1!==n.mask.indexOf(u)?(u=(u=""+(u=n.mask.split(u))[1].match(/[0-9]+/g)).length,a=t.toFixed(u)):a=t.toFixed(0)}else if(n.locale&&r){u=(""+t).split(".");if(n.options){void 0===u[1]&&(u[1]="");var c=u[1].length;if(n.options.minimumFractionDigits>c)for(var d=0;d<n.options.minimumFractionDigits-c;d++)u[1]+="0"}a=u[1].length?u.join("."):u[0];c=u[1].length;n.options&&n.options.maximumFractionDigits<c&&(a=parseFloat(a).toFixed(n.options.maximumFractionDigits))}else a=(""+ +t).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,(function(e,t,n,o,r){return r<0?t+"0."+Array(1-r-n.length).join(0)+n+o:t+n+o+Array(r-o.length+1).join(0)}));null!==a&&(t=a,i.call(n,n.mask),n.options.decimal&&(t=t.replace(".",n.options.decimal)))}else n.mask&&r&&(s=!0);if(s){var p=n.mask.length-t.length;if(p>0)for(d=0;d<p;d++)t+=" "}return t=C(t,n)},C.set=function(e,t){if(t){e.setAttribute("data-mask",t);var n=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(n)}},"undefined"!=typeof document&&document.addEventListener("input",(function(e){(e.target.getAttribute("data-mask")||e.target.mask)&&C(e)})),C}(),e.modal=function(t,n){var o={options:{}},r={url:null,onopen:null,onclose:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0};for(var i in r)n&&n.hasOwnProperty(i)?o.options[i]=n[i]:o.options[i]=r[i];!o.options.title&&t.getAttribute("title")&&(o.options.title=t.getAttribute("title"));for(var a=document.createElement("div");t.children[0];)a.appendChild(t.children[0]);for(o.content=document.createElement("div"),o.content.className="jmodal_content",o.content.innerHTML=t.innerHTML;a.children[0];)o.content.appendChild(a.children[0]);if(o.container=document.createElement("div"),o.container.className="jmodal",o.container.appendChild(o.content),o.options.padding&&(o.content.style.padding=o.options.padding),o.options.width&&(o.container.style.width=o.options.width),o.options.height&&(o.container.style.height=o.options.height),o.options.title?o.container.setAttribute("title",o.options.title):o.container.classList.add("no-title"),t.innerHTML="",t.style.display="none",t.appendChild(o.container),o.options.backdrop){var l=document.createElement("div");l.className="jmodal_backdrop",l.onclick=function(){o.close()},t.appendChild(l)}if(o.open=function(){t.style.display="block";var n=o.container.getBoundingClientRect();e.getWindowWidth()<n.width?(o.container.style.top="",o.container.style.left="",o.container.classList.add("jmodal_fullscreen"),e.animation.slideBottom(o.container,1)):o.options.backdrop&&(l.style.display="block"),"function"==typeof o.options.onopen&&o.options.onopen(t,o)},o.resetPosition=function(){o.container.style.top="",o.container.style.left=""},o.isOpen=function(){return"none"!=t.style.display},o.close=function(){o.isOpen()&&(t.style.display="none",o.options.backdrop&&(l.style.display=""),o.container.classList.remove("jmodal_fullscreen"),"function"==typeof o.options.onclose&&o.options.onclose(t,o))},!e.modal.hasEvents){var s=null;document.addEventListener("keydown",(function(e){if(27==e.which)for(var t=document.querySelectorAll(".jmodal"),n=0;n<t.length;n++)t[n].parentNode.modal.close()})),document.addEventListener("mouseup",(function(t){var n=e.findElement(t.target,"jmodal");if(n){var o=n.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var r=t.changedTouches[0].clientX,i=t.changedTouches[0].clientY;else r=t.clientX,i=t.clientY;o.width-(r-o.left)<50&&i-o.top<50&&n.parentNode.modal.close()}s&&(s.element.style.cursor="auto",s=null)})),document.addEventListener("mousedown",(function(t){var n=e.findElement(t.target,"jmodal");if(n){var o=n.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var r=t.changedTouches[0].clientX,i=t.changedTouches[0].clientY;else r=t.clientX,i=t.clientY;o.width-(r-o.left)<50&&i-o.top<50||t.target.getAttribute("title")&&i-o.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),s={left:o.left,top:o.top,x:t.clientX,y:t.clientY,width:o.width,height:o.height,element:n})}})),document.addEventListener("mousemove",(function(e){if(s){if((e=e||window.event).buttons)var t=e.buttons;else if(e.button)t=e.button;else t=e.which;t?(s.element.style.top=s.top+(e.clientY-s.y)+s.height/2+"px",s.element.style.left=s.left+(e.clientX-s.x)+s.width/2+"px",s.element.style.cursor="move"):s.element.style.cursor="auto"}})),e.modal.hasEvents=!0}return o.options.url?e.ajax({url:o.options.url,method:"GET",dataType:"text/html",success:function(e){o.content.innerHTML=e,o.options.closed||o.open()}}):o.options.closed||o.open(),t.modal=o,o},e.notification=function(t){var n={options:{}},o={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var r in o)t&&t.hasOwnProperty(r)?n.options[r]=t[r]:n.options[r]=o[r];var i=document.createElement("div");i.className="jnotification",n.options.error&&i.classList.add("jnotification-error");var a=document.createElement("div");a.className="jnotification-container",i.appendChild(a);var l=document.createElement("div");l.className="jnotification-header",a.appendChild(l);var s=document.createElement("div");if(s.className="jnotification-image",l.appendChild(s),n.options.icon){var u=document.createElement("img");u.src=n.options.icon,s.appendChild(u)}var c=document.createElement("div");if(c.className="jnotification-name",c.innerHTML=n.options.name,l.appendChild(c),1==n.options.closeable){var d=document.createElement("div");d.className="jnotification-close",d.onclick=function(){n.hide()},l.appendChild(d)}var p=document.createElement("div");p.className="jnotification-date",l.appendChild(p);var f=document.createElement("div");if(f.className="jnotification-content",a.appendChild(f),n.options.title){var h=document.createElement("div");h.className="jnotification-title",h.innerHTML=n.options.title,f.appendChild(h)}var b=document.createElement("div");if(b.className="jnotification-message",b.innerHTML=n.options.message,f.appendChild(b),n.show=function(){document.body.appendChild(i),e.getWindowWidth()>800?e.animation.fadeIn(i):e.animation.slideTop(i,1)},n.hide=function(){e.getWindowWidth()>800?e.animation.fadeOut(i,(function(){i.parentNode&&(i.parentNode.removeChild(i),g&&clearTimeout(g))})):e.animation.slideTop(i,0,(function(){i.parentNode&&(i.parentNode.removeChild(i),g&&clearTimeout(g))}))},n.show(),1==n.options.autoHide)var g=setTimeout((function(){n.hide()}),n.options.timeout);return e.getWindowWidth()<800&&i.addEventListener("swipeup",(function(e){n.hide(),e.preventDefault(),e.stopPropagation()})),n},e.notification.isVisible=function(){var e=document.querySelector(".jnotification");return!(!e||!e.parentNode)},e.palette=(t={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},(n=function(e){return t[e]?t[e]:t.material}).get=function(e){return t[e]?t[e]:t},n.set=function(e,n){t[e]=n},n),e.picker=function(t,n){if(t.picker)return t.picker.setOptions(n,!0);var o={type:"picker",options:{}},r=null,i=null;o.setOptions=function(e,t){var n={value:0,data:null,render:null,onchange:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,content:!1,columns:null,height:null};for(var a in e&&e.options&&(e.data=e.options),n)e&&e.hasOwnProperty(a)?o.options[a]=e[a]:void 0!==o.options[a]&&!0!==t||(o.options[a]=n[a]);return!1===o.options.header?r.style.display="none":r.style.display="",o.options.width?r.style.width=parseInt(o.options.width)+"px":r.style.width="",o.options.height?(i.style.maxHeight=o.options.height+"px",i.style.overflow="scroll"):i.style.overflow="",o.options.columns>0&&(i.classList.add("jpicker-columns"),i.style.width=o.options.width?o.options.width:36*o.options.columns+"px"),isNaN(o.options.value)&&(o.options.value="0"),function(){i.innerHTML="";for(var e=Object.keys(o.options.data),t=0;t<e.length;t++){var n=document.createElement("div");n.classList.add("jpicker-item"),n.k=e[t],n.v=o.options.data[e[t]],n.innerHTML=o.getLabel(e[t]),i.appendChild(n)}}(),o.setValue(o.options.value),o},o.getValue=function(){return o.options.value},o.setValue=function(e){o.setLabel(e),o.options.value=String(e),t.value!=o.options.value&&(t.value=o.options.value,"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value})),"generic"!==i.children[e].getAttribute("type")&&o.close()},o.getLabel=function(e){var t=o.options.data[e]||null;return"function"==typeof o.options.render&&(t=o.options.render(t)),t},o.setLabel=function(e){if(o.options.content)var t='<i class="material-icons">'+o.options.content+"</i>";else t=o.getLabel(e);r.innerHTML=t},o.open=function(){if(!t.classList.contains("jpicker-focus")){e.tracking(o,!0),t.classList.add("jpicker-focus"),t.focus();var n=0,a=0;i.style.marginLeft="";var l=r.getBoundingClientRect(),s=i.getBoundingClientRect();n=window.innerHeight<l.bottom+s.height?-1*(s.height+4):l.height+4,!0===o.options.right&&(a=-1*s.width+l.width),s.left+a<0&&(a=a+s.left+10),s.left+s.width>window.innerWidth&&(a=-1*(10+s.left+s.width-window.innerWidth)),i.style.marginTop=parseInt(n)+"px",i.style.marginLeft=parseInt(a)+"px","function"==typeof o.options.onopen&&o.options.onopen(t,o)}},o.close=function(){t.classList.contains("jpicker-focus")&&(t.classList.remove("jpicker-focus"),e.tracking(o,!1),"function"==typeof o.options.onclose&&o.options.onclose(t,o))};return t.classList.add("jpicker"),t.setAttribute("tabindex","900"),t.onmousedown=function(e){t.classList.contains("jpicker-focus")||o.open()},(r=document.createElement("div")).classList.add("jpicker-header"),(i=document.createElement("div")).classList.add("jpicker-content"),i.onclick=function(n){var r=e.findElement(n.target,"jpicker-item");r&&r.parentNode===i&&(o.setValue(r.k),"function"==typeof o.options.onchange&&o.options.onchange.call(o,t,o,r.v,r.v,r.k,n))},t.appendChild(r),t.appendChild(i),t.value=n.value||0,o.setOptions(n),"function"==typeof o.options.onload&&o.options.onload(t,o),t.change=o.setValue,t.val=function(e){if(void 0===e)return o.getValue();o.setValue(e)},t.picker=o,o},e.progressbar=function(e,t){var n={options:{}},o={value:0,onchange:null,width:null};for(var r in o)t&&t.hasOwnProperty(r)?n.options[r]=t[r]:n.options[r]=o[r];e.classList.add("jprogressbar"),e.setAttribute("tabindex",1),e.setAttribute("data-value",n.options.value);var i=document.createElement("div");i.style.width=n.options.value+"%",i.style.color="#fff",e.appendChild(i),n.options.width&&(e.style.width=n.options.width),n.setValue=function(t){t=parseInt(t),n.options.value=t,i.style.width=t+"%",e.setAttribute("data-value",t+"%"),e.style.color=t<6?"#000":"#fff",n.options.value=t,"function"==typeof n.options.onchange&&n.options.onchange(e,t),e.value!=n.options.value&&(e.value=n.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value}))},n.getValue=function(){return n.options.value};var a=function(t){if(t.which){var o=e.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0]){var r=t.changedTouches[0].clientX;t.changedTouches[0].clientY}else r=t.clientX,t.clientY;n.setValue(Math.round((r-o.left)/o.width*100))}};return"touchstart"in document.documentElement==!0?(e.addEventListener("touchstart",a),e.addEventListener("touchend",a)):(e.addEventListener("mousedown",a),e.addEventListener("mousemove",a)),e.change=n.setValue,e.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},e.progressbar=n,n},e.rating=function(e,t){if(e.rating)return e.rating.setOptions(t,!0);var n={options:{},setOptions:function(t,o){var r={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var i in r)t&&t.hasOwnProperty(i)?n.options[i]=t[i]:void 0!==n.options[i]&&!0!==o||(n.options[i]=r[i]);e.innerHTML="";for(var a=0;a<n.options.number;a++){var l=document.createElement("div");l.setAttribute("data-index",a+1),l.setAttribute("title",n.options.tooltip[a]),e.appendChild(l)}if(n.options.value)for(a=0;a<n.options.number;a++)a<n.options.value&&e.children[a].classList.add("jrating-selected");return n},setValue:function(t){for(var o=0;o<n.options.number;o++)o<t?e.children[o].classList.add("jrating-selected"):(e.children[o].classList.remove("jrating-over"),e.children[o].classList.remove("jrating-selected"));n.options.value=t,"function"==typeof n.options.onchange&&n.options.onchange(e,t),e.value!=n.options.value&&(e.value=n.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value}))},getValue:function(){return n.options.value}};return n.setOptions(t),e.classList.add("jrating"),e.addEventListener("click",(function(e){var t=e.target.getAttribute("data-index");null!=t&&(t==n.options.value?n.setValue(0):n.setValue(t))})),e.addEventListener("mouseover",(function(t){for(var o=t.target.getAttribute("data-index"),r=0;r<n.options.number;r++)r<o?e.children[r].classList.add("jrating-over"):e.children[r].classList.remove("jrating-over")})),e.addEventListener("mouseout",(function(t){for(var o=0;o<n.options.number;o++)e.children[o].classList.remove("jrating-over")})),e.change=n.setValue,e.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},e.rating=n,n},e.search=function(t,n){if(t.search)return t.search;var o=null,r=function(e){if(s.innerHTML="",e.length){t.style.display="block";for(var n=e.length<11?e.length:10,o=0;o<n;o++){if("string"==typeof e[o])var r=e[o],i=e[o];else!(r=e[o].text)&&e[o].name&&(r=e[o].name),!(i=e[o].value)&&e[o].id&&(i=e[o].id);var a=document.createElement("div");a.setAttribute("data-value",i),a.setAttribute("data-text",r),a.className="jsearch_item",e[o].id&&a.setAttribute("id",e[o].id),l.options.forceSelect&&0==o&&a.classList.add("selected");var u=document.createElement("img");e[o].image?u.src=e[o].image:u.style.display="none",a.appendChild(u);var c=document.createElement("div");c.innerHTML=r,a.appendChild(c),s.appendChild(a)}}else t.style.display=""},i=function(t){if(t!=l.terms)if(l.terms=t,o=l.options.forceSelect?0:null,Array.isArray(l.options.data)){var n=l.options.data.filter((function(e){return function(e){if("string"==typeof e){if((""+e).toLowerCase().search(t.toLowerCase())>=0)return!0}else for(var n in e)if((""+e[n]).toLowerCase().search(t.toLowerCase())>=0)return!0;return!1}(e)}));r(n)}else e.ajax({url:l.options.data+t,method:"GET",dataType:"json",success:function(e){r(e)}})},a=null,l=function(e){a&&clearTimeout(a),a=setTimeout((function(){i(e)}),500)};null===n.forceSelect&&(n.forceSelect=!0),l.options={data:n.data||null,input:n.input||null,searchByNode:n.searchByNode||null,onselect:n.onselect||null,forceSelect:n.forceSelect,onbeforesearch:n.onbeforesearch||null},l.selectIndex=function(e){var t=e.getAttribute("id"),n=e.getAttribute("data-text"),o=e.getAttribute("data-value");"function"==typeof l.options.onselect&&l.options.onselect(l,n,o,t),l.close()},l.open=function(){t.style.display="block"},l.close=function(){a&&clearTimeout(a),l.terms="",s.innerHTML="",t.style.display=""},l.isOpened=function(){return!!t.style.display},l.keydown=function(e){l.isOpened()&&("Enter"==e.key?null!==o&&s.children[o]?(l.selectIndex(s.children[o]),e.preventDefault()):l.close():"ArrowUp"===e.key?(null!==o&&s.children[0]&&(s.children[o].classList.remove("selected"),l.options.forceSelect||0!==o?(o=Math.max(0,o-1),s.children[o].classList.add("selected")):o=null),e.preventDefault()):"ArrowDown"===e.key&&(null==o?o=-1:s.children[o].classList.remove("selected"),o<9&&s.children[o+1]&&o++,s.children[o].classList.add("selected"),e.preventDefault()))},l.keyup=function(t){if(l.options.searchByNode){var n=e.getNode();if(n)o=n.innerText}else if("DIV"===l.options.input.tagName)var o=l.options.input.innerText;else var o=l.options.input.value;if("function"==typeof l.options.onbeforesearch){var r=l.options.onbeforesearch(l,o);if(r)o=r;else if(!1===r)return}l(o)},l.options.input&&(l.options.input.addEventListener("keyup",l.keyup),l.options.input.addEventListener("keydown",l.keydown));var s=document.createElement("div");return s.classList.add("jsearch_container"),s.onmousedown=function(e){if(e.target.classList.contains("jsearch_item"))var t=e.target;else t=e.target.parentNode;l.selectIndex(t),e.preventDefault()},t.appendChild(s),t.classList.add("jsearch"),t.search=l,l},e.slider=function(e,t){var n={options:{},currentImage:null};if(t&&(n.options=t),e.setAttribute("tabindex","900"),n.options.items=[],!e.classList.contains("jslider")){if(e.classList.add("jslider"),e.classList.add("unselectable"),n.options.height&&(e.style.minHeight=n.options.height),n.options.width&&(e.style.width=n.options.width),n.options.grid){e.classList.add("jslider-grid");var o=e.children.length;o>4&&e.setAttribute("data-total",o-4),e.setAttribute("data-number",o>4?4:o)}var r=document.createElement("div");if(r.classList.add("jslider-counter"),e.children.length>0)for(var i=0;i<e.children.length;i++){n.options.items.push(e.children[i]);var a=document.createElement("div");a.onclick=function(){var e=Array.prototype.slice.call(r.children).indexOf(this);n.show(n.currentImage=n.options.items[e])},r.appendChild(a)}var l=document.createElement("div");l.className="jslider-caption";var s=document.createElement("div"),u=document.createElement("div");u.className="jslider-close",u.innerHTML="",u.onclick=function(){n.close()},s.appendChild(l),s.appendChild(u)}n.updateCounter=function(e){for(var t=0;t<r.children.length;t++)if(r.children[t].classList.contains("jslider-counter-focus")){r.children[t].classList.remove("jslider-counter-focus");break}r.children[e].classList.add("jslider-counter-focus")},n.show=function(t){if(!t)t=e.children[0];e.classList.add("jslider-focus"),e.classList.remove("jslider-grid"),e.appendChild(s),e.appendChild(r);var o=n.options.items.indexOf(t);n.updateCounter(o);for(var i=0;i<e.children.length;i++)e.children[i].style.display="";t.style.display="block",t.previousElementSibling?e.classList.add("jslider-left"):e.classList.remove("jslider-left"),t.nextElementSibling&&"IMG"==t.nextElementSibling.tagName?e.classList.add("jslider-right"):e.classList.remove("jslider-right"),n.currentImage=t,n.currentImage.offsetHeight>n.currentImage.offsetWidth&&n.currentImage.classList.add("jslider-vertical"),s.children[0].innerText=n.currentImage.getAttribute("title")},n.open=function(){n.show(),"function"==typeof n.options.onopen&&n.options.onopen(e)},n.close=function(){e.classList.remove("jslider-focus"),e.classList.remove("jslider-left"),e.classList.remove("jslider-right"),n.options.grid&&e.classList.add("jslider-grid");for(var t=0;t<e.children.length;t++)e.children[t].style.display="";r.remove(),s.remove(),n.currentImage=null,"function"==typeof n.options.onclose&&n.options.onclose(e)},n.reset=function(){e.innerHTML=""},n.next=function(){var e=n.currentImage.nextElementSibling;e&&"IMG"===e.tagName&&n.show(n.currentImage.nextElementSibling)},n.prev=function(){n.currentImage.previousElementSibling&&n.show(n.currentImage.previousElementSibling)};var c=function(e){if("IMG"==e.target.tagName)n.show(e.target);else if(!e.target.classList.contains("jslider-close")&&!e.target.parentNode.classList.contains("jslider-counter")&&!e.target.classList.contains("jslider-counter")){var t=e.offsetX||e.changedTouches[0].clientX;e.target.clientWidth-t<40?n.next():t<40&&n.prev()}};return"ontouchend"in document.documentElement==!0?e.addEventListener("touchend",c):e.addEventListener("mouseup",c),e.addEventListener("swipeleft",(function(e){n.next(),e.preventDefault(),e.stopPropagation()})),e.addEventListener("swiperight",(function(e){n.prev(),e.preventDefault(),e.stopPropagation()})),e.addEventListener("keydown",(function(e){27==e.which&&n.close()})),e.slider=n,n},e.sorting=function(e,t){var n={options:{}},o={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},r=null;for(var i in o)t&&t.hasOwnProperty(i)?n.options[i]=t[i]:n.options[i]=o[i];e.classList.add("jsorting"),e.addEventListener("dragstart",(function(t){var o=Array.prototype.indexOf.call(t.target.parentNode.children,t.target);r={element:t.target,o:o,d:o},t.target.style.opacity="0.25","function"==typeof n.options.ondragstart&&n.options.ondragstart(e,t.target,t)})),e.addEventListener("dragover",(function(e){if(e.preventDefault(),a(e.target)&&r&&"true"==e.target.getAttribute("draggable")&&r.element!=e.target){if(n.options.direction)t=e.target.clientWidth/2>e.offsetX;else var t=e.target.clientHeight/2>e.offsetY;t?e.target.parentNode.insertBefore(r.element,e.target):e.target.parentNode.insertBefore(r.element,e.target.nextSibling),r.d=Array.prototype.indexOf.call(e.target.parentNode.children,r.element)}})),e.addEventListener("dragleave",(function(e){e.preventDefault()})),e.addEventListener("dragend",(function(t){t.preventDefault(),r&&("function"==typeof n.options.ondragend&&n.options.ondragend(e,r.element,t),r.o<r.d?t.target.parentNode.insertBefore(r.element,t.target.parentNode.children[r.o]):t.target.parentNode.insertBefore(r.element,t.target.parentNode.children[r.o].nextSibling),r.element.style.opacity="",r=null)})),e.addEventListener("drop",(function(t){t.preventDefault(),r&&r.o!=r.d&&"function"==typeof n.options.ondrop&&n.options.ondrop(e,r.o,r.d,r.element,t.target,t),r.element.style.opacity="",r=null}));for(var a=function(e){var t=!1;return function e(n){n.className&&n.classList.contains("jsorting")&&(t=!0),t||e(n.parentNode)}(e),t},l=0;l<e.children.length;l++)e.children[l].hasAttribute("draggable")||e.children[l].setAttribute("draggable","true");return e.val=function(){for(var t=null,n=[],o=0;o<e.children.length;o++)(t=e.children[o].getAttribute("data-id"))&&n.push(t);return n},e},e.tabs=function(t,n){var o={options:{}},r={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var i in r)n&&n.hasOwnProperty(i)?o.options[i]=n[i]:o.options[i]=r[i];t.classList.add("jtabs");var a=null,l=null,s=null,u=function(e){o.options.animation&&setTimeout((function(){var t=o.headers.children[e].getBoundingClientRect();"modern"==o.options.palette?(s.style.width=t.width-4+"px",s.style.left=o.headers.children[e].offsetLeft+2+"px"):(s.style.width=t.width+"px",s.style.left=o.headers.children[e].offsetLeft+"px"),"bottom"==o.options.position?s.style.top="0px":s.style.bottom="0px"}),150)},c=function(e){"function"==typeof o.headers.scrollTo?o.headers.scrollTo({left:e,behavior:"smooth"}):o.headers.scrollLeft=e,e<=1?a.classList.add("disabled"):a.classList.remove("disabled"),e>=o.headers.scrollWidth-o.headers.offsetWidth?l.classList.add("disabled"):l.classList.remove("disabled"),o.headers.scrollWidth<=o.headers.offsetWidth?(a.style.display="none",l.style.display="none"):(a.style.display="",l.style.display="")};if(o.setBorder=u,o.open=function(e){for(var n=null,r=0;r<o.headers.children.length;r++)o.headers.children[r].classList.contains("jtabs-selected")&&(n=r),o.headers.children[r].classList.remove("jtabs-selected"),o.content.children[r]&&o.content.children[r].classList.remove("jtabs-selected");if(o.headers.children[e].classList.add("jtabs-selected"),o.content.children[e]&&o.content.children[e].classList.add("jtabs-selected"),n!=e&&"function"==typeof o.options.onchange&&o.content.children[e]&&o.options.onchange(t,o,e,o.headers.children[e],o.content.children[e]),1==o.options.hideHeaders&&o.headers.children.length<3&&0==o.options.allowCreate)o.headers.parentNode.style.display="none";else{u(e),o.headers.parentNode.style.display="";var i=o.headers.children[e].offsetLeft,a=i+o.headers.children[e].offsetWidth,l=o.headers.scrollLeft,s=l+o.headers.offsetWidth;l<=i&&s>=a||c(i-1)}},o.selectIndex=function(e){var t=Array.prototype.indexOf.call(o.headers.children,e);return t>=0&&o.open(t),t},o.rename=function(e,t){t||(t=prompt("New title",o.headers.children[e].innerText)),o.headers.children[e].innerText=t,o.open(e)},o.create=function(e,n){if("function"==typeof o.options.onbeforecreate){var r=o.options.onbeforecreate(t);if(!1===r)return!1;e=r}var i=o.appendElement(e);return"function"==typeof o.options.oncreate&&o.options.oncreate(t,i),u(),i},o.remove=function(e){return o.deleteElement(e)},o.nextNumber=function(){for(var e=0,t=0;t<o.headers.children.length;t++){var n=o.headers.children[t].innerText.match(/[0-9].*/);n>e&&(e=parseInt(n))}return e?e++:e=1,e},o.deleteElement=function(e){if(!o.headers.children[e])return!1;o.headers.removeChild(o.headers.children[e]),o.content.removeChild(o.content.children[e]),o.open(0),"function"==typeof o.options.ondelete&&o.options.ondelete(t,e)},o.appendElement=function(e,t){if(!e)e=prompt("Title?","");if(e){var n=document.createElement("div");o.content.appendChild(n);var r=document.createElement("div");return r.innerHTML=e,r.content=n,o.headers.insertBefore(r,o.headers.lastChild),o.options.allowChangePosition&&r.setAttribute("draggable","true"),o.selectIndex(r),"function"==typeof t&&t(n,r),n}},o.getActive=function(){for(var e=0;e<o.headers.children.length;e++)if(o.headers.children[e].classList.contains("jtabs-selected"))return e;return 0},o.updateContent=function(e,t){"string"!=typeof t||(document.createElement("div").innerHTML=t);o.content.children[e].classList.contains("jtabs-selected")&&t.classList.add("jtabs-selected"),o.content.replaceChild(t,o.content.children[e]),u()},o.updatePosition=function(e,t){e>t?o.content.insertBefore(o.content.children[e],o.content.children[t]):o.content.insertBefore(o.content.children[e],o.content.children[t].nextSibling),o.open(t),"function"==typeof o.options.onchangeposition&&o.options.onchangeposition(o.headers,e,t)},o.move=function(e,t){e>t?o.headers.insertBefore(o.headers.children[e],o.headers.children[t]):o.headers.insertBefore(o.headers.children[e],o.headers.children[t].nextSibling),o.updatePosition(e,t)},o.setBorder=u,o.init=function(){t.innerHTML="",o.headers=document.createElement("div"),o.content=document.createElement("div"),o.headers.classList.add("jtabs-headers"),o.content.classList.add("jtabs-content"),o.options.palette?t.classList.add("jtabs-modern"):t.classList.remove("jtabs-modern"),o.options.padding&&(o.content.style.padding=parseInt(o.options.padding)+"px");var n=document.createElement("div");n.className="jtabs-headers-container",n.appendChild(o.headers),o.options.maxWidth&&(n.style.maxWidth=parseInt(o.options.maxWidth)+"px");var r=document.createElement("div");if(r.className="jtabs-controls",r.setAttribute("draggable","false"),n.appendChild(r),"bottom"==o.options.position?(t.appendChild(o.content),t.appendChild(n)):(t.appendChild(n),t.appendChild(o.content)),1==o.options.allowCreate){var i=document.createElement("div");i.className="jtabs-add",i.onclick=function(){o.create()},r.appendChild(i)}(a=document.createElement("div")).className="jtabs-prev",a.onclick=function(){c(o.headers.scrollLeft-o.headers.offsetWidth)},r.appendChild(a),(l=document.createElement("div")).className="jtabs-next",l.onclick=function(){c(o.headers.scrollLeft+o.headers.offsetWidth)},r.appendChild(l);for(var u=0;u<o.options.data.length;u++){if(o.options.data[u].titleElement)var d=o.options.data[u].titleElement;else d=document.createElement("div");if(o.options.data[u].icon){var p=document.createElement("div"),f=document.createElement("i");f.classList.add("material-icons"),f.innerHTML=o.options.data[u].icon,p.appendChild(f),d.appendChild(p)}if(o.options.data[u].title){var h=document.createTextNode(o.options.data[u].title);d.appendChild(h)}if(o.options.data[u].width&&(d.style.width=o.options.data[u].width),o.options.data[u].contentElement)var b=o.options.data[u].contentElement;else(b=document.createElement("div")).innerHTML=o.options.data[u].content;o.headers.appendChild(d),o.content.appendChild(b)}(s=document.createElement("div")).className="jtabs-border",o.headers.appendChild(s),o.options.animation&&t.classList.add("jtabs-animation"),o.headers.addEventListener("click",(function(e){if(e.target.parentNode.classList.contains("jtabs-headers"))var n=e.target;else if("I"==e.target.tagName)n=e.target.parentNode.parentNode;else n=e.target.parentNode;var r=o.selectIndex(n);"function"==typeof o.options.onclick&&o.options.onclick(t,o,r,o.headers.children[r],o.content.children[r])})),o.headers.addEventListener("contextmenu",(function(e){o.selectIndex(e.target)})),o.headers.children.length&&o.open(0),c(0),1==o.options.allowChangePosition&&e.sorting(o.headers,{direction:1,ondrop:function(e,t,n){o.updatePosition(t,n)}}),"function"==typeof o.options.onload&&o.options.onload(t,o)},t.children[0]&&t.children[0].children.length)for(var d=0;d<t.children[0].children.length;d++){var p=o.options.data&&o.options.data[d]?o.options.data[d]:{};t.children[1]&&t.children[1].children[d]?(p.titleElement=t.children[0].children[d],p.contentElement=t.children[1].children[d]):p.contentElement=t.children[0].children[d],o.options.data[d]=p}var f=!1;if(o.options.data)for(d=0;d<o.options.data.length;d++)o.options.data[d].url&&(e.ajax({url:o.options.data[d].url,type:"GET",dataType:"text/html",index:d,success:function(e){o.options.data[this.index].content=e},complete:function(){o.init()}}),f=!0);return f||o.init(),t.tabs=o,o},e.tags=function(t,n){if(t.tags)return t.tags.setOptions(n,!0);var o={type:"tags",options:{}},r=function(){return!!(o.options.limit&&t.children.length>=o.options.limit)},i=null,a=null;o.setOptions=function(n,r){var l={value:"",limit:null,limitMessage:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null,colors:null};for(var s in l)n&&n.hasOwnProperty(s)?o.options[s]=n[s]:void 0!==o.options[s]&&!0!==r||(o.options[s]=l[s]);return o.options.placeholder?t.setAttribute("data-placeholder",o.options.placeholder):t.removeAttribute("data-placeholder"),t.placeholder=o.options.placeholder,o.setValue(o.options.value),c(),o.options.search?a||(a=document.createElement("div"),t.parentNode.insertBefore(a,t.nextSibling),i=e.search(a,{data:o.options.search,onselect:function(e,t,n){o.selectIndex(t,n)}})):a&&(i=null,a.remove(),a=null),o},o.add=function(n,a){if("function"==typeof o.options.onbeforechange){var c=o.options.onbeforechange(t,o,o.options.value,n);if(!1===c)return!1;null!=c&&(n=c)}if(i&&i.close(),r())"function"==typeof o.options.onlimit?o.options.onlimit(o,o.options.limit):o.options.limitMessage&&alert(o.options.limitMessage+" "+o.options.limit);else{var d=e.getNode();if(!(d&&d.parentNode&&d.parentNode.classList.contains("jtags")&&d.nextSibling)||d.nextSibling.innerText&&d.nextSibling.innerText.trim()){if(t.lastChild&&(t.lastChild.innerText.trim()||t.removeChild(t.lastChild)),n&&"string"!=typeof n){for(var p=0;p<=n.length;p++)if(!r()){if(n[p]&&"string"!=typeof n[p])f=n[p].text,h=n[p].value;else var f=n[p]||"",h=null;b=s(f,h)}}else var b=s(n,n,d);u()}else b=d.nextSibling;a&&l(b)}},o.setLimit=function(e){o.options.limit=e;for(t.children.length;t.children.length>e;)t.removeChild(t.lastChild)},o.remove=function(e){e.parentNode.removeChild(e),t.children.length?u():o.add("",!0)},o.getData=function(){for(var e=[],n=0;n<t.children.length;n++){var o=t.children[n].innerText.replace("\n",""),r=t.children[n].getAttribute("data-value");r||(r=o),(o||r)&&e.push({text:o,value:r})}return e},o.getValue=function(e){var n=null;if(null!=e)(n=t.children[e].getAttribute("data-value"))||(n=t.children[e].innerText.replace("\n",""));else{for(var r=[],i=0;i<t.children.length;i++)(n=t.children[i].innerText.replace("\n",""))&&r.push(o.getValue(i));n=r.join(",")}return n},o.setValue=function(e){if(e){if(t.value!=e)if(Array.isArray(e))o.add(e);else{var n=(""+e).trim(),r=p(n);t.innerHTML="",o.add(r)}}else o.reset()},o.reset=function(){t.classList.add("jtags-empty"),t.innerHTML="<div></div>",u()},o.isValid=function(){for(var e=0,n=0;n<t.children.length;n++)t.children[n].classList.contains("jtags_error")&&e++;return 0==e},o.selectIndex=function(t,n){var i=e.getNode();i&&(i.innerText=t,n&&i.setAttribute("data-value",n),i.classList.remove("jtags_error"),r()||o.add("",!0))},o.search=function(e){e.innerText},o.destroy=function(){t.removeEventListener("mouseup",m),t.removeEventListener("keydown",h),t.removeEventListener("keyup",b),t.removeEventListener("paste",g),t.removeEventListener("focus",j),t.removeEventListener("blur",v),t.parentNode.removeChild(t)};var l=function(e){if(t.children.length>1){var n=document.createRange(),o=window.getSelection();if(!e)e=t.childNodes[t.childNodes.length-1];n.setStart(e,e.length),n.collapse(!0),o.removeAllRanges(),o.addRange(n),t.scrollLeft=t.scrollWidth}},s=function(e,n,o){var r=document.createElement("div");return r.innerHTML=e||"",n&&r.setAttribute("data-value",n),o&&o.parentNode.classList.contains("jtags")?t.insertBefore(r,o.nextSibling):t.appendChild(r),r},u=function(){var e=o.getValue();e!=o.options.value&&(o.options.value=e,"function"==typeof o.options.onchange&&o.options.onchange(t,o,o.options.value),t.value!=o.options.value&&(t.value=o.options.value,"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value}))),c()},c=function(){for(var e=0;e<t.children.length;e++)o.getValue(e)?(t.children[e].classList.add("jtags_label"),"function"==typeof o.options.validation&&o.getValue(e)?o.options.validation(t.children[e],t.children[e].innerText,t.children[e].getAttribute("data-value"))?t.children[e].classList.remove("jtags_error"):t.children[e].classList.add("jtags_error"):t.children[e].classList.remove("jtags_error")):t.children[e].classList.remove("jtags_label");d()},d=function(){t.innerText.trim()?t.classList.remove("jtags-empty"):(t.innerHTML="<div></div>",t.classList.add("jtags-empty"))},p=function(e){var t=[],n="";if(e=e.trim()){for(var o=0;o<e.length;o++)","==e[o]||";"==e[o]||"\n"==e[o]?n&&(t.push(n.trim()),n=""):n+=e[o];n&&t.push(n)}return t},f=0,h=function(e){if(f=window.getSelection().anchorOffset,d(),"Tab"===e.key||";"===e.key||","===e.key)window.getSelection().anchorOffset>1&&(r()?"function"==typeof o.options.onlimit&&o.options.onlimit(o,o.options.limit):o.add("",!0)),e.preventDefault();else if("Enter"==e.key){if(!i||!i.isOpened())window.getSelection().anchorOffset>1&&(r()||o.add("",!0)),e.preventDefault()}else"Backspace"==e.key&&1==t.children.length&&window.getSelection().anchorOffset<1&&e.preventDefault();i&&i.keydown(e)},b=function(e){if(39==e.which){var t=window.getSelection().anchorOffset;t>1&&t==f&&o.add("",!0)}else 13==e.which||38==e.which||40==e.which?e.preventDefault():i&&i.keyup(e);c()},g=function(e){if(e.clipboardData||e.originalEvent.clipboardData)var n=(e.originalEvent||e).clipboardData.getData("text/plain");else if(window.clipboardData)n=window.clipboardData.getData("Text");var r=p(n);if("function"==typeof o.options.onbeforepaste){var i=o.options.onbeforepaste(t,o,r);if(!1===i)return e.preventDefault(),!1;i&&(r=i)}r.length>1?(o.add(r,!0),e.preventDefault()):r[0]&&(document.execCommand("insertText",!1,r[0]),e.preventDefault())},m=function(e){if(e.target.parentNode&&e.target.parentNode.classList.contains("jtags")&&(e.target.classList.contains("jtags_label")||e.target.classList.contains("jtags_error"))){var n=e.target.getBoundingClientRect();n.width-(e.clientX-n.left)<16&&o.remove(e.target)}e.target==t&&l()},j=function(){t.classList.contains("jtags-focus")||(t.children.length&&!o.getValue(t.children.length-1)||r()||s(""),"function"==typeof o.options.onfocus&&o.options.onfocus(t,o,o.getValue()),t.classList.add("jtags-focus"))},v=function(){if(t.classList.contains("jtags-focus")){i&&i.close();for(var e=0;e<t.children.length-1;e++)o.getValue(e)||t.removeChild(t.children[e]);u(),t.classList.remove("jtags-focus"),"function"==typeof o.options.onblur&&o.options.onblur(t,o,o.getValue())}};return"touchend"in document.documentElement==1?t.addEventListener("touchend",m):t.addEventListener("mouseup",m),t.addEventListener("keydown",h),t.addEventListener("keyup",b),t.addEventListener("paste",g),t.addEventListener("focus",j),t.addEventListener("blur",v),t.setAttribute("contenteditable",!0),t.classList.add("jtags"),o.setOptions(n),"function"==typeof o.options.onload&&o.options.onload(t,o),t.change=o.setValue,t.val=function(e){if(void 0===e)return o.getValue();o.setValue(e)},t.tags=o,o},e.toolbar=function(t,n){var o={type:"toolbar",options:{}},r={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var i in r)n&&n.hasOwnProperty(i)?o.options[i]=n[i]:o.options[i]=r[i];!t&&n.app&&n.app.el&&(t=document.createElement("div"),n.app.el.appendChild(t));var a=document.createElement("div");a.classList.add("jtoolbar-item"),a.classList.add("jtoolbar-arrow");var l=document.createElement("div");l.classList.add("jtoolbar-floating"),a.appendChild(l),o.selectItem=function(e){for(var t=s.children,n=0;n<t.length;n++)e!=t[n]&&t[n].classList.remove("jtoolbar-selected");e.classList.add("jtoolbar-selected")},o.hide=function(){e.animation.slideBottom(t,0,(function(){t.style.display="none"}))},o.show=function(){t.style.display="",e.animation.slideBottom(t,1)},o.get=function(){return t},o.setBadge=function(e,t){s.children[e].children[1].firstChild.innerHTML=t},o.destroy=function(){toolbar.remove(),t.innerHTML=""},o.update=function(e,n){for(var r=0;r<s.children.length;r++){"function"==typeof(i=s.children[r]).updateState&&i.updateState(t,o,i,e,n)}for(r=0;r<l.children.length;r++){var i;"function"==typeof(i=l.children[r]).updateState&&i.updateState(t,o,i,e,n)}},o.create=function(n){s.innerHTML="";for(var r=0;r<n.length;r++){var i=document.createElement("div");if(i.classList.add("jtoolbar-item"),n[r].width&&(i.style.width=parseInt(n[r].width)+"px"),n[r].k&&(i.k=n[r].k),n[r].tooltip&&i.setAttribute("title",n[r].tooltip),n[r].id&&i.setAttribute("id",n[r].id),n[r].updateState&&(i.updateState=n[r].updateState),n[r].active&&i.classList.add("jtoolbar-active"),"select"==n[r].type||"dropdown"==n[r].type)e.picker(i,n[r]);else if("divisor"==n[r].type)i.classList.add("jtoolbar-divisor");else if("label"==n[r].type)i.classList.add("jtoolbar-label"),i.innerHTML=n[r].content;else{var a=document.createElement("i");if(void 0===n[r].class)a.classList.add("material-icons");else for(var l=n[r].class.split(" "),u=0;u<l.length;u++)a.classList.add(l[u]);if(a.innerHTML=n[r].content?n[r].content:"",i.appendChild(a),1==o.options.badge){var c=document.createElement("div");c.classList.add("jbadge");var d=document.createElement("div");d.innerHTML=n[r].badge?n[r].badge:"",c.appendChild(d),i.appendChild(c)}if(n[r].title)if(1==o.options.title){var p=document.createElement("span");p.innerHTML=n[r].title,i.appendChild(p)}else i.setAttribute("title",n[r].title);o.options.app&&n[r].route&&(i.route=n[r].route,i.onclick=function(){o.options.app.pages(this.route)},o.options.app.pages(n[r].route,{toolbarItem:i,closed:!0}))}n[r].onclick&&(i.onclick=n[r].onclick.bind(n[r],t,o,i)),s.appendChild(i)}setTimeout((function(){o.refresh()}),0)},o.open=function(){a.classList.add("jtoolbar-arrow-selected");t.getBoundingClientRect();l.getBoundingClientRect().bottom>window.innerHeight||o.options.bottom?l.style.bottom="0":l.style.removeProperty("bottom"),l.style.right="0",a.children[0].focus(),e.tracking(o,!0)},o.close=function(){a.classList.remove("jtoolbar-arrow-selected"),e.tracking(o,!1)},o.refresh=function(){if(1==o.options.responsive){var e=t.parentNode.getBoundingClientRect();o.options.maxWidth||(o.options.maxWidth=e.width);var n=parseInt(o.options.maxWidth);for(a.parentNode&&a.parentNode.removeChild(a);l.firstChild;)s.appendChild(l.firstChild);if(n<s.offsetWidth)for(n-=50;s.lastChild&&n<s.offsetWidth;)l.insertBefore(s.lastChild,l.firstChild);l.children.length>0&&s.appendChild(a)}},t.onclick=function(t){var n=e.findElement(t.target,"jtoolbar-item");n&&o.selectItem(n),t.target.classList.contains("jtoolbar-arrow")&&o.open()},window.addEventListener("resize",(function(){o.refresh()})),t.classList.add("jtoolbar"),t.innerHTML="",1==o.options.container&&t.classList.add("jtoolbar-container");var s=document.createElement("div");return t.appendChild(s),o.options.app&&t.classList.add("jtoolbar-mobile"),o.create(o.options.items),t.toolbar=o,o},e.validations=function(){var e={between:function(e,t){return e>=t[0]&&e<=t[1]},"not between":function(e,t){return e<t[0]||e>t[1]},"<":function(e,t){return e<t[0]},"<=":function(e,t){return e<=t[0]},">":function(e,t){return e>t[0]},">=":function(e,t){return e>=t[0]},"=":function(e,t){return e==t[0]},"!=":function(e,t){return e!=t[0]}},t={"valid date":function(){return!0},"=":function(e,t){return e===t[0]},"<":function(e,t){return e<t[0]},"<=":function(e,t){return e<=t[0]},">":function(e,t){return e>t[0]},">=":function(e,t){return e>=t[0]},between:function(e,t){return e>=t[0]&&e<=t[1]},"not between":function(e,t){return e<t[0]||e>t[1]}},n={contains:function(e,t){return e.includes(t[0])},"not contains":function(e,t){return!e.includes(t[0])},"begins with":function(e,t){return e.startsWith(t[0])},"ends with":function(e,t){return e.endsWith(t[0])},"=":function(e,t){return e===t[0]},"valid email":function(e){return new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/).test(e)},"valid url":function(e){return new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(e)}},o=function(e,t){return"function"==typeof o[t.type]?!(!t.allowBlank||""!==e)||o[t.type](e,t):null};return o.url=function(){return!!new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(data)},o.email=function(e){var t=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!(!e||!t.test(e))},o.required=function(e){return!!e.trim()},o.exist=function(e,t){return!!e.toString()},o["not exist"]=function(e,t){return!e.toString()},o.number=function(t,n){if(o=t,isNaN(o)||null===o||""===o)return!1;var o;if(!n||!n.criteria)return!0;if(!e[n.criteria])return!1;var r=n.value.map((function(e){return parseFloat(e)}));return e[n.criteria](t,r)},o.login=function(e){var t=new RegExp(/^[a-zA-Z0-9\_\-\.\s+]+$/);return!(!e||!t.test(e))},o.list=function(e,t){var n=typeof e;return("string"===n||"number"===n)&&t.value[0].findIndex((function(t){return t==e}))>-1},o.date=function(e,n){if("Invalid Date"==new Date(e))return!1;if(!n||!n.criteria)return!0;if(!t[n.criteria])return!1;var o=n.value.map((function(e){return new Date(e).getTime()}));return t[n.criteria](new Date(e).getTime(),o)},o.text=function(e,t){return"string"==typeof e&&(!t||!t.criteria||!!n[t.criteria]&&n[t.criteria](e,t.value))},o.textLength=function(e,t){return e=e.toString(),o.number(e.length,t)},o}(),e}))},{}],3:[function(require,module,exports){
/**
 * @license
 * (c) The Spreadsheet Formula Parser
 *
 * Website: https://github.com/jspreadsheet/formula
 * Description: Jspreadsheet formula is a JavaScript software to parse spreadsheet-like formulas.
 *
 * MIT License
 *
 */
/**
 * @license
 * (c) jSuites Javascript Web Components
 *
 * Website: https://jsuites.net
 * Description: Create amazing web based applications.
 *
 * MIT License
 *
 */
/**
 * @license
 * Jspreadsheet v4.11.0
 *
 * Website: https://bossanova.uk/jspreadsheet/
 * and fork junki555: https://github.com/JUNKI555/jspreadsheet_ce
 * Description: Create amazing web based spreadsheets.
 *
 * This software is distribute under MIT License
 */
if(!formula&&"function"==typeof require)var formula=require("@jspreadsheet/formula");if(!jSuites&&"function"==typeof require)var jSuites=require("jsuites");!function(e,t){"object"==typeof exports&&void 0!==module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jspreadsheet=e.jexcel=t()}(this,(function(){"use strict";var Version=(info={title:"Jspreadsheet",version:"4.10.1",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join("\r\n")}},function(){return info}),info,isFormula=function(e){var t=(""+e)[0];return"="==t||"#"==t},getMask=function(e){if(e.format||e.mask||e.locale){var t={};return e.mask?t.mask=e.mask:e.format?t.mask=e.format:(t.locale=e.locale,t.options=e.options),e.decimal&&(t.options||(t.options={}),t.options={decimal:e.decimal}),t}return null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if("TABLE"==el.tagName){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if("text"===property)for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,1==obj.options.lazyLoading&&0==obj.options.tableOverflow&&0==obj.options.fullscreen&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(e){null==e&&(e=!obj.options.fullscreen),obj.options.fullscreen!=e&&(obj.options.fullscreen=e,1==e?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(e){if(!obj.ignoreEvents){if("function"==typeof obj.options.onevent)var t=obj.options.onevent.apply(this,arguments);if("function"==typeof obj.options[e])t=obj.options[e].apply(this,Array.prototype.slice.call(arguments,1))}if("onafterchanges"==e&&obj.options.persistance){var n=1==obj.options.persistance?obj.options.url:obj.options.persistance,o=obj.prepareJson(arguments[2]);obj.save(n,o)}return t},obj.prepareTable=function(){var e=obj.options.columns.length;if(obj.options.data&&void 0!==obj.options.data[0]){var t=Object.keys(obj.options.data[0]);t.length>e&&(e=t.length)}obj.options.minDimensions[0]>e&&(e=obj.options.minDimensions[0]);for(var n=[],o=0;o<e;o++)obj.options.colHeaders[o]||(obj.options.colHeaders[o]=""),obj.options.colWidths[o]||(obj.options.colWidths[o]=obj.options.defaultColWidth),obj.options.colAlignments[o]||(obj.options.colAlignments[o]=obj.options.defaultColAlign),obj.options.columns[o]?obj.options.columns[o].type||(obj.options.columns[o].type="text"):obj.options.columns[o]={type:"text"},obj.options.columns[o].name||(obj.options.columns[o].name=t&&t[o]?t[o]:o),obj.options.columns[o].source||(obj.options.columns[o].source=[]),obj.options.columns[o].options||(obj.options.columns[o].options=[]),obj.options.columns[o].editor||(obj.options.columns[o].editor=null),obj.options.columns[o].allowEmpty||(obj.options.columns[o].allowEmpty=!1),obj.options.columns[o].title||(obj.options.columns[o].title=obj.options.colHeaders[o]?obj.options.colHeaders[o]:""),obj.options.columns[o].width||(obj.options.columns[o].width=obj.options.colWidths[o]?obj.options.colWidths[o]:obj.options.defaultColWidth),obj.options.columns[o].align||(obj.options.columns[o].align=obj.options.colAlignments[o]?obj.options.colAlignments[o]:"center"),"autocomplete"==obj.options.columns[o].type||"dropdown"==obj.options.columns[o].type?obj.options.columns[o].url&&n.push({url:obj.options.columns[o].url,index:o,method:"GET",dataType:"json",success:function(e){for(var t=0;t<e.length;t++)obj.options.columns[this.index].source.push(e[t])}}):"calendar"==obj.options.columns[o].type&&(obj.options.columns[o].options.format||(obj.options.columns[o].options.format="DD/MM/YYYY"));n.length?jSuites.ajax(n,(function(){obj.createTable()})):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(e){obj.scrollControls(e)},obj.content.onwheel=function(e){obj.wheelControls(e)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var e=document.createElement("div"),t=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),e.appendChild(t),e.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var n=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var o=0;o<obj.options.paginationOptions.length;o++){var r=document.createElement("option");r.value=obj.options.paginationOptions[o],r.innerHTML=obj.options.paginationOptions[o],obj.paginationDropdown.appendChild(r)}obj.paginationDropdown.value=obj.options.pagination,n.appendChild(document.createTextNode(obj.options.text.show)),n.appendChild(obj.paginationDropdown),n.appendChild(document.createTextNode(obj.options.text.entries))}var i,a=document.createElement("div");if(a.classList.add("jexcel_filter"),a.appendChild(n),a.appendChild(e),obj.colgroupContainer=document.createElement("colgroup"),(i=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(i),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var l=0;l<obj.options.nestedHeaders.length;l++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[l]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));obj.headerContainer=document.createElement("tr"),(i=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(i);for(o=0;o<obj.options.columns.length;o++)obj.createCellHeader(o),obj.headerContainer.appendChild(obj.headers[o]),obj.colgroupContainer.appendChild(obj.colgroup[o]);if(obj.thead.appendChild(obj.headerContainer),1==obj.options.filters){obj.filter=document.createElement("tr");var s=document.createElement("td");obj.filter.appendChild(s);for(o=0;o<obj.options.columns.length;o++){(s=document.createElement("td")).innerHTML="&nbsp;",s.setAttribute("data-x",o),s.className="jexcel_column_filter","hidden"==obj.options.columns[o].type&&(s.style.display="none"),obj.filter.appendChild(s)}obj.thead.prepend(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),0==obj.options.selectionCopy&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var u=document.createElement("a");u.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";try{if("undefined"!=typeof sessionStorage&&!sessionStorage.getItem("jexcel")){sessionStorage.setItem("jexcel",!0);var c=document.createElement("img");c.src="//bossanova.uk/jspreadsheet/logo.png",u.appendChild(c)}}catch(e){}var d=document.createElement("span");d.innerHTML="Jspreadsheet CE",u.appendChild(d),obj.ads.appendChild(u),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var p=document.createElement("div"),f=document.createElement("div");if(obj.pagination.appendChild(p),obj.pagination.appendChild(f),obj.options.pagination||(obj.pagination.style.display="none"),1==obj.options.search&&el.appendChild(a),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),1==obj.options.fullscreen?el.classList.add("fullscreen"):1==obj.options.tableOverflow&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),1!=obj.options.tableOverflow&&obj.options.toolbar&&el.classList.add("with-toolbar"),1==obj.options.columnDrag&&obj.thead.classList.add("draggable"),1==obj.options.columnResize&&obj.thead.classList.add("resizable"),1==obj.options.rowDrag&&obj.tbody.classList.add("draggable"),1==obj.options.rowResize&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var h=Object.keys(obj.options.classes);for(o=0;o<h.length;o++){var b=jexcel.getIdFromColumnName(h[o],!0);obj.records[b[1]][b[0]].classList.add(obj.options.classes[h[o]])}}},obj.refresh=function(){obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.setData(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(e){if(e&&("string"==typeof e&&(e=JSON.parse(e)),obj.options.data=e),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){e=[];for(var t=0;t<obj.options.data.length;t++){for(var n=[],o=0;o<obj.options.columns.length;o++)n[o]=obj.options.data[t][obj.options.columns[o].name];e.push(n)}obj.options.data=e}t=0,o=0;var r=obj.options.columns.length,i=obj.options.data.length,a=obj.options.minDimensions[0],l=obj.options.minDimensions[1],s=a>r?a:r,u=l>i?l:i;for(t=0;t<u;t++)for(o=0;o<s;o++)null==obj.options.data[t]&&(obj.options.data[t]=[]),null==obj.options.data[t][o]&&(obj.options.data[t][o]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",1==obj.options.lazyLoading){var c=0,d=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else if(obj.options.pagination){obj.pageNumber||(obj.pageNumber=0);obj.options.pagination;c=obj.options.pagination*obj.pageNumber,d=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<d&&(d=obj.options.data.length)}else c=0,d=obj.options.data.length;for(t=0;t<obj.options.data.length;t++){var p=obj.createRow(t,obj.options.data[t]);t>=c&&t<d&&obj.tbody.appendChild(p)}if(1==obj.options.lazyLoading||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var f=Object.keys(obj.options.mergeCells);for(o=0;o<f.length;o++){var h=obj.options.mergeCells[f[o]];obj.setMerge(f[o],h[0],h[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(e,t){for(var n=[],o=0,r=0,i=1==t||0==obj.options.copyCompatibility,a=obj.options.columns.length,l=obj.options.data.length,s=0;s<l;s++){o=0;for(var u=0;u<a;u++)e&&!obj.records[s][u].classList.contains("highlight")||(n[r]||(n[r]=[]),n[r][o]=i?obj.options.data[s][u]:obj.records[s][u].innerHTML,o++);o>0&&r++}return n},obj.getFilteredDataWithHeader=function(e=!1,t=!1,n=!1){var o=!e&&1==obj.options.search&&obj.results,r=1==n||0==obj.options.copyCompatibility,i=obj.options.columns.length,a=o?obj.results.length:obj.options.data.length;if(i<=0)return[];var l=obj.headers.map((e=>e.innerHTML)),s=[],u=0,c=0;s[c]=l,c++;for(var d=0;d<a;d++){u=0;for(var p=0;p<i;p++){var f=o?results[d]:d;s[c]=[],s[c][u]=r?obj.options.data[f][p]:obj.records[f][p].innerHTML,u++}c++}return s},obj.getJsonRow=function(e){for(var t=obj.options.data[e],n=obj.options.columns.length,o={},r=0;r<n;r++)obj.options.columns[r].name||(obj.options.columns[r].name=r),o[obj.options.columns[r].name]=t[r];return o},obj.getJson=function(e){for(var t=[],n=obj.options.columns.length,o=obj.options.data.length,r=0;r<o;r++){for(var i=null,a=0;a<n;a++)e&&!obj.records[r][a].classList.contains("highlight")||(null==i&&(i={}),obj.options.columns[a].name||(obj.options.columns[a].name=a),i[obj.options.columns[a].name]=obj.options.data[r][a]);null!=i&&t.push(i)}return t},obj.prepareJson=function(e){for(var t=[],n=0;n<e.length;n++){var o=e[n].x,r=e[n].y,i=obj.options.columns[o].name?obj.options.columns[o].name:o;t[r]||(t[r]={row:r,data:{}}),t[r].data[i]=e[n].newValue}return t.filter((function(e){return null!=e}))},obj.save=function(e,t){var n=obj.dispatch("onbeforesave",el,obj,t);if(n)t=n;else if(!1===n)return!1;jSuites.ajax({url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(t)},success:function(e){obj.dispatch("onsave",el,obj,t)}})},obj.getRowData=function(e){return obj.options.data[e]},obj.setRowData=function(e,t){for(var n=0;n<obj.headers.length;n++){var o=jexcel.getColumnNameFromId([n,e]);null!=t[n]&&obj.setValue(o,t[n])}},obj.getColumnData=function(e){for(var t=[],n=0;n<obj.options.data.length;n++)t.push(obj.options.data[n][e]);return t},obj.setColumnData=function(e,t){for(var n=0;n<obj.rows.length;n++){var o=jexcel.getColumnNameFromId([e,n]);null!=t[n]&&obj.setValue(o,t[n])}},obj.createRow=function(e,t){if(obj.records[e]||(obj.records[e]=[]),!t)t=obj.options.data[e];obj.rows[e]=document.createElement("tr"),obj.rows[e].setAttribute("data-y",e);var n=null;obj.options.defaultRowHeight&&(obj.rows[e].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[e]&&(obj.options.rows[e].height&&(obj.rows[e].style.height=obj.options.rows[e].height),obj.options.rows[e].title&&(n=obj.options.rows[e].title)),n||(n=parseInt(e+1));var o=document.createElement("td");o.innerHTML=n,o.setAttribute("data-y",e),o.className="jexcel_row",obj.rows[e].appendChild(o);for(var r=0;r<obj.options.columns.length;r++)obj.records[e][r]=obj.createCell(r,e,t[r]),obj.rows[e].appendChild(obj.records[e][r]);return obj.rows[e]},obj.parseValue=function(e,t,n,o){"="==(""+n).substr(0,1)&&1==obj.options.parseFormulas&&(n=obj.executeFormula(n,e,t));var r=obj.options.columns[e];if(r&&!isFormula(n)){var i=null;if(i=getMask(r)){n&&n==Number(n)&&(n=Number(n));var a=jSuites.mask.render(n,i,!0);if(o&&i.mask){var l=i.mask.split(";");if(l[1])l[1].match(new RegExp("\\[Red\\]","gi"))&&(n<0?o.classList.add("red"):o.classList.remove("red")),l[1].match(new RegExp("\\(","gi"))&&n<0&&(a="("+a+")")}a&&(n=a)}}return n};var validDate=function(e){return"-"==(e=""+e).substr(4,1)&&"-"==e.substr(7,1)||4==(e=e.split("-"))[0].length&&e[0]==Number(e[0])&&2==e[1].length&&e[1]==Number(e[1])};obj.createCell=function(e,t,n){var o=document.createElement("td");if(o.setAttribute("data-x",e),o.setAttribute("data-y",t),"="==(""+n).substr(0,1)&&1==obj.options.secureFormulas){var r=secureFormula(n);r!=n&&(n=r)}if(obj.options.columns[e].editor)!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?o.innerHTML=n:o.innerText=n,"function"==typeof obj.options.columns[e].editor.createCell&&(o=obj.options.columns[e].editor.createCell(o));else if("hidden"==obj.options.columns[e].type)o.style.display="none",o.innerText=n;else if("checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type){var i=document.createElement("input");i.type=obj.options.columns[e].type,i.name="c"+e,i.checked=1==n||1==n||"true"==n,i.onclick=function(){obj.setValue(o,this.checked)},1!=obj.options.columns[e].readOnly&&0!=obj.options.editable||i.setAttribute("disabled","disabled"),o.appendChild(i),obj.options.data[t][e]=i.checked}else if("calendar"==obj.options.columns[e].type){var a=null;if(!validDate(n)){var l=jSuites.calendar.extractDateFromString(n,obj.options.columns[e].options.format);l&&(a=l)}o.innerText=jSuites.calendar.getDateString(a||n,obj.options.columns[e].options.format)}else if("dropdown"==obj.options.columns[e].type||"autocomplete"==obj.options.columns[e].type)o.classList.add("jexcel_dropdown"),o.innerText=obj.getDropDownValue(e,n);else if("color"==obj.options.columns[e].type)if("square"==obj.options.columns[e].render){var s=document.createElement("div");s.className="color",s.style.backgroundColor=n,o.appendChild(s)}else o.style.color=n,o.innerText=n;else if("image"==obj.options.columns[e].type){if(n&&"data:image"==n.substr(0,10)){var u=document.createElement("img");u.src=n,o.appendChild(u)}}else"html"==obj.options.columns[e].type||!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?o.innerHTML=stripScript(obj.parseValue(e,t,n,o)):o.innerText=obj.parseValue(e,t,n,o);1==obj.options.columns[e].readOnly&&(o.className="readonly");var c=obj.options.columns[e].align?obj.options.columns[e].align:"center";return o.style.textAlign=c,0!=obj.options.columns[e].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[e].wordWrap||o.innerHTML.length>200)&&(o.style.whiteSpace="pre-wrap"),e>0&&1==this.options.textOverflow&&(n||o.innerHTML?obj.records[t][e-1].style.overflow="hidden":e==obj.options.columns.length-1&&(o.style.overflow="hidden")),o},obj.createCellHeader=function(e){var t=obj.options.columns[e].width?obj.options.columns[e].width:obj.options.defaultColWidth,n=obj.options.columns[e].align?obj.options.columns[e].align:obj.options.defaultColAlign;obj.headers[e]=document.createElement("td"),obj.options.stripHTML?obj.headers[e].innerText=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e):obj.headers[e].innerHTML=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e),obj.headers[e].setAttribute("data-x",e),obj.headers[e].style.textAlign=n,obj.options.columns[e].title&&obj.headers[e].setAttribute("title",obj.options.columns[e].title),obj.options.columns[e].id&&obj.headers[e].setAttribute("id",obj.options.columns[e].id),obj.colgroup[e]=document.createElement("col"),obj.colgroup[e].setAttribute("width",t),"hidden"==obj.options.columns[e].type&&(obj.headers[e].style.display="none",obj.colgroup[e].style.display="none")},obj.updateNestedHeader=function(e,t,n){obj.options.nestedHeaders[t][e].title&&(obj.options.nestedHeaders[t][e].title=n,obj.options.nestedHeaders[t].element.children[e+1].innerText=n)},obj.createNestedHeader=function(e){var t=document.createElement("tr");t.classList.add("jexcel_nested");var n=document.createElement("td");t.appendChild(n),e.element=t;for(var o=0,r=0;r<e.length;r++){e[r].colspan||(e[r].colspan=1),e[r].align||(e[r].align="center"),e[r].title||(e[r].title="");for(var i=e[r].colspan,a=[],l=0;l<i;l++)obj.options.columns[o]&&"hidden"==obj.options.columns[o].type&&i++,a.push(o),o++;(n=document.createElement("td")).setAttribute("data-column",a.join(",")),n.setAttribute("colspan",e[r].colspan),n.setAttribute("align",e[r].align),n.innerText=e[r].title,t.appendChild(n)}return t},obj.createToolbar=function(e){if(e)obj.options.toolbar=e;else e=obj.options.toolbar;for(var t=0;t<e.length;t++){if("i"==e[t].type)(r=document.createElement("i")).classList.add("jexcel_toolbar_item"),r.classList.add("material-icons"),r.setAttribute("data-k",e[t].k),r.setAttribute("data-v",e[t].v),r.setAttribute("id",e[t].id),e[t].tooltip&&r.setAttribute("title",e[t].tooltip),e[t].onclick&&(e[t].onclick,1)?r.onclick=function(t){var n=t;return function(){e[n].onclick(el,obj,this)}}(t):r.onclick=function(){var e=this.getAttribute("data-k"),t=this.getAttribute("data-v");obj.setStyle(obj.highlighted,e,t)},r.innerText=e[t].content,obj.toolbar.appendChild(r);else if("select"==e[t].type){(r=document.createElement("select")).classList.add("jexcel_toolbar_item"),r.setAttribute("data-k",e[t].k),e[t].tooltip&&r.setAttribute("title",e[t].tooltip),e[t].onchange&&(e[t].onchange,1)?r.onchange=e[t].onchange:r.onchange=function(){var e=this.getAttribute("data-k");obj.setStyle(obj.highlighted,e,this.value)};for(var n=0;n<e[t].v.length;n++){var o=document.createElement("option");o.value=e[t].v[n],o.innerText=e[t].v[n],r.appendChild(o)}obj.toolbar.appendChild(r)}else if("color"==e[t].type){var r;(r=document.createElement("i")).classList.add("jexcel_toolbar_item"),r.classList.add("material-icons"),r.setAttribute("data-k",e[t].k),r.setAttribute("data-v",""),e[t].tooltip&&r.setAttribute("title",e[t].tooltip),obj.toolbar.appendChild(r),r.innerText=e[t].content,jSuites.color(r,{onchange:function(e,t){var n=e.getAttribute("data-k");obj.setStyle(obj.highlighted,n,t)}})}}},obj.setMerge=function(e,t,n,o){var r=!1;if(!e){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var i=parseInt(obj.highlighted[0].getAttribute("data-x")),a=parseInt(obj.highlighted[0].getAttribute("data-y")),l=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),s=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));e=jexcel.getColumnNameFromId([i,a]),t=l-i+1,n=s-a+1}var u=jexcel.getIdFromColumnName(e,!0);if(obj.options.mergeCells[e])obj.records[u[1]][u[0]].getAttribute("data-merged")&&(r=obj.options.text.cellAlreadyMerged);else if((!t||t<2)&&(!n||n<2))r=obj.options.text.invalidMergeProperties;else for(var c=u[1];c<u[1]+n;c++)for(var d=u[0];d<u[0]+t;d++){jexcel.getColumnNameFromId([d,c]);obj.records[c][d].getAttribute("data-merged")&&(r=obj.options.text.thereIsAConflictWithAnotherMergedCell)}if(r)alert(r);else{t>1?obj.records[u[1]][u[0]].setAttribute("colspan",t):t=1,n>1?obj.records[u[1]][u[0]].setAttribute("rowspan",n):n=1,obj.options.mergeCells[e]=[t,n,[]],obj.records[u[1]][u[0]].setAttribute("data-merged","true"),obj.records[u[1]][u[0]].style.overflow="hidden";for(var p=[],f=u[1];f<u[1]+n;f++)for(var h=u[0];h<u[0]+t;h++)u[0]==h&&u[1]==f||(p.push(obj.options.data[f][h]),obj.updateCell(h,f,"",!0),obj.options.mergeCells[e][2].push(obj.records[f][h]),obj.records[f][h].style.display="none",obj.records[f][h]=obj.records[u[1]][u[0]]);obj.updateSelection(obj.records[u[1]][u[0]]),o||(obj.setHistory({action:"setMerge",column:e,colspan:t,rowspan:n,data:p}),obj.dispatch("onmerge",el,e,t,n))}},obj.getMerge=function(e){var t={};if(e)t=obj.options.mergeCells[e]?[obj.options.mergeCells[e][0],obj.options.mergeCells[e][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var n=Object.keys(obj.options.mergeCells),o=0;o<n.length;o++)t[n[o]]=[obj.options.mergeCells[n[o]][0],obj.options.mergeCells[n[o]][1]]}return t},obj.removeMerge=function(e,t,n){if(obj.options.mergeCells[e]){var o=jexcel.getIdFromColumnName(e,!0);obj.records[o[1]][o[0]].removeAttribute("colspan"),obj.records[o[1]][o[0]].removeAttribute("rowspan"),obj.records[o[1]][o[0]].removeAttribute("data-merged");for(var r=obj.options.mergeCells[e],i=0,a=0;a<r[1];a++)for(var l=0;l<r[0];l++)(a>0||l>0)&&(obj.records[o[1]+a][o[0]+l]=r[2][i],obj.records[o[1]+a][o[0]+l].style.display="",t&&t[i]&&obj.updateCell(o[0]+l,o[1]+a,t[i]),i++);obj.updateSelection(obj.records[o[1]][o[0]],obj.records[o[1]+a-1][o[0]+l-1]),n||delete obj.options.mergeCells[e]}},obj.destroyMerged=function(e){if(obj.options.mergeCells){obj.options.mergeCells;for(var t=Object.keys(obj.options.mergeCells),n=0;n<t.length;n++)obj.removeMerge(t[n],null,e)}},obj.isColMerged=function(e,t){var n=[];if(obj.options.mergeCells)for(var o=Object.keys(obj.options.mergeCells),r=0;r<o.length;r++){var i=jexcel.getIdFromColumnName(o[r],!0),a=obj.options.mergeCells[o[r]][0],l=i[0],s=i[0]+(a>1?a-1:0);null==t?l<=e&&s>=e&&n.push(o[r]):t?l<e&&s>=e&&n.push(o[r]):l<=e&&s>e&&n.push(o[r])}return n},obj.isRowMerged=function(e,t){var n=[];if(obj.options.mergeCells)for(var o=Object.keys(obj.options.mergeCells),r=0;r<o.length;r++){var i=jexcel.getIdFromColumnName(o[r],!0),a=obj.options.mergeCells[o[r]][1],l=i[1],s=i[1]+(a>1?a-1:0);null==t?l<=e&&s>=e&&n.push(o[r]):t?l<e&&s>=e&&n.push(o[r]):l<=e&&s>e&&n.push(o[r])}return n},obj.openFilter=function(e){if(obj.options.filters){e=parseInt(e),obj.resetSelection();var t=[];if("checkbox"==obj.options.columns[e].type)t.push({id:"true",name:"True"}),t.push({id:"false",name:"False"});else{for(var n=[],o=!1,r=0;r<obj.options.data.length;r++){var i=obj.options.data[r][e],a=obj.records[r][e].innerHTML;if(i&&a)n[i]=a;else o=!0}var l=Object.keys(n);for(t=[],r=0;r<l.length;r++)t.push({id:l[r],name:n[l[r]]});o&&t.push({value:"",id:"",name:"(Blanks)"})}var s=document.createElement("div");obj.filter.children[e+1].innerHTML="",obj.filter.children[e+1].appendChild(s),obj.filter.children[e+1].style.paddingLeft="0px",obj.filter.children[e+1].style.paddingRight="0px",obj.filter.children[e+1].style.overflow="initial";var u={data:t,multiple:!0,autocomplete:!0,opened:!0,value:void 0!==obj.filters[e]?obj.filters[e]:null,width:"100%",position:1==obj.options.tableOverflow||1==obj.options.fullscreen,onclose:function(t){obj.resetFilters(),obj.filters[e]=t.dropdown.getValue(!0),obj.filter.children[e+1].innerHTML=t.dropdown.getText(),obj.filter.children[e+1].style.paddingLeft="",obj.filter.children[e+1].style.paddingRight="",obj.filter.children[e+1].style.overflow="",obj.closeFilter(e),obj.refreshSelection()}};jSuites.dropdown(s,u)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var e=0;e<obj.filter.children.length;e++)obj.filter.children[e].innerHTML="&nbsp;",obj.filters[e]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(e){if(!e)for(var t=0;t<obj.filter.children.length;t++)obj.filters[t]&&(e=t);var n=function(e,t,n){for(var o=0;o<e.length;o++){var r=""+obj.options.data[n][t],i=""+obj.records[n][t].innerHTML;if(e[o]==r||e[o]==i)return!0}return!1},o=obj.filters[e];obj.results=[];for(var r=0;r<obj.options.data.length;r++)n(o,e,r)&&obj.results.push(r);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(e,t,n){var o=e.getAttribute("data-y"),r=e.getAttribute("data-x");obj.dispatch("oneditionstart",el,e,r,o),r>0&&(obj.records[o][r-1].style.overflow="hidden");var i=function(t){var n=e.getBoundingClientRect(),i=document.createElement(t);return i.style.width=n.width+"px",i.style.height=n.height-2+"px",i.style.minHeight=n.height-2+"px",e.classList.add("editor"),e.innerHTML="",e.appendChild(i),obj.dispatch("oncreateeditor",el,e,r,o,i),i};if(1==e.classList.contains("readonly"));else if(obj.edition=[obj.records[o][r],obj.records[o][r].innerHTML,r,o],obj.options.columns[r].editor)obj.options.columns[r].editor.openEditor(e,el,t,n);else if("hidden"==obj.options.columns[r].type);else if("checkbox"==obj.options.columns[r].type||"radio"==obj.options.columns[r].type){var a=!e.children[0].checked;obj.setValue(e,a),obj.edition=null}else if("dropdown"==obj.options.columns[r].type||"autocomplete"==obj.options.columns[r].type){a=obj.options.data[o][r];if(obj.options.columns[r].multiple&&!Array.isArray(a)&&(a=a.split(";")),"function"==typeof obj.options.columns[r].filter)var l=obj.options.columns[r].filter(el,e,r,o,obj.options.columns[r].source);else l=obj.options.columns[r].source;for(var s=[],u=0;u<l.length;u++)s.push(l[u]);var c=i("div"),d={data:s,multiple:!!obj.options.columns[r].multiple,autocomplete:!(!obj.options.columns[r].autocomplete&&"autocomplete"!=obj.options.columns[r].type),opened:!0,value:a,width:"100%",height:c.style.minHeight,position:1==obj.options.tableOverflow||1==obj.options.fullscreen,onclose:function(){obj.closeEditor(e,!0)}};obj.options.columns[r].options&&obj.options.columns[r].options.type&&(d.type=obj.options.columns[r].options.type),jSuites.dropdown(c,d)}else if("calendar"==obj.options.columns[r].type||"color"==obj.options.columns[r].type){a=obj.options.data[o][r];(c=i("input")).value=a,1!=obj.options.tableOverflow&&1!=obj.options.fullscreen||(obj.options.columns[r].options.position=!0),obj.options.columns[r].options.value=obj.options.data[o][r],obj.options.columns[r].options.opened=!0,obj.options.columns[r].options.onclose=function(t,n){obj.closeEditor(e,!0)},"color"==obj.options.columns[r].type?jSuites.color(c,obj.options.columns[r].options):jSuites.calendar(c,obj.options.columns[r].options),c.focus()}else if("html"==obj.options.columns[r].type){a=obj.options.data[o][r];(c=i("div")).style.position="relative",(h=document.createElement("div")).classList.add("jexcel_richtext"),c.appendChild(h),jSuites.editor(h,{focus:!0,value:a});var p=e.getBoundingClientRect(),f=h.getBoundingClientRect();window.innerHeight<p.bottom+f.height?h.style.top=p.top-(f.height+2)+"px":h.style.top=p.top+"px"}else if("image"==obj.options.columns[r].type){var h,b=e.children[0];(c=i("div")).style.position="relative",(h=document.createElement("div")).classList.add("jclose"),b&&b.src&&h.appendChild(b),c.appendChild(h),jSuites.image(h,obj.options.imageOptions);p=e.getBoundingClientRect(),f=h.getBoundingClientRect();window.innerHeight<p.bottom+f.height?h.style.top=p.top-(f.height+2)+"px":h.style.top=p.top+"px"}else{a=1==t?"":obj.options.data[o][r];if(0==obj.options.columns[r].wordWrap||1!=obj.options.wordWrap&&1!=obj.options.columns[r].wordWrap)c=i("input");else var c=i("textarea");c.focus(),c.value=a;d=obj.options.columns[r];var g=null;if(!isFormula(a)&&(g=getMask(d))){if(!d.disabledMaskOnEdition)if(d.mask){var m=d.mask.split(";");c.setAttribute("data-mask",m[0])}else d.locale&&c.setAttribute("data-locale",d.locale);g.input=c,c.mask=g,jSuites.mask.render(a,g,!1)}c.onblur=function(){obj.closeEditor(e,!0)},c.scrollLeft=c.scrollWidth}},obj.closeEditor=function(e,t){var n=parseInt(e.getAttribute("data-x")),o=parseInt(e.getAttribute("data-y"));if(1==t){if(obj.options.columns[n].editor)var r=obj.options.columns[n].editor.closeEditor(e,t);else if("checkbox"==obj.options.columns[n].type||"radio"==obj.options.columns[n].type||"hidden"==obj.options.columns[n].type);else if("dropdown"==obj.options.columns[n].type||"autocomplete"==obj.options.columns[n].type)r=e.children[0].dropdown.close(!0);else if("calendar"==obj.options.columns[n].type)r=e.children[0].calendar.close(!0);else if("color"==obj.options.columns[n].type)r=e.children[0].color.close(!0);else if("html"==obj.options.columns[n].type)r=e.children[0].children[0].editor.getData();else if("image"==obj.options.columns[n].type){var i=e.children[0].children[0].children[0];r=i&&"IMG"==i.tagName?i.src:""}else if("numeric"==obj.options.columns[n].type){"="!=(""+(r=e.children[0].value)).substr(0,1)&&""==r&&(r=obj.options.columns[n].allowEmpty?"":0),e.children[0].onblur=null}else{r=e.children[0].value;e.children[0].onblur=null;var a,l=obj.options.columns[n];if((a=getMask(l))&&""!==r&&!isFormula(r)&&"number"!=typeof r){var s=jSuites.mask.extract(r,a,!0);s&&""!==s.value&&(r=s.value)}}obj.options.data[o][n]==r?e.innerHTML=obj.edition[1]:obj.setValue(e,r)}else obj.options.columns[n].editor?obj.options.columns[n].editor.closeEditor(e,t):"dropdown"==obj.options.columns[n].type||"autocomplete"==obj.options.columns[n].type?e.children[0].dropdown.close(!0):"calendar"==obj.options.columns[n].type?e.children[0].calendar.close(!0):"color"==obj.options.columns[n].type?e.children[0].color.close(!0):e.children[0].onblur=null,e.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,e,n,o,r,t),e.classList.remove("editor"),obj.edition=null},obj.getCell=function(e){var t=(e=jexcel.getIdFromColumnName(e,!0))[0],n=e[1];return obj.records[n][t]},obj.getColumnOptions=function(e,t){var n=obj.options.columns[e];return n||(n={type:"text"}),n},obj.getCellFromCoords=function(e,t){return obj.records[t][e]},obj.getLabel=function(e){var t=(e=jexcel.getIdFromColumnName(e,!0))[0],n=e[1];return obj.records[n][t].innerHTML},obj.getLabelFromCoords=function(e,t){return obj.records[t][e].innerHTML},obj.getValue=function(e,t){if("object"==typeof e)var n=e.getAttribute("data-x"),o=e.getAttribute("data-y");else n=(e=jexcel.getIdFromColumnName(e,!0))[0],o=e[1];var r=null;return null!=n&&null!=o&&(obj.records[o]&&obj.records[o][n]&&(t||1==obj.options.copyCompatibility)?r=obj.records[o][n].innerHTML:obj.options.data[o]&&"undefined"!=obj.options.data[o][n]&&(r=obj.options.data[o][n])),r},obj.getValueFromCoords=function(e,t,n){var o=null;return null!=e&&null!=t&&(obj.records[t]&&obj.records[t][e]&&n||1==obj.options.copyCompatibility?o=obj.records[t][e].innerHTML:obj.options.data[t]&&"undefined"!=obj.options.data[t][e]&&(o=obj.options.data[t][e])),o},obj.setValue=function(e,t,n){var o=[];if("string"==typeof e){var r=(s=jexcel.getIdFromColumnName(e,!0))[0],i=s[1];o.push(obj.updateCell(r,i,t,n)),obj.updateFormulaChain(r,i,o)}else{r=null,i=null;if(e&&e.getAttribute)r=e.getAttribute("data-x"),i=e.getAttribute("data-y");if(null!=r&&null!=i)o.push(obj.updateCell(r,i,t,n)),obj.updateFormulaChain(r,i,o);else{var a=Object.keys(e);if(a.length>0)for(var l=0;l<a.length;l++){if("string"==typeof e[l]){var s;r=(s=jexcel.getIdFromColumnName(e[l],!0))[0],i=s[1]}else if(null!=e[l].x&&null!=e[l].y){r=e[l].x,i=e[l].y;null!=e[l].newValue?t=e[l].newValue:null!=e[l].value&&(t=e[l].value)}else r=e[l].getAttribute("data-x"),i=e[l].getAttribute("data-y");null!=r&&null!=i&&(o.push(obj.updateCell(r,i,t,n)),obj.updateFormulaChain(r,i,o))}}}obj.setHistory({action:"setValue",records:o,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,o)},obj.setValueFromCoords=function(e,t,n,o){var r=[];r.push(obj.updateCell(e,t,n,o)),obj.updateFormulaChain(e,t,r),obj.setHistory({action:"setValue",records:r,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,r)},obj.setCheckRadioValue=function(){for(var e=[],t=Object.keys(obj.highlighted),n=0;n<t.length;n++){var o=obj.highlighted[n].getAttribute("data-x"),r=obj.highlighted[n].getAttribute("data-y");"checkbox"!=obj.options.columns[o].type&&"radio"!=obj.options.columns[o].type||e.push(obj.updateCell(o,r,!obj.options.data[r][o]))}e.length&&(obj.setHistory({action:"setValue",records:e,selection:obj.selectedCell}),obj.onafterchanges(el,e))};var stripScript=function(e){var t=new Option;t.innerHTML=e;var n=null;for(e=t.getElementsByTagName("script");n=e[0];)n.parentNode.removeChild(n);return t.innerHTML};obj.updateCell=function(e,t,n,o){if(1!=obj.records[t][e].classList.contains("readonly")||o){var r;if("="==(""+n).substr(0,1)&&1==obj.options.secureFormulas)(r=secureFormula(n))!=n&&(n=r);null!=(r=obj.dispatch("onbeforechange",el,obj.records[t][e],e,t,n))&&(n=r),obj.options.columns[e].editor&&"function"==typeof obj.options.columns[e].editor.updateCell&&(n=obj.options.columns[e].editor.updateCell(obj.records[t][e],n,o));c={x:e,y:t,col:e,row:t,newValue:n,oldValue:obj.options.data[t][e]};if(obj.options.columns[e].editor)obj.options.data[t][e]=n;else if("checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type){if("radio"==obj.options.columns[e].type)for(var i=0;i<obj.options.data.length;i++)obj.options.data[i][e]=!1;obj.records[t][e].children[0].checked=1==n||1==n||"true"==n||"TRUE"==n,obj.options.data[t][e]=obj.records[t][e].children[0].checked}else if("dropdown"==obj.options.columns[e].type||"autocomplete"==obj.options.columns[e].type)obj.options.data[t][e]=n,obj.records[t][e].innerText=obj.getDropDownValue(e,n);else if("calendar"==obj.options.columns[e].type){var a=null;if(!validDate(n)){var l=jSuites.calendar.extractDateFromString(n,obj.options.columns[e].options.format);l&&(a=l)}obj.options.data[t][e]=n,obj.records[t][e].innerText=jSuites.calendar.getDateString(a||n,obj.options.columns[e].options.format)}else if("color"==obj.options.columns[e].type)if(obj.options.data[t][e]=n,"square"==obj.options.columns[e].render){var s=document.createElement("div");s.className="color",s.style.backgroundColor=n,obj.records[t][e].innerText="",obj.records[t][e].appendChild(s)}else obj.records[t][e].style.color=n,obj.records[t][e].innerText=n;else if("image"==obj.options.columns[e].type){if(n=""+n,obj.options.data[t][e]=n,obj.records[t][e].innerHTML="",n&&"data:image"==n.substr(0,10)){var u=document.createElement("img");u.src=n,obj.records[t][e].appendChild(u)}}else obj.options.data[t][e]=n,"html"==obj.options.columns[e].type?obj.records[t][e].innerHTML=stripScript(obj.parseValue(e,t,n)):!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?obj.records[t][e].innerHTML=stripScript(obj.parseValue(e,t,n,obj.records[t][e])):obj.records[t][e].innerText=obj.parseValue(e,t,n,obj.records[t][e]),0!=obj.options.columns[e].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[e].wordWrap||obj.records[t][e].innerHTML.length>200)?obj.records[t][e].style.whiteSpace="pre-wrap":obj.records[t][e].style.whiteSpace="";e>0&&(obj.records[t][e-1].style.overflow=n?"hidden":""),obj.dispatch("onchange",el,obj.records[t]&&obj.records[t][e]?obj.records[t][e]:null,e,t,n,c.oldValue)}else var c={x:e,y:t,col:e,row:t};return c},obj.copyData=function(e,t){var n=obj.getData(!0,!0),o=obj.selectedContainer,r=parseInt(e.getAttribute("data-x")),i=parseInt(e.getAttribute("data-y")),a=parseInt(t.getAttribute("data-x")),l=parseInt(t.getAttribute("data-y")),s=[],u=!1;if(o[0]==r){if(i<o[1])var c=i-o[1];else c=1;var d=0}else{if(r<o[0])d=r-o[0];else d=1;c=0}for(var p=0,f=0,h=i;h<=l;h++)if(!obj.rows[h]||"none"!=obj.rows[h].style.display){if(null==n[f]&&(f=0),p=0,o[0]!=r)if(r<o[0])d=r-o[0];else d=1;for(var b=r;b<=a;b++){if(obj.records[h][b]&&!obj.records[h][b].classList.contains("readonly")&&"none"!=obj.records[h][b].style.display&&0==u){if(!obj.selection.length&&""!=obj.options.data[h][b]){u=!0;continue}(null==n[f]||null==n[f][p])&&(p=0);var g=n[f][p];if(g&&!n[1]&&1==obj.options.autoIncrement)if("text"==obj.options.columns[b].type||"number"==obj.options.columns[b].type)if("="==(""+g).substr(0,1)){var m=g.match(/([A-Z]+[0-9]+)/g);if(m){for(var j=[],v=0;v<m.length;v++){var y=jexcel.getIdFromColumnName(m[v],1);y[0]+=d,y[1]+=c,y[1]<0&&(y[1]=0);var x=jexcel.getColumnNameFromId([y[0],y[1]]);x!=m[v]&&(j[m[v]]=x)}j&&(g=obj.updateFormula(g,j))}}else g==Number(g)&&(g=Number(g)+c);else if("calendar"==obj.options.columns[b].type){var C=new Date(g);C.setDate(C.getDate()+c),g=C.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(C.getMonth()+1))+"-"+jexcel.doubleDigitFormat(C.getDate())+" 00:00:00"}s.push(obj.updateCell(b,h,g)),obj.updateFormulaChain(b,h,s)}p++,o[0]!=r&&d++}f++,c++}obj.setHistory({action:"setValue",records:s,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,s)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(e,t,n){if(1==e){if(obj.selectedCell&&(t>=obj.selectedCell[1]&&t<=obj.selectedCell[3]||n>=obj.selectedCell[1]&&n<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(t>=obj.selectedCell[0]&&t<=obj.selectedCell[2]||n>=obj.selectedCell[0]&&n<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(e){if(obj.highlighted.length){u=1;for(var t=0;t<obj.highlighted.length;t++){obj.highlighted[t].classList.remove("highlight"),obj.highlighted[t].classList.remove("highlight-left"),obj.highlighted[t].classList.remove("highlight-right"),obj.highlighted[t].classList.remove("highlight-top"),obj.highlighted[t].classList.remove("highlight-bottom"),obj.highlighted[t].classList.remove("highlight-selected");var n=parseInt(obj.highlighted[t].getAttribute("data-x")),o=parseInt(obj.highlighted[t].getAttribute("data-y"));if(obj.highlighted[t].getAttribute("data-merged"))var r=parseInt(obj.highlighted[t].getAttribute("colspan")),i=parseInt(obj.highlighted[t].getAttribute("rowspan")),a=r>0?n+(r-1):n,l=i>0?o+(i-1):o;else a=n,l=o;for(var s=n;s<=a;s++)obj.headers[s]&&obj.headers[s].classList.remove("selected");for(s=o;s<=l;s++)obj.rows[s]&&obj.rows[s].classList.remove("selected")}}else var u=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",1==e&&1==u&&obj.dispatch("onblur",el),u},obj.updateSelection=function(e,t,n){var o=e.getAttribute("data-x"),r=e.getAttribute("data-y");if(t)var i=t.getAttribute("data-x"),a=t.getAttribute("data-y");else i=o,a=r;obj.updateSelectionFromCoords(o,r,i,a,n)},obj.updateSelectionFromCoords=function(e,t,n,o,r){var i=obj.resetSelection();if(null==t&&(t=0,o=obj.rows.length-1),null==n&&(n=e),null==o&&(o=t),e>=obj.headers.length&&(e=obj.headers.length-1),t>=obj.rows.length&&(t=obj.rows.length-1),n>=obj.headers.length&&(n=obj.headers.length-1),o>=obj.rows.length&&(o=obj.rows.length-1),obj.selectedCell=[e,t,n,o],null!=e){if(obj.records[t][e]&&obj.records[t][e].classList.add("highlight-selected"),parseInt(e)<parseInt(n))var a=parseInt(e),l=parseInt(n);else a=parseInt(n),l=parseInt(e);if(parseInt(t)<parseInt(o))var s=parseInt(t),u=parseInt(o);else s=parseInt(o),u=parseInt(t);for(var c=a;c<=l;c++)for(var d=s;d<=u;d++)if(obj.records[d][c]&&obj.records[d][c].getAttribute("data-merged")){var p=parseInt(obj.records[d][c].getAttribute("data-x")),f=parseInt(obj.records[d][c].getAttribute("data-y")),h=parseInt(obj.records[d][c].getAttribute("colspan")),b=parseInt(obj.records[d][c].getAttribute("rowspan"));h>1&&(p<a&&(a=p),p+h>l&&(l=p+h-1)),b&&(f<s&&(s=f),f+b>u&&(u=f+b-1))}var g=null,m=null,j=null,v=null;for(d=s;d<=u;d++)"none"!=obj.rows[d].style.display&&(null==j&&(j=d),v=d);for(c=a;c<=l;c++){for(d=s;d<=u;d++)"none"!=obj.rows[d].style.display&&"none"!=obj.records[d][c].style.display&&(obj.records[d][c].classList.add("highlight"),obj.highlighted.push(obj.records[d][c]));"hidden"!=obj.options.columns[c].type&&(null==g&&(g=c),m=c)}g||(g=0),m||(m=0);for(c=g;c<=m;c++)"hidden"!=obj.options.columns[c].type&&(obj.records[j]&&obj.records[j][c]&&obj.records[j][c].classList.add("highlight-top"),obj.records[v]&&obj.records[v][c]&&obj.records[v][c].classList.add("highlight-bottom"),obj.headers[c].classList.add("selected"));for(d=j;d<=v;d++)obj.rows[d]&&"none"!=obj.rows[d].style.display&&(obj.records[d][g].classList.add("highlight-left"),obj.records[d][m].classList.add("highlight-right"),obj.rows[d].classList.add("selected"));obj.selectedContainer=[g,j,m,v]}0==i&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,g,j,m,v,r),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var e=0;e<obj.selection.length;e++)obj.selection[e].classList.remove("selection"),obj.selection[e].classList.remove("selection-left"),obj.selection[e].classList.remove("selection-right"),obj.selection[e].classList.remove("selection-top"),obj.selection[e].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(e,t){obj.removeCopySelection();var n=obj.selectedContainer[0],o=obj.selectedContainer[1],r=obj.selectedContainer[2],i=obj.selectedContainer[3];if(null!=e&&null!=t){if(e-r>0)var a=parseInt(r)+1,l=parseInt(e);else a=parseInt(e),l=parseInt(n)-1;if(t-i>0)var s=parseInt(i)+1,u=parseInt(t);else s=parseInt(t),u=parseInt(o)-1;if(l-a<=u-s)a=parseInt(n),l=parseInt(r);else s=parseInt(o),u=parseInt(i);for(var c=s;c<=u;c++)for(var d=a;d<=l;d++)obj.records[c][d]&&"none"!=obj.rows[c].style.display&&"none"!=obj.records[c][d].style.display&&(obj.records[c][d].classList.add("selection"),obj.records[s][d].classList.add("selection-top"),obj.records[u][d].classList.add("selection-bottom"),obj.records[c][a].classList.add("selection-left"),obj.records[c][l].classList.add("selection-right"),obj.selection.push(obj.records[c][d]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var e=obj.highlighted[obj.highlighted.length-1],t=e.getAttribute("data-x"),n=obj.content.getBoundingClientRect(),o=n.left,r=n.top,i=e.getBoundingClientRect(),a=i.left,l=i.top,s=i.width,u=i.height,c=a-o+obj.content.scrollLeft+s-4,d=l-r+obj.content.scrollTop+u-4;if(obj.corner.style.top=d+"px",obj.corner.style.left=c+"px",obj.options.freezeColumns){var p=obj.getFreezeWidth();t>obj.options.freezeColumns-1&&a-o+s<p?obj.corner.style.display="none":1==obj.options.selectionCopy&&(obj.corner.style.display="")}else 1==obj.options.selectionCopy&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(e){var t=obj.content.getBoundingClientRect(),n=t.left,o=t.top,r=t.width,i=t.height,a=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),l=a.left,s=a.top,u=a.width,c=a.height;if(0==e||1==e)var d=l-n+obj.content.scrollLeft,p=s-o+obj.content.scrollTop-2;else d=l-n+obj.content.scrollLeft+u,p=s-o+obj.content.scrollTop+c;p>obj.content.scrollTop+30&&p<obj.content.scrollTop+i||(p<obj.content.scrollTop+30?obj.content.scrollTop=p-c:obj.content.scrollTop=p-(i-2));var f=obj.getFreezeWidth();d>obj.content.scrollLeft+f&&d<obj.content.scrollLeft+r||(d<obj.content.scrollLeft+30?(obj.content.scrollLeft=d,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):d<obj.content.scrollLeft+f?obj.content.scrollLeft=d-f-1:obj.content.scrollLeft=d-(r-20))},obj.getWidth=function(e){if(e)"object"==typeof e&&(e=$(e).getAttribute("data-x")),t=obj.colgroup[e].getAttribute("width");else for(var t=[],n=0;n<obj.headers.length;n++)t.push(obj.options.columns[n].width);return t},obj.setWidth=function(e,t,n){if(t){if(Array.isArray(e)){if(!n)n=[];for(var o=0;o<e.length;o++){n[o]||(n[o]=obj.colgroup[e[o]].getAttribute("width"));var r=Array.isArray(t)&&t[o]?t[o]:t;obj.colgroup[e[o]].setAttribute("width",r),obj.options.columns[e[o]].width=r}}else n||(n=obj.colgroup[e].getAttribute("width")),obj.colgroup[e].setAttribute("width",t),obj.options.columns[e].width=t;obj.setHistory({action:"setWidth",column:e,oldValue:n,newValue:t}),obj.dispatch("onresizecolumn",el,e,t,n),obj.updateCornerPosition()}},obj.setHeight=function(e,t,n){if(t>0){if("object"==typeof e&&(e=e.getAttribute("data-y")),!n)if(!(n=obj.rows[e].getAttribute("height")))n=obj.rows[e].getBoundingClientRect().height;t=parseInt(t),obj.rows[e].style.height=t+"px",obj.options.rows[e]||(obj.options.rows[e]={}),obj.options.rows[e].height=t,obj.setHistory({action:"setHeight",row:e,oldValue:n,newValue:t}),obj.dispatch("onresizerow",el,e,t,n),obj.updateCornerPosition()}},obj.getHeight=function(e){if(e){"object"==typeof e&&(e=$(e).getAttribute("data-y"));t=obj.rows[e].style.height}else for(var t=[],n=0;n<obj.rows.length;n++){var o=obj.rows[n].style.height;o&&(t[n]=o)}return t},obj.setFooter=function(e){if(e&&(obj.options.footers=e),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var t=0;t<obj.options.footers.length;t++){if(obj.tfoot.children[t])var n=obj.tfoot.children[t];else{n=document.createElement("tr");var o=document.createElement("td");n.appendChild(o),obj.tfoot.appendChild(n)}for(var r=0;r<obj.headers.length;r++){if(obj.options.footers[t][r]||(obj.options.footers[t][r]=""),obj.tfoot.children[t].children[r+1])o=obj.tfoot.children[t].children[r+1];else{o=document.createElement("td");n.appendChild(o);var i=obj.options.columns[r].align?obj.options.columns[r].align:"center";o.style.textAlign=i}o.innerText=obj.parseValue(+obj.records.length+r,t,obj.options.footers[t][r])}}}},obj.getHeader=function(e){return obj.headers[e].innerText},obj.setHeader=function(e,t){if(obj.headers[e]){var n=obj.headers[e].innerText;t||(t=prompt(obj.options.text.columnName,n)),t&&(obj.headers[e].innerText=t,obj.headers[e].setAttribute("title",t),obj.options.columns[e].title=t),obj.setHistory({action:"setHeader",column:e,oldValue:n,newValue:t}),obj.dispatch("onchangeheader",el,e,n,t)}},obj.getHeaders=function(e){for(var t=[],n=0;n<obj.headers.length;n++)t.push(obj.getHeader(n));return e?t:t.join(obj.options.csvDelimiter)},obj.getMeta=function(e,t){return e?t?obj.options.meta[e]&&obj.options.meta[e][t]?obj.options.meta[e][t]:null:obj.options.meta[e]?obj.options.meta[e]:null:obj.options.meta},obj.setMeta=function(e,t,n){if(obj.options.meta||(obj.options.meta={}),t&&n)obj.options.meta[e]||(obj.options.meta[e]={}),obj.options.meta[e][t]=n;else for(var o=Object.keys(e),r=0;r<o.length;r++){obj.options.meta[o[r]]||(obj.options.meta[o[r]]={});for(var i=Object.keys(e[o[r]]),a=0;a<i.length;a++)obj.options.meta[o[r]][i[a]]=e[o[r]][i[a]]}obj.dispatch("onchangemeta",el,e,t,n)},obj.updateMeta=function(e){if(obj.options.meta){for(var t={},n=Object.keys(obj.options.meta),o=0;o<n.length;o++)e[n[o]]?t[e[n[o]]]=obj.options.meta[n[o]]:t[n[o]]=obj.options.meta[n[o]];obj.options.meta=t}},obj.getStyle=function(e,t){if(e)return e=jexcel.getIdFromColumnName(e,!0),t?obj.records[e[1]][e[0]].style[t]:obj.records[e[1]][e[0]].getAttribute("style");for(var n={},o=obj.options.data[0].length,r=obj.options.data.length,i=0;i<r;i++)for(var a=0;a<o;a++){var l=t?obj.records[i][a].style[t]:obj.records[i][a].getAttribute("style");if(l)n[jexcel.getColumnNameFromId([a,i])]=l}return n},obj.resetStyle=function(e,t){for(var n=Object.keys(e),o=0;o<n.length;o++){var r=jexcel.getIdFromColumnName(n[o],!0);obj.records[r[1]]&&obj.records[r[1]][r[0]]&&obj.records[r[1]][r[0]].setAttribute("style","")}obj.setStyle(e,null,null,null,t)},obj.setStyle=function(e,t,n,o,r){var i={},a={},l=function(e,t,n){var r=jexcel.getIdFromColumnName(e,!0);if(obj.records[r[1]]&&obj.records[r[1]][r[0]]&&(0==obj.records[r[1]][r[0]].classList.contains("readonly")||o)){var l=obj.records[r[1]][r[0]].style[t];l!=n||o?obj.records[r[1]][r[0]].style[t]=n:(n="",obj.records[r[1]][r[0]].style[t]=""),a[e]||(a[e]=[]),i[e]||(i[e]=[]),a[e].push([t+":"+l]),i[e].push([t+":"+n])}};if(t&&n)if("string"==typeof e)l(e,t,n);else for(var s=[],u=0;u<e.length;u++){var c=e[u].getAttribute("data-x"),d=e[u].getAttribute("data-y"),p=jexcel.getColumnNameFromId([c,d]);s[p]||(l(p,t,n),s[p]=!0)}else{var f=Object.keys(e);for(u=0;u<f.length;u++){var h=e[f[u]];"string"==typeof h&&(h=h.split(";"));for(var b=0;b<h.length;b++)"string"==typeof h[b]&&(h[b]=h[b].split(":")),h[b][0].trim()&&l(f[u],h[b][0].trim(),h[b][1])}}for(f=Object.keys(a),u=0;u<f.length;u++)a[f[u]]=a[f[u]].join(";");for(f=Object.keys(i),u=0;u<f.length;u++)i[f[u]]=i[f[u]].join(";");r||obj.setHistory({action:"setStyle",oldValue:a,newValue:i}),obj.dispatch("onchangestyle",el,e,t,n)},obj.getComments=function(e,t){if(e){if("string"==typeof e)e=jexcel.getIdFromColumnName(e,!0);return t?[obj.records[e[1]][e[0]].getAttribute("title"),obj.records[e[1]][e[0]].getAttribute("author")]:obj.records[e[1]][e[0]].getAttribute("title")||""}for(var n={},o=0;o<obj.options.data.length;o++)for(var r=0;r<obj.options.columns.length;r++){var i=obj.records[o][r].getAttribute("title");if(i)n[e=jexcel.getColumnNameFromId([r,o])]=i}return n},obj.setComments=function(e,t,n){if("string"==typeof e)var o=jexcel.getIdFromColumnName(e,!0);else o=e;var r=obj.records[o[1]][o[0]].getAttribute("title"),i=[r,n=obj.records[o[1]][o[0]].getAttribute("data-author")];obj.records[o[1]][o[0]].setAttribute("title",t||""),obj.records[o[1]][o[0]].setAttribute("data-author",n||""),t?obj.records[o[1]][o[0]].classList.add("jexcel_comments"):obj.records[o[1]][o[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:e,newValue:[t,n],oldValue:i}),obj.dispatch("oncomments",el,t,r,o,o[0],o[1])},obj.getConfig=function(){var e=obj.options;return e.style=obj.getStyle(),e.mergeCells=obj.getMerge(),e.comments=obj.getComments(),e},obj.orderBy=function(e,t){if(e>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}t=null==t?obj.headers[e].classList.contains("arrow-down")?1:0:t?1:0;var n=[];if("number"==obj.options.columns[e].type||"percentage"==obj.options.columns[e].type||"autonumber"==obj.options.columns[e].type||"color"==obj.options.columns[e].type)for(var o=0;o<obj.options.data.length;o++)n[o]=[o,Number(obj.options.data[o][e])];else if("calendar"==obj.options.columns[e].type||"checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type)for(o=0;o<obj.options.data.length;o++)n[o]=[o,obj.options.data[o][e]];else for(o=0;o<obj.options.data.length;o++)n[o]=[o,obj.records[o][e].innerText.toLowerCase()];"function"!=typeof obj.options.sorting&&(obj.options.sorting=function(e){return function(t,n){var o=t[1],r=n[1];return e?""===o&&""!==r?1:""!==o&&""===r||o>r?-1:o<r?1:0:""===o&&""!==r?1:""!==o&&""===r?-1:o>r?1:o<r?-1:0}}),n=n.sort(obj.options.sorting(t));var r=[];for(o=0;o<n.length;o++)r[o]=n[o][0];return obj.setHistory({action:"orderBy",rows:r,column:e,order:t}),obj.updateOrderArrow(e,t),obj.updateOrder(r),obj.dispatch("onsort",el,e,t),!0}},obj.updateOrderArrow=function(e,t){for(var n=0;n<obj.headers.length;n++)obj.headers[n].classList.remove("arrow-up"),obj.headers[n].classList.remove("arrow-down");t?obj.headers[e].classList.add("arrow-up"):obj.headers[e].classList.add("arrow-down")},obj.updateOrder=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=obj.options.data[e[n]];obj.options.data=t;for(t=[],n=0;n<e.length;n++)t[n]=obj.records[e[n]];obj.records=t;for(t=[],n=0;n<e.length;n++)t[n]=obj.rows[e[n]];if(obj.rows=t,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(1==obj.options.lazyLoading)obj.loadPage(0);else for(n=0;n<obj.rows.length;n++)obj.tbody.appendChild(obj.rows[n])},obj.moveRow=function(e,t,n){if(Object.keys(obj.options.mergeCells).length>0){if(e>t)var o=1;else o=0;if(obj.isRowMerged(e).length||obj.isRowMerged(t,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}n||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])>=0?e>t?obj.tbody.insertBefore(obj.rows[e],obj.rows[t]):obj.tbody.insertBefore(obj.rows[e],obj.rows[t].nextSibling):obj.tbody.removeChild(obj.rows[e])),obj.rows.splice(t,0,obj.rows.splice(e,1)[0]),obj.records.splice(t,0,obj.records.splice(e,1)[0]),obj.options.data.splice(t,0,obj.options.data.splice(e,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,e,t)},obj.insertRow=function(e,t,n){if(1==obj.options.allowInsertRow){var o=[];if(e>0)var r=e;else{r=1;e&&(o=e)}n=!!n;var i=obj.options.data.length-1;if((null==t||t>=parseInt(i)||t<0)&&(t=i),!1===obj.dispatch("onbeforeinsertrow",el,t,r,n))return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(t,n).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var a=n?t:t+1,l=obj.records.splice(a),s=obj.options.data.splice(a),u=obj.rows.splice(a),c=[],d=[],p=[],f=a;f<r+a;f++){obj.options.data[f]=[];for(var h=0;h<obj.options.columns.length;h++)obj.options.data[f][h]=o[h]?o[h]:"";var b=obj.createRow(f,obj.options.data[f]);u[0]?Array.prototype.indexOf.call(obj.tbody.children,u[0])>=0&&obj.tbody.insertBefore(b,u[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])>=0&&obj.tbody.appendChild(b),c.push(obj.records[f]),d.push(obj.options.data[f]),p.push(b)}Array.prototype.push.apply(obj.records,l),Array.prototype.push.apply(obj.options.data,s),Array.prototype.push.apply(obj.rows,u),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:t,numOfRows:r,insertBefore:n,rowRecords:c,rowData:d,rowNode:p}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,t,r,c,n)}},obj.deleteRow=function(e,t){if(1==obj.options.allowDeleteRow)if(1==obj.options.allowDeletingAllRows||obj.options.data.length>1){if(null==e){var n=obj.getSelectedRows();n[0]?(e=parseInt(n[0].getAttribute("data-y")),t=n.length):(e=obj.options.data.length-1,t=1)}var o=obj.options.data.length-1;if((null==e||e>o||e<0)&&(e=o),t||(t=1),e+t>=obj.options.data.length&&(t=obj.options.data.length-e),!1===obj.dispatch("onbeforedeleterow",el,e,t))return!1;if(parseInt(e)>-1){var r=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var i=e;i<e+t;i++)obj.isRowMerged(i,!1).length&&(r=!0);if(r){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}0==obj.options.allowDeletingAllRows&&o+1===t&&(t--,console.error("Jspreadsheet: It is not possible to delete the last row"));for(i=e;i<e+t;i++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[i])>=0&&(obj.rows[i].className="",obj.rows[i].parentNode.removeChild(obj.rows[i]));var a=obj.records.splice(e,t),l=obj.options.data.splice(e,t),s=obj.rows.splice(e,t);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,e,e+t-1),obj.setHistory({action:"deleteRow",rowNumber:e,numOfRows:t,insertBefore:1,rowRecords:a,rowData:l,rowNode:s}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,e,t,a)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(e,t){if(Object.keys(obj.options.mergeCells).length>0){if(e>t)var n=1;else n=0;if(obj.isColMerged(e).length||obj.isColMerged(t,n).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((e=parseInt(e))>(t=parseInt(t))){obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t]),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t]);for(var o=0;o<obj.rows.length;o++)obj.rows[o].insertBefore(obj.records[o][e],obj.records[o][t])}else{obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t].nextSibling);for(o=0;o<obj.rows.length;o++)obj.rows[o].insertBefore(obj.records[o][e],obj.records[o][t].nextSibling)}obj.options.columns.splice(t,0,obj.options.columns.splice(e,1)[0]),obj.headers.splice(t,0,obj.headers.splice(e,1)[0]),obj.colgroup.splice(t,0,obj.colgroup.splice(e,1)[0]);for(o=0;o<obj.rows.length;o++)obj.options.data[o].splice(t,0,obj.options.data[o].splice(e,1)[0]),obj.records[o].splice(t,0,obj.records[o].splice(e,1)[0]);if(obj.options.footers)for(o=0;o<obj.options.footers.length;o++)obj.options.footers[o].splice(t,0,obj.options.footers[o].splice(e,1)[0]);obj.setHistory({action:"moveColumn",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,e,t)},obj.insertColumn=function(e,t,n,o){if(1==obj.options.allowInsertColumn){var r=[];if(e>0)var i=e;else{i=1;e&&(r=e)}n=!!n;var a=obj.options.columns.length-1;if((null==t||t>=parseInt(a)||t<0)&&(t=a),!1===obj.dispatch("onbeforeinsertcolumn",el,t,i,n))return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(t,n).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}o||(o=[]);for(var l=0;l<i;l++)o[l]||(o[l]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var s=n?t:t+1;obj.options.columns=jexcel.injectArray(obj.options.columns,s,o);for(var u=obj.headers.splice(s),c=obj.colgroup.splice(s),d=[],p=[],f=[],h=[],b=[],g=s;g<i+s;g++)obj.createCellHeader(g),obj.headerContainer.insertBefore(obj.headers[g],obj.headerContainer.children[g+1]),obj.colgroupContainer.insertBefore(obj.colgroup[g],obj.colgroupContainer.children[g+1]),d.push(obj.headers[g]),p.push(obj.colgroup[g]);if(obj.options.footers)for(var m=0;m<obj.options.footers.length;m++){b[m]=[];for(l=0;l<i;l++)b[m].push("");obj.options.footers[m].splice(s,0,b[m])}for(var j=0;j<obj.options.data.length;j++){var v=obj.options.data[j].splice(s),y=obj.records[j].splice(s);h[j]=[],f[j]=[];for(g=s;g<i+s;g++){var x=r[j]?r[j]:"";obj.options.data[j][g]=x;var C=obj.createCell(g,j,obj.options.data[j][g]);obj.records[j][g]=C,obj.rows[j]&&obj.rows[j].insertBefore(C,obj.rows[j].children[g+1]),h[j].push(x),f[j].push(C)}Array.prototype.push.apply(obj.options.data[j],v),Array.prototype.push.apply(obj.records[j],y)}if(Array.prototype.push.apply(obj.headers,u),Array.prototype.push.apply(obj.colgroup,c),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(m=0;m<obj.options.nestedHeaders.length;m++){var w=parseInt(obj.options.nestedHeaders[m][obj.options.nestedHeaders[m].length-1].colspan)+i;obj.options.nestedHeaders[m][obj.options.nestedHeaders[m].length-1].colspan=w,obj.thead.children[m].children[obj.thead.children[m].children.length-1].setAttribute("colspan",w);var E=obj.thead.children[m].children[obj.thead.children[m].children.length-1].getAttribute("data-column");E=E.split(",");for(g=s;g<i+s;g++)E.push(g);obj.thead.children[m].children[obj.thead.children[m].children.length-1].setAttribute("data-column",E)}else{w=parseInt(obj.options.nestedHeaders[0].colspan)+i;obj.options.nestedHeaders[0].colspan=w,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",w)}obj.setHistory({action:"insertColumn",columnNumber:t,numOfColumns:i,insertBefore:n,columns:o,headers:d,colgroup:p,records:f,footers:b,data:h}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,t,i,f,n)}},obj.deleteColumn=function(e,t){if(1==obj.options.allowDeleteColumn)if(obj.headers.length>1){if(null==e){var n=obj.getSelectedColumns(!0);n.length?(e=parseInt(n[0]),t=parseInt(n.length)):(e=obj.headers.length-1,t=1)}var o=obj.options.data[0].length-1;if((null==e||e>o||e<0)&&(e=o),t||(t=1),t>obj.options.data[0].length-e&&(t=obj.options.data[0].length-e),!1===obj.dispatch("onbeforedeletecolumn",el,e,t))return!1;if(parseInt(e)>-1){var r=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var i=e;i<e+t;i++)obj.isColMerged(i,!1).length&&(r=!0);if(r){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var a=obj.options.columns.splice(e,t);for(i=e;i<e+t;i++)obj.colgroup[i].className="",obj.headers[i].className="",obj.colgroup[i].parentNode.removeChild(obj.colgroup[i]),obj.headers[i].parentNode.removeChild(obj.headers[i]);for(var l=obj.headers.splice(e,t),s=obj.colgroup.splice(e,t),u=[],c=[],d=[],p=0;p<obj.options.data.length;p++)for(i=e;i<e+t;i++)obj.records[p][i].className="",obj.records[p][i].parentNode.removeChild(obj.records[p][i]);for(p=0;p<obj.options.data.length;p++)c[p]=obj.options.data[p].splice(e,t),u[p]=obj.records[p].splice(e,t);if(obj.options.footers)for(p=0;p<obj.options.footers.length;p++)d[p]=obj.options.footers[p].splice(e,t);if(obj.conditionalSelectionUpdate(0,e,e+t-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var f=0;f<obj.options.nestedHeaders.length;f++){var h=parseInt(obj.options.nestedHeaders[f][obj.options.nestedHeaders[f].length-1].colspan)-t;obj.options.nestedHeaders[f][obj.options.nestedHeaders[f].length-1].colspan=h,obj.thead.children[f].children[obj.thead.children[f].children.length-1].setAttribute("colspan",h)}else{h=parseInt(obj.options.nestedHeaders[0].colspan)-t;obj.options.nestedHeaders[0].colspan=h,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",h)}obj.setHistory({action:"deleteColumn",columnNumber:e,numOfColumns:t,insertBefore:1,columns:a,headers:l,colgroup:s,records:u,footers:d,data:c}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,e,t,u)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(e){for(var t=[],n=0;n<obj.rows.length;n++)obj.rows[n].classList.contains("selected")&&(e?t.push(n):t.push(obj.rows[n]));return t},obj.getSelectedColumns=function(){for(var e=[],t=0;t<obj.headers.length;t++)obj.headers[t].classList.contains("selected")&&e.push(t);return e},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var e=0;e<obj.headers.length;e++){(i=obj.headers[e].getAttribute("data-x"))!=e&&(obj.headers[e].setAttribute("data-x",e),obj.headers[e].getAttribute("title")||(obj.headers[e].innerHTML=jexcel.getColumnName(e)))}for(var t=0;t<obj.rows.length;t++){if(obj.rows[t])(a=obj.rows[t].getAttribute("data-y"))!=t&&(obj.rows[t].setAttribute("data-y",t),obj.rows[t].children[0].setAttribute("data-y",t),obj.rows[t].children[0].innerHTML=t+1)}var n=[],o=[],r=function(e,t,o,r){if(e!=o&&obj.records[r][o].setAttribute("data-x",o),t!=r&&obj.records[r][o].setAttribute("data-y",r),e!=o||t!=r){var i=jexcel.getColumnNameFromId([e,t]),a=jexcel.getColumnNameFromId([o,r]);n[i]=a}};for(t=0;t<obj.records.length;t++)for(e=0;e<obj.records[0].length;e++)if(obj.records[t][e]){var i=obj.records[t][e].getAttribute("data-x"),a=obj.records[t][e].getAttribute("data-y");if(obj.records[t][e].getAttribute("data-merged")){var l=jexcel.getColumnNameFromId([i,a]),s=jexcel.getColumnNameFromId([e,t]);if(null==o[l])if(l==s)o[l]=!1;else{var u=parseInt(e-i),c=parseInt(t-a);o[l]=[s,u,c]}}else r(i,a,e,t)}var d=Object.keys(o);if(d.length)for(e=0;e<d.length;e++)if(o[d[e]]){var p=jexcel.getIdFromColumnName(d[e],!0);r(i=p[0],a=p[1],i+o[d[e]][1],a+o[d[e]][2]);for(l=d[e],s=o[d[e]][0],t=0;t<obj.options.mergeCells[l][2].length;t++){i=parseInt(obj.options.mergeCells[l][2][t].getAttribute("data-x")),a=parseInt(obj.options.mergeCells[l][2][t].getAttribute("data-y"));obj.options.mergeCells[l][2][t].setAttribute("data-x",i+o[d[e]][1]),obj.options.mergeCells[l][2][t].setAttribute("data-y",a+o[d[e]][2])}obj.options.mergeCells[s]=obj.options.mergeCells[l],delete obj.options.mergeCells[l]}obj.updateFormulas(n),obj.updateMeta(n),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var e=0,t=obj.rows.length-1;t>=0;t--){for(var n=!1,o=0;o<obj.headers.length;o++)obj.options.data[t][o]&&(n=!0);if(n)break;e++}obj.options.minSpareRows-e>0&&obj.insertRow(obj.options.minSpareRows-e)}if(obj.options.minSpareCols>0){var r=0;for(o=obj.headers.length-1;o>=0;o--){for(n=!1,t=0;t<obj.rows.length;t++)obj.options.data[t][o]&&(n=!0);if(n)break;r++}obj.options.minSpareCols-r>0&&obj.insertColumn(obj.options.minSpareCols-r)}if("function"==typeof obj.options.updateTable){obj.options.detachForUpdates&&el.removeChild(obj.content);for(t=0;t<obj.rows.length;t++)for(o=0;o<obj.headers.length;o++)obj.options.updateTable(el,obj.records[t][o],o,t,obj.options.data[t][o],obj.records[t][o].innerText,jexcel.getColumnNameFromId([o,t]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout((function(){obj.updateCornerPosition()}),0)},obj.isReadOnly=function(e){if(e=obj.getCell(e))return!!e.classList.contains("readonly")},obj.setReadOnly=function(e,t){(e=obj.getCell(e))&&(t?e.classList.add("readonly"):e.classList.remove("readonly"))},obj.showRow=function(e){obj.rows[e].style.display=""},obj.hideRow=function(e){obj.rows[e].style.display="none"},obj.showColumn=function(e){obj.headers[e].style.display="",obj.colgroup[e].style.display="",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="");for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display="";obj.resetSelection()},obj.hideColumn=function(e){obj.headers[e].style.display="none",obj.colgroup[e].style.display="none",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="none");for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display="none";obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(e,t,n){var o=jexcel.getColumnNameFromId([e,t]);if(obj.formula[o]&&obj.formula[o].length>0)if(chainLoopProtection[o])obj.records[t][e].innerHTML="#ERROR",obj.formula[o]="";else{chainLoopProtection[o]=!0;for(var r=0;r<obj.formula[o].length;r++){var i=jexcel.getIdFromColumnName(obj.formula[o][r],!0),a=""+obj.options.data[i[1]][i[0]];"="==a.substr(0,1)?n.push(obj.updateCell(i[0],i[1],a,!0)):Object.keys(obj.formula)[r]=null,obj.updateFormulaChain(i[0],i[1],n)}}chainLoopProtection=[]},obj.updateFormulas=function(e){for(var t=0;t<obj.options.data.length;t++)for(var n=0;n<obj.options.data[0].length;n++){if("="==(l=""+obj.options.data[t][n]).substr(0,1)){var o=obj.updateFormula(l,e);o!=l&&(obj.options.data[t][n]=o)}}var r=[],i=Object.keys(obj.formula);for(t=0;t<i.length;t++){var a=i[t],l=obj.formula[a];e[a]&&(a=e[a]),r[a]=[];for(n=0;n<l.length;n++){var s=l[n];e[s]&&(s=e[s]),r[a].push(s)}}obj.formula=r},obj.updateFormula=function(e,t){for(var n=/[A-Z]/,o=/[0-9]/,r="",i=null,a=null,l="",s=0;s<e.length;s++)n.exec(e[s])?(i=1,a=0,l+=e[s]):o.exec(e[s])?(a=i?1:0,l+=e[s]):(i&&a&&(l=t[l]?t[l]:l),r+=l,r+=e[s],i=0,a=0,l="");return l&&(i&&a&&(l=t[l]?t[l]:l),r+=l),r};var secureFormula=function(e){for(var t="",n=0,o=0;o<e.length;o++)'"'==e[o]&&(n=0==n?1:0),t+=1==n?e[o]:e[o].toUpperCase();return t};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(e){for(var t=0;t<e.length;t++){var n=[],o=e[t].split(":"),r=jexcel.getIdFromColumnName(o[0],!0),i=jexcel.getIdFromColumnName(o[1],!0);if(r[0]<=i[0])var a=r[0],l=i[0];else a=i[0],l=r[0];if(r[1]<=i[1])var s=r[1],u=i[1];else s=i[1],u=r[1];for(var c=s;c<=u;c++)for(var d=a;d<=l;d++)n.push(jexcel.getColumnNameFromId([d,c]));expression=expression.replace(e[t],n.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens)for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(void 0!==obj.options.data[position[1]]&&void 0!==obj.options.data[position[1]][position[0]])var value=obj.options.data[position[1]][position[0]];else var value="";if("="==(""+value).substr(0,1)&&(formulaResults[tokens[i]]?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),""==(""+value).trim())formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&1==obj.options.autoCasting)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);1==obj.options.autoCasting&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(e){var res="#ERROR";console.log(e)}return res};return execute(expression,x,y)},obj.parseNumber=function(e,t){var n=t&&obj.options.columns[t].decimal?obj.options.columns[t].decimal:".",o=""+e;if((o=o.split(n))[0]=o[0].match(/[+-]?[0-9]/g),o[0]&&(o[0]=o[0].join("")),o[1]&&(o[1]=o[1].match(/[0-9]*/g).join("")),o[0]&&Number(o[0])>=0)if(o[1])e=Number(o[0]+"."+o[1]);else var e=Number(o[0]+".00");else e=null;return e},obj.row=function(e){},obj.col=function(e){},obj.up=function(e,t){if(e?obj.selectedCell[3]>0&&obj.up.visible(1,t?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading)if(0==obj.selectedCell[1]||0==obj.selectedCell[3])obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var n=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-n<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var o=obj.whichPage(obj.selectedCell[3]);o!=obj.pageNumber&&obj.page(o)}obj.updateScroll(1)},obj.up.visible=function(e,t){if(0==e)var n=parseInt(obj.selectedCell[0]),o=parseInt(obj.selectedCell[1]);else n=parseInt(obj.selectedCell[2]),o=parseInt(obj.selectedCell[3]);if(0==t){for(var r=0;r<o;r++)if("none"!=obj.records[r][n].style.display&&"none"!=obj.rows[r].style.display){o=r;break}}else o=obj.up.get(n,o);0==e?(obj.selectedCell[0]=n,obj.selectedCell[1]=o):(obj.selectedCell[2]=n,obj.selectedCell[3]=o)},obj.up.get=function(e,t){e=parseInt(e);for(var n=(t=parseInt(t))-1;n>=0;n--)if("none"!=obj.records[n][e].style.display&&"none"!=obj.rows[n].style.display){if(obj.records[n][e].getAttribute("data-merged")&&obj.records[n][e]==obj.records[t][e])continue;t=n;break}return t},obj.down=function(e,t){if(e?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,t?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var n=obj.whichPage(obj.selectedCell[3]);n!=obj.pageNumber&&obj.page(n)}obj.updateScroll(3)},obj.down.visible=function(e,t){if(0==e)var n=parseInt(obj.selectedCell[0]),o=parseInt(obj.selectedCell[1]);else n=parseInt(obj.selectedCell[2]),o=parseInt(obj.selectedCell[3]);if(0==t){for(var r=obj.rows.length-1;r>o;r--)if("none"!=obj.records[r][n].style.display&&"none"!=obj.rows[r].style.display){o=r;break}}else o=obj.down.get(n,o);0==e?(obj.selectedCell[0]=n,obj.selectedCell[1]=o):(obj.selectedCell[2]=n,obj.selectedCell[3]=o)},obj.down.get=function(e,t){e=parseInt(e);for(var n=(t=parseInt(t))+1;n<obj.rows.length;n++)if("none"!=obj.records[n][e].style.display&&"none"!=obj.rows[n].style.display){if(obj.records[n][e].getAttribute("data-merged")&&obj.records[n][e]==obj.records[t][e])continue;t=n;break}return t},obj.right=function(e,t){e?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,t?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(e,t){if(0==e)var n=parseInt(obj.selectedCell[0]),o=parseInt(obj.selectedCell[1]);else n=parseInt(obj.selectedCell[2]),o=parseInt(obj.selectedCell[3]);if(0==t){for(var r=obj.headers.length-1;r>n;r--)if("none"!=obj.records[o][r].style.display){n=r;break}}else n=obj.right.get(n,o);0==e?(obj.selectedCell[0]=n,obj.selectedCell[1]=o):(obj.selectedCell[2]=n,obj.selectedCell[3]=o)},obj.right.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var n=e+1;n<obj.headers.length;n++)if("none"!=obj.records[t][n].style.display){if(obj.records[t][n].getAttribute("data-merged")&&obj.records[t][n]==obj.records[t][e])continue;e=n;break}return e},obj.left=function(e,t){e?obj.selectedCell[2]>0&&obj.left.visible(1,t?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(e,t){if(0==e)var n=parseInt(obj.selectedCell[0]),o=parseInt(obj.selectedCell[1]);else n=parseInt(obj.selectedCell[2]),o=parseInt(obj.selectedCell[3]);if(0==t){for(var r=0;r<n;r++)if("none"!=obj.records[o][r].style.display){n=r;break}}else n=obj.left.get(n,o);0==e?(obj.selectedCell[0]=n,obj.selectedCell[1]=o):(obj.selectedCell[2]=n,obj.selectedCell[3]=o)},obj.left.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var n=e-1;n>=0;n--)if("none"!=obj.records[t][n].style.display){if(obj.records[t][n].getAttribute("data-merged")&&obj.records[t][n]==obj.records[t][e])continue;e=n;break}return e},obj.first=function(e,t){if(e?t?obj.selectedCell[3]=0:obj.left.visible(1,0):(t?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1!=obj.options.lazyLoading||0!=obj.selectedCell[1]&&0!=obj.selectedCell[3]){if(obj.options.pagination>0){var n=obj.whichPage(obj.selectedCell[3]);n!=obj.pageNumber&&obj.page(n)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(e,t){if(e?t?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(t?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1!=obj.options.lazyLoading||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var n=obj.whichPage(obj.selectedCell[3]);n!=obj.pageNumber&&obj.page(n)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(e){if(1==obj.options.search&&obj.results)var t=obj.results;else t=obj.rows;var n=100;null!=e&&-1!=e||(e=Math.ceil(t.length/n)-1);var o=e*n,r=e*n+n;r>t.length&&(r=t.length),(o=r-100)<0&&(o=0);for(var i=o;i<r;i++)1==obj.options.search&&obj.results?obj.tbody.appendChild(obj.rows[t[i]]):obj.tbody.appendChild(obj.rows[i]),obj.tbody.children.length>n&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(1==obj.options.search&&obj.results)var e=obj.results;else e=obj.rows;var t=0;if(e.length>100){var n=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(1==obj.options.search&&obj.results&&(n=e.indexOf(n)),n>0)for(var o=0;o<30;o++)(n-=1)>-1&&(1==obj.options.search&&obj.results?obj.tbody.insertBefore(obj.rows[e[n]],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[n],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),t=1))}return t},obj.loadDown=function(){if(1==obj.options.search&&obj.results)var e=obj.results;else e=obj.rows;var t=0;if(e.length>100){var n=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(1==obj.options.search&&obj.results&&(n=e.indexOf(n)),n<obj.rows.length-1)for(var o=0;o<=30;o++)n<e.length&&(1==obj.options.search&&obj.results?obj.tbody.appendChild(obj.rows[e[n]]):obj.tbody.appendChild(obj.rows[n]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),t=1)),n+=1}return t},obj.loadValidation=function(){if(obj.selectedCell){var e=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,t=parseInt(obj.selectedCell[3]/100),n=parseInt(obj.rows.length/100);if(e!=t&&t<=n&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(t),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(e){if(e)e=e.toLowerCase();if(obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],e){var t=function(e){-1==obj.results.indexOf(e)&&obj.results.push(e)};obj.options.data.filter((function(n,o){if(function(e,t,n){for(var o=0;o<e.length;o++)if((""+e[o]).toLowerCase().search(t)>=0||(""+obj.records[n][o].innerHTML).toLowerCase().search(t)>=0)return!0;return!1}(n,e,o)){var r=obj.isRowMerged(o);if(r.length)for(var i=0;i<r.length;i++)for(var a=jexcel.getIdFromColumnName(r[i],!0),l=0;l<obj.options.mergeCells[r[i]][1];l++)t(a[1]+l);else t(o);return!0}return!1}))}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var e=0,t=0;for(e=1==obj.options.lazyLoading?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var n=0;n<obj.rows.length;n++)!obj.results||obj.results.indexOf(n)>-1?(t<e&&(obj.tbody.appendChild(obj.rows[n]),t++),obj.rows[n].style.display=""):obj.rows[n].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),e},obj.whichPage=function(e){return 1==obj.options.search&&obj.results&&(e=obj.results.indexOf(e)),Math.ceil((parseInt(e)+1)/parseInt(obj.options.pagination))-1},obj.page=function(e){var t=obj.pageNumber;if(1==obj.options.search&&obj.results)var n=obj.results;else n=obj.rows;var o=parseInt(obj.options.pagination);null!=e&&-1!=e||(e=Math.ceil(n.length/o)-1),obj.pageNumber=e;var r=e*o,i=e*o+o;for(i>n.length&&(i=n.length),r<0&&(r=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var a=r;a<i;a++)1==obj.options.search&&obj.results?obj.tbody.appendChild(obj.rows[n[a]]):obj.tbody.appendChild(obj.rows[a]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,e,t)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(1==obj.options.search&&obj.results)var e=obj.results.length;else e=obj.rows.length;if(e){var t=Math.ceil(e/obj.options.pagination);if(obj.pageNumber<6)var n=1,o=t<10?t:10;else if(t-obj.pageNumber<5){o=t;(n=t-9)<1&&(n=1)}else n=obj.pageNumber-4,o=obj.pageNumber+5;if(n>1)(i=document.createElement("div")).className="jexcel_page",i.innerHTML="<",i.title=1,obj.pagination.children[1].appendChild(i);for(var r=n;r<=o;r++){var i;(i=document.createElement("div")).className="jexcel_page",i.innerHTML=r,obj.pagination.children[1].appendChild(i),obj.pageNumber==r-1&&i.classList.add("jexcel_page_selected")}if(o<t)(i=document.createElement("div")).className="jexcel_page",i.innerHTML=">",i.title=t,obj.pagination.children[1].appendChild(i);obj.pagination.children[0].innerHTML=function(e){var t=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,(function(e,n){return void 0!==t[n]?t[n]:e}))}(obj.options.text.showingPage,obj.pageNumber+1,t)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(e){if(0==obj.options.allowExport)console.error("Export not allowed");else{var t="";t+=obj.copy(!1,obj.options.csvDelimiter,!0,e,!0);var n=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,obj.options.csvFileName+".csv");else{var o=document.createElement("a"),r=URL.createObjectURL(n);o.href=r,o.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(o),o.click(),o.parentNode.removeChild(o)}}},obj.setHistory=function(e){if(1!=obj.ignoreHistory){var t=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,t+1),obj.history[t]=e}},obj.copy=function(e,t,n,o,r){t||(t="\t");for(var i=new RegExp(t,"ig"),a=[],l=[],s=[],u=[],c=[],d=obj.options.data[0].length,p=obj.options.data.length,f="",h=!1,b="",g="",m=0,j=0,v=0,y=0,x=!0,C=0;C<p;C++)for(var w=0;w<d;w++)e&&!obj.records[C][w].classList.contains("highlight")||(v<=w&&(v=w),y<=C&&(y=C));if(d===v+1&&p===y+1&&(x=!1),r&&1==obj.options.includeHeadersOnDownload||!r&&1==obj.options.includeHeadersOnCopy&&!x||o){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0){f=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders];for(C=0;C<f.length;C++){var E=[];for(w=0;w<f[C].length;w++){var A=parseInt(f[C][w].colspan);E.push(f[C][w].title);for(var L=0;L<A-1;L++)E.push("")}g+=E.join(t)+"\r\n"}}h=!0}obj.style=[];for(C=0;C<p;C++){l=[],s=[];for(w=0;w<d;w++)if(!e||obj.records[C][w].classList.contains("highlight")){1==h&&a.push(obj.headers[w].innerText);var N=obj.options.data[C][w];if(N.match&&(N.match(i)||N.match(/,/g)||N.match(/\n/)||N.match(/\"/))&&(N='"'+(N=N.replace(new RegExp('"',"g"),'""'))+'"'),l.push(N),"checkbox"==obj.options.columns[w].type||"radio"==obj.options.columns[w].type)var I=N;else{if(1==obj.options.stripHTMLOnCopy)I=obj.records[C][w].innerText;else I=obj.records[C][w].innerHTML;I.match&&(I.match(i)||I.match(/,/g)||I.match(/\n/)||I.match(/\"/))&&(I='"'+(I=I.replace(new RegExp('"',"g"),'""'))+'"')}s.push(I),f=(f=obj.records[C][w].getAttribute("style")).replace("display: none;",""),obj.style.push(f||"")}l.length&&(h&&(m=l.length,u.push(a.join(t))),u.push(l.join(t))),s.length&&(j++,h&&(c.push(a.join(t)),h=!1),c.push(s.join(t)))}d==m&&p==j&&(b=g);var M=b+u.join("\r\n"),k=b+c.join("\r\n");if(n||(1==obj.options.copyCompatibility?obj.textarea.value=k:obj.textarea.value=M,obj.textarea.select(),document.execCommand("copy")),1==obj.options.copyCompatibility?obj.data=k:obj.data=M,obj.hashString=obj.hash(obj.data),!n){if(obj.removeCopyingSelection(),obj.highlighted)for(w=0;w<obj.highlighted.length;w++)obj.highlighted[w].classList.add("copying"),obj.highlighted[w].classList.contains("highlight-left")&&obj.highlighted[w].classList.add("copying-left"),obj.highlighted[w].classList.contains("highlight-right")&&obj.highlighted[w].classList.add("copying-right"),obj.highlighted[w].classList.contains("highlight-top")&&obj.highlighted[w].classList.add("copying-top"),obj.highlighted[w].classList.contains("highlight-bottom")&&obj.highlighted[w].classList.add("copying-bottom");obj.dispatch("oncopy",el,1==obj.options.copyCompatibility?c:u,obj.hashString)}return obj.data},obj.paste=function(e,t,n){var o=obj.dispatch("onbeforepaste",el,n,e,t);if(!1===o)return!1;if(o)n=o;var r=obj.hash(n),i=r==obj.hashString?obj.style:null;if(1==obj.options.copyCompatibility&&r==obj.hashString)n=obj.data;n=obj.parseCSV(n,"\t");if(null!=e&&null!=t&&n){for(var a=0,l=0,s=[],u={},c={},d=0,p=parseInt(e),f=parseInt(t),h=null;h=n[l];){for(a=0,p=parseInt(e);null!=h[a];){var b=obj.updateCell(p,f,h[a]);if(s.push(b),obj.updateFormulaChain(p,f,s),i&&i[d]){var g=jexcel.getColumnNameFromId([p,f]);u[g]=i[d],c[g]=obj.getStyle(g),obj.records[f][p].setAttribute("style",i[d]),d++}if(null!=h[++a]){if(p>=obj.headers.length-1){if(1!=obj.options.allowInsertColumn)break;obj.insertColumn()}p=obj.right.get(p,f)}}if(n[++l]){if(f>=obj.rows.length-1){if(1!=obj.options.allowInsertRow)break;obj.insertRow()}f=obj.down.get(e,f)}}obj.updateSelectionFromCoords(e,t,p,f),obj.setHistory({action:"setValue",records:s,selection:obj.selectedCell,newStyle:u,oldStyle:c}),obj.updateTable(),obj.dispatch("onpaste",el,n),obj.onafterchanges(el,s)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var e=document.querySelectorAll(".jexcel .copying"),t=0;t<e.length;t++)e[t].classList.remove("copying"),e[t].classList.remove("copying-left"),e[t].classList.remove("copying-right"),e[t].classList.remove("copying-top"),e[t].classList.remove("copying-bottom")},obj.historyProcessRow=function(e,t){var n=t.insertBefore?+t.rowNumber:t.rowNumber+1;if(1==obj.options.search&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),1==e){for(var o=t.numOfRows,r=n;r<o+n;r++)obj.rows[r].parentNode.removeChild(obj.rows[r]);obj.records.splice(n,o),obj.options.data.splice(n,o),obj.rows.splice(n,o),obj.conditionalSelectionUpdate(1,n,o+n-1)}else{obj.records=jexcel.injectArray(obj.records,n,t.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,n,t.rowData),obj.rows=jexcel.injectArray(obj.rows,n,t.rowNode);var i=0;for(r=n;r<t.numOfRows+n;r++)obj.tbody.insertBefore(t.rowNode[i],obj.tbody.children[r]),i++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(e,t){var n=t.insertBefore?t.columnNumber:t.columnNumber+1;if(1==e){var o=t.numOfColumns;obj.options.columns.splice(n,o);for(var r=n;r<o+n;r++)obj.headers[r].parentNode.removeChild(obj.headers[r]),obj.colgroup[r].parentNode.removeChild(obj.colgroup[r]);obj.headers.splice(n,o),obj.colgroup.splice(n,o);for(var i=0;i<t.data.length;i++){for(r=n;r<o+n;r++)obj.records[i][r].parentNode.removeChild(obj.records[i][r]);obj.records[i].splice(n,o),obj.options.data[i].splice(n,o)}if(obj.options.footers)for(i=0;i<obj.options.footers.length;i++)obj.options.footers[i].splice(n,o)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,n,t.columns),obj.headers=jexcel.injectArray(obj.headers,n,t.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,n,t.colgroup);var a=0;for(r=n;r<t.numOfColumns+n;r++)obj.headerContainer.insertBefore(t.headers[a],obj.headerContainer.children[r+1]),obj.colgroupContainer.insertBefore(t.colgroup[a],obj.colgroupContainer.children[r+1]),a++;for(i=0;i<t.data.length;i++){obj.options.data[i]=jexcel.injectArray(obj.options.data[i],n,t.data[i]),obj.records[i]=jexcel.injectArray(obj.records[i],n,t.records[i]);for(a=0,r=n;r<t.numOfColumns+n;r++)obj.rows[i].insertBefore(t.records[i][a],obj.rows[i].children[r+1]),a++}if(obj.options.footers)for(i=0;i<obj.options.footers.length;i++)obj.options.footers[i]=jexcel.injectArray(obj.options.footers[i],n,t.footers[i])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(i=0;i<obj.options.nestedHeaders.length;i++){if(1==e)var l=parseInt(obj.options.nestedHeaders[i][obj.options.nestedHeaders[i].length-1].colspan)-t.numOfColumns;else l=parseInt(obj.options.nestedHeaders[i][obj.options.nestedHeaders[i].length-1].colspan)+t.numOfColumns;obj.options.nestedHeaders[i][obj.options.nestedHeaders[i].length-1].colspan=l,obj.thead.children[i].children[obj.thead.children[i].children.length-1].setAttribute("colspan",l)}else{if(1==e)l=parseInt(obj.options.nestedHeaders[0].colspan)-t.numOfColumns;else l=parseInt(obj.options.nestedHeaders[0].colspan)+t.numOfColumns;obj.options.nestedHeaders[0].colspan=l,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",l)}obj.updateTableReferences()},obj.undo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var n=[];if(obj.historyIndex>=0){var o=obj.history[obj.historyIndex--];if("insertRow"==o.action)obj.historyProcessRow(1,o);else if("deleteRow"==o.action)obj.historyProcessRow(0,o);else if("insertColumn"==o.action)obj.historyProcessColumn(1,o);else if("deleteColumn"==o.action)obj.historyProcessColumn(0,o);else if("moveRow"==o.action)obj.moveRow(o.newValue,o.oldValue);else if("moveColumn"==o.action)obj.moveColumn(o.newValue,o.oldValue);else if("setMerge"==o.action)obj.removeMerge(o.column,o.data);else if("setStyle"==o.action)obj.setStyle(o.oldValue,null,null,1);else if("setWidth"==o.action)obj.setWidth(o.column,o.oldValue);else if("setHeight"==o.action)obj.setHeight(o.row,o.oldValue);else if("setHeader"==o.action)obj.setHeader(o.column,o.oldValue);else if("setComments"==o.action)obj.setComments(o.column,o.oldValue[0],o.oldValue[1]);else if("orderBy"==o.action){for(var r=[],i=0;i<o.rows.length;i++)r[o.rows[i]]=i;obj.updateOrderArrow(o.column,o.order?0:1),obj.updateOrder(r)}else if("setValue"==o.action){for(var a=0;a<o.records.length;a++)n.push({x:o.records[a].x,y:o.records[a].y,newValue:o.records[a].oldValue}),o.oldStyle&&obj.resetStyle(o.oldStyle);obj.setValue(n),o.selection&&obj.updateSelectionFromCoords(o.selection[0],o.selection[1],o.selection[2],o.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onundo",el,o)},obj.redo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;if(obj.historyIndex<obj.history.length-1){var n=obj.history[++obj.historyIndex];if("insertRow"==n.action)obj.historyProcessRow(0,n);else if("deleteRow"==n.action)obj.historyProcessRow(1,n);else if("insertColumn"==n.action)obj.historyProcessColumn(0,n);else if("deleteColumn"==n.action)obj.historyProcessColumn(1,n);else if("moveRow"==n.action)obj.moveRow(n.oldValue,n.newValue);else if("moveColumn"==n.action)obj.moveColumn(n.oldValue,n.newValue);else if("setMerge"==n.action)obj.setMerge(n.column,n.colspan,n.rowspan,1);else if("setStyle"==n.action)obj.setStyle(n.newValue,null,null,1);else if("setWidth"==n.action)obj.setWidth(n.column,n.newValue);else if("setHeight"==n.action)obj.setHeight(n.row,n.newValue);else if("setHeader"==n.action)obj.setHeader(n.column,n.newValue);else if("setComments"==n.action)obj.setComments(n.column,n.newValue[0],n.newValue[1]);else if("orderBy"==n.action)obj.updateOrderArrow(n.column,n.order),obj.updateOrder(n.rows);else if("setValue"==n.action){obj.setValue(n.records);for(var o=0;o<n.records.length;o++)n.oldStyle&&obj.resetStyle(n.newStyle);n.selection&&obj.updateSelectionFromCoords(n.selection[0],n.selection[1],n.selection[2],n.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onredo",el,n)},obj.getDropDownValue=function(e,t){var n=[];if(obj.options.columns[e]&&obj.options.columns[e].source){for(var o=[],r=obj.options.columns[e].source,i=0;i<r.length;i++)"object"==typeof r[i]?o[r[i].id]=r[i].name:o[r[i]]=r[i];var a=Array.isArray(t)?t:(""+t).split(";");for(i=0;i<a.length;i++)"object"==typeof a[i]?n.push(o[a[i].id]):o[a[i]]&&n.push(o[a[i]])}else console.error("Invalid column");return n.length>0?n.join("; "):""},obj.parseCSV=function(e,t){9==(e=e.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(e.length-1)&&(e+="\0"),t=t||",";for(var n=[],o=!1,r=0,i=0,a=0;a<e.length;a++){var l=e[a],s=e[a+1];n[r]=n[r]||[],n[r][i]=n[r][i]||"",'"'==l&&o&&'"'==s?(n[r][i]+=l,++a):'"'!=l?l!=t||o?"\r"!=l||"\n"!=s||o?("\n"!=l||o)&&("\r"!=l||o)?n[r][i]+=l:(++r,i=0):(++r,i=0,++a):++i:o=!o}return n},obj.hash=function(e){var t,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},obj.onafterchanges=function(e,t){obj.dispatch("onafterchanges",e,t)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,"function"==typeof jexcel.build&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",(function(e){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())})),obj.options.csv?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(e){var t=obj.parseCSV(e,obj.options.csvDelimiter);if(1==obj.options.csvHeaders&&t.length>0)for(var n=t.shift(),o=0;o<n.length;o++)obj.options.columns[o]||(obj.options.columns[o]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),void 0===obj.options.columns[o].title&&(obj.options.columns[o].title=n[o]);obj.options.data=t,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.prepareTable()},options&&null!=options.contextMenu?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(e,t,n,o){var r=[];if(null==n)1==obj.options.allowInsertColumn&&r.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(t),1)}}),1==obj.options.allowInsertColumn&&r.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(t),0)}}),1==obj.options.allowDeleteColumn&&r.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(t))}}),1==obj.options.allowRenameColumn&&r.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(t)}}),1==obj.options.columnSorting&&(r.push({type:"line"}),r.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(t,0)}}),r.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(t,1)}}));else if(1==obj.options.allowInsertRow&&(r.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(n),1)}}),r.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(n))}})),1==obj.options.allowDeleteRow&&r.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(n))}}),t&&1==obj.options.allowComments){r.push({type:"line"});var i=obj.records[n][t].getAttribute("title")||"";r.push({title:i?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var e=prompt(obj.options.text.comments,i);e&&obj.setComments([t,n],e)}}),i&&r.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([t,n],"")}})}return r.push({type:"line"}),r.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&r.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then((function(e){e&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],e)}))}}),obj.options.allowExport&&r.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&r.push({title:obj.options.text.about,onclick:function(){!0===obj.options.about?alert(Version().print()):alert(obj.options.about)}}),r},obj.scrollControls=function(e){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),1!=obj.options.lazyLoading&&1!=obj.options.tableOverflow||obj.edition&&"jdropdown"!=e.target.className.substr(0,9)&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(e){1==obj.options.lazyLoading&&null==jexcel.timeControlLoading&&(jexcel.timeControlLoading=setTimeout((function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null}),100))},obj.getFreezeWidth=function(){var e=0;if(obj.options.freezeColumns>0)for(var t=0;t<obj.options.freezeColumns;t++)e+=parseInt(obj.options.columns[t].width);return e};var scrollLeft=0;return obj.updateFreezePosition=function(){var e=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var t=0;t<obj.options.freezeColumns;t++){t>0&&"hidden"!==obj.options.columns[t-1].type&&(e+=parseInt(obj.options.columns[t-1].width)),obj.headers[t].classList.add("jexcel_freezed"),obj.headers[t].style.left=e+"px",obj.options.filters&&(obj.filter.children[t+1].classList.add("jexcel_freezed"),obj.filter.children[t+1].style.left=e+"px");for(var n=0;n<obj.rows.length;n++)if(obj.rows[n]&&obj.records[n][t]){var o=scrollLeft+(t>0?obj.records[n][t-1].style.width:0)-51+"px";obj.records[n][t].classList.add("jexcel_freezed"),obj.records[n][t].style.left=o}}else for(t=0;t<obj.options.freezeColumns;t++){obj.headers[t].classList.remove("jexcel_freezed"),obj.headers[t].style.left="";for(n=0;n<obj.rows.length;n++)obj.records[n][t]&&(obj.records[n][t].classList.remove("jexcel_freezed"),obj.records[n][t].style.left="")}obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj},component;return jexcel.setDictionary=function(e){jSuites.setDictionary(e)},jexcel.setExtensions=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)"function"==typeof e[t[n]]&&(jexcel[t[n]]=e[t[n]],jexcel.license&&"function"==typeof e[t[n]].license&&e[t[n]].license(jexcel.license))},void 0!==formula&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null,jexcel.destroy=function(e,t){if(e.jexcel){var n=e.jexcel.options.root?e.jexcel.options.root:document;e.removeEventListener("DOMMouseScroll",e.jexcel.scrollControls),e.removeEventListener("mousewheel",e.jexcel.scrollControls),e.jexcel=null,e.innerHTML="",t&&(n.removeEventListener("mouseup",jexcel.mouseUpControls),n.removeEventListener("mousedown",jexcel.mouseDownControls),n.removeEventListener("mousemove",jexcel.mouseMoveControls),n.removeEventListener("mouseover",jexcel.mouseOverControls),n.removeEventListener("dblclick",jexcel.doubleClickControls),n.removeEventListener("paste",jexcel.pasteControls),n.removeEventListener("contextmenu",jexcel.contextMenuControls),n.removeEventListener("touchstart",jexcel.touchStartControls),n.removeEventListener("touchend",jexcel.touchEndControls),n.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls),jexcel=null)}},jexcel.build=function(e){e.addEventListener("mouseup",jexcel.mouseUpControls),e.addEventListener("mousedown",jexcel.mouseDownControls),e.addEventListener("mousemove",jexcel.mouseMoveControls),e.addEventListener("mouseover",jexcel.mouseOverControls),e.addEventListener("dblclick",jexcel.doubleClickControls),e.addEventListener("paste",jexcel.pasteControls),e.addEventListener("contextmenu",jexcel.contextMenuControls),e.addEventListener("touchstart",jexcel.touchStartControls),e.addEventListener("touchend",jexcel.touchEndControls),e.addEventListener("touchcancel",jexcel.touchEndControls),e.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(e){if(jexcel.current){if(jexcel.current.edition)if(27==e.which)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),e.preventDefault();else if(13==e.which)if("calendar"==jexcel.current.options.columns[jexcel.current.edition[2]].type)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if("dropdown"==jexcel.current.options.columns[jexcel.current.edition[2]].type||"autocomplete"==jexcel.current.options.columns[jexcel.current.edition[2]].type);else if((1==jexcel.current.options.wordWrap||1==jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&e.altKey){var t=jexcel.current.edition[0].children[0],n=jexcel.current.edition[0].children[0].value,o=t.selectionStart;n=n.slice(0,o)+"\n"+n.slice(o),t.value=n,t.focus(),t.selectionStart=o+1,t.selectionEnd=o+1}else jexcel.current.edition[0].children[0].blur();else 9==e.which&&("calendar"==jexcel.current.options.columns[jexcel.current.edition[2]].type?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(37==e.which)jexcel.current.left(e.shiftKey,e.ctrlKey),e.preventDefault();else if(39==e.which)jexcel.current.right(e.shiftKey,e.ctrlKey),e.preventDefault();else if(38==e.which)jexcel.current.up(e.shiftKey,e.ctrlKey),e.preventDefault();else if(40==e.which)jexcel.current.down(e.shiftKey,e.ctrlKey),e.preventDefault();else if(36==e.which)jexcel.current.first(e.shiftKey,e.ctrlKey),e.preventDefault();else if(35==e.which)jexcel.current.last(e.shiftKey,e.ctrlKey),e.preventDefault();else if(32==e.which)1==jexcel.current.options.editable&&jexcel.current.setCheckRadioValue(),e.preventDefault();else if(46==e.which)1==jexcel.current.options.editable&&(jexcel.current.selectedRow?1==jexcel.current.options.allowDeleteRow&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?1==jexcel.current.options.allowDeleteColumn&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(13==e.which)e.shiftKey?jexcel.current.up():(1==jexcel.current.options.allowInsertRow&&1==jexcel.current.options.allowManualInsertRow&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),e.preventDefault();else if(9==e.which)e.shiftKey?jexcel.current.left():(1==jexcel.current.options.allowInsertColumn&&1==jexcel.current.options.allowManualInsertColumn&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),e.preventDefault();else if(!e.ctrlKey&&!e.metaKey||e.shiftKey){if(jexcel.current.selectedCell&&1==jexcel.current.options.editable){var r=jexcel.current.selectedCell[1],i=jexcel.current.selectedCell[0];"readonly"!=jexcel.current.options.columns[i].type&&(32==e.keyCode?"checkbox"==jexcel.current.options.columns[i].type||"radio"==jexcel.current.options.columns[i].type?e.preventDefault():jexcel.current.openEditor(jexcel.current.records[r][i],!0):113==e.keyCode?jexcel.current.openEditor(jexcel.current.records[r][i],!1):(8==e.keyCode||e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=111||e.keyCode>=187&&e.keyCode<=190||(String.fromCharCode(e.keyCode)==e.key||String.fromCharCode(e.keyCode).toLowerCase()==e.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(e.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[r][i],!0),"calendar"==jexcel.current.options.columns[i].type&&e.preventDefault()))}}else 65==e.which?(jexcel.current.selectAll(),e.preventDefault()):83==e.which?(jexcel.current.download(),e.preventDefault()):89==e.which?(jexcel.current.redo(),e.preventDefault()):90==e.which?(jexcel.current.undo(),e.preventDefault()):67==e.which?(jexcel.current.copy(!0),e.preventDefault()):88==e.which?(1==jexcel.current.options.editable?jexcel.cutControls():jexcel.copyControls(),e.preventDefault()):86==e.which&&jexcel.pasteControls();else e.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout((function(){jexcel.current.search(e.target.value)}),200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else if(e.button)t=e.button;else t=e.which;var n=jexcel.getElement(e.target);if(n[0]?jexcel.current!=n[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=n[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&1==t){if(e.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(e.target.classList.contains("jexcel_corner"))1==jexcel.current.options.editable&&(jexcel.current.selectedCorner=!0);else{if(1==n[1]){if(f=e.target.getAttribute("data-x")){var o=e.target.getBoundingClientRect();if(1==jexcel.current.options.columnResize&&o.width-e.offsetX<6){jexcel.current.resizing={mousePosition:e.pageX,column:f,width:o.width},jexcel.current.headers[f].classList.add("resizing");for(var r=0;r<jexcel.current.records.length;r++)jexcel.current.records[r][f]&&jexcel.current.records[r][f].classList.add("resizing")}else if(1==jexcel.current.options.columnDrag&&o.height-e.offsetY<6)if(jexcel.current.isColMerged(f).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target,column:f,destination:f},jexcel.current.headers[f].classList.add("dragging");for(r=0;r<jexcel.current.records.length;r++)jexcel.current.records[r][f]&&jexcel.current.records[r][f].classList.add("dragging")}else{if(jexcel.current.selectedHeader&&(e.shiftKey||e.ctrlKey))var i=jexcel.current.selectedHeader,a=f;else{jexcel.current.selectedHeader==f&&1==jexcel.current.options.allowRenameColumn&&(jexcel.timeControl=setTimeout((function(){jexcel.current.setHeader(f)}),800)),jexcel.current.selectedHeader=f;i=f,a=f}jexcel.current.updateSelectionFromCoords(i,0,a,jexcel.current.options.data.length-1)}}else if(e.target.parentNode.classList.contains("jexcel_nested")){if(e.target.getAttribute("data-column"))var l=e.target.getAttribute("data-column").split(","),s=parseInt(l[0]),u=parseInt(l[l.length-1]);else s=0,u=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(s,0,u,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(2==n[1]){var c=e.target.getAttribute("data-y");if(e.target.classList.contains("jexcel_row")){o=e.target.getBoundingClientRect();if(1==jexcel.current.options.rowResize&&o.height-e.offsetY<6)jexcel.current.resizing={element:e.target.parentNode,mousePosition:e.pageY,row:c,height:o.height},e.target.parentNode.classList.add("resizing");else if(1==jexcel.current.options.rowDrag&&o.width-e.offsetX<6)jexcel.current.isRowMerged(c).length?console.error("Jspreadsheet: This row is part of a merged cell"):1==jexcel.current.options.search&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target.parentNode,row:c,destination:c},e.target.parentNode.classList.add("dragging"));else{if(jexcel.current.selectedRow&&(e.shiftKey||e.ctrlKey))i=jexcel.current.selectedRow,a=c;else{jexcel.current.selectedRow=c;i=c,a=c}jexcel.current.updateSelectionFromCoords(0,i,jexcel.current.options.data[0].length-1,a)}}else if(e.target.classList.contains("jclose")&&e.target.clientWidth-e.offsetX<50&&e.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var d=function(e){var t=e.getAttribute("data-x"),n=e.getAttribute("data-y");return t&&n?[t,n]:e.parentNode?d(e.parentNode):void 0},p=d(e.target);if(p){var f=p[0];c=p[1];jexcel.current.edition&&(jexcel.current.edition[2]==f&&jexcel.current.edition[3]==c||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(e.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],f,c):jexcel.current.updateSelectionFromCoords(f,c)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;e.target.classList.contains("jexcel_page")&&("<"==e.target.innerText?jexcel.current.page(0):">"==e.target.innerText?jexcel.current.page(e.target.getAttribute("title")-1):jexcel.current.page(e.target.innerText-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(e){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var t=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),n=jexcel.current.getSelectedColumns();if(n.length>1){for(var o=[],r=0;r<n.length;r++)o.push(parseInt(jexcel.current.colgroup[n[r]].getAttribute("width")));o[n.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(n,t,o)}else jexcel.current.setWidth(jexcel.current.resizing.column,t,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var i=0;i<jexcel.current.records.length;i++)jexcel.current.records[i][jexcel.current.resizing.column]&&jexcel.current.records[i][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var a=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,a,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var l=e.target.getAttribute("data-x");jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging");for(i=0;i<jexcel.current.rows.length;i++)jexcel.current.records[i][jexcel.current.dragging.column]&&jexcel.current.records[i][jexcel.current.dragging.column].classList.remove("dragging");for(r=0;r<jexcel.current.headers.length;r++)jexcel.current.headers[r].classList.remove("dragging-left"),jexcel.current.headers[r].classList.remove("dragging-right");l&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var s=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<s&&(s-=1)}else s=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,s,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else if(e.button)t=e.button;else t=e.which;if(t||(jexcel.isMouseAction=!1),jexcel.current)if(1==jexcel.isMouseAction){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var n=e.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+n>0){var o=jexcel.current.resizing.width+n;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",o),jexcel.current.updateCornerPosition()}}else{var r=e.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+r>0){var i=jexcel.current.resizing.height+r;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",i),jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var a=e.target.getAttribute("data-x");if(a)if(jexcel.current.isColMerged(a).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var l=0;l<jexcel.current.headers.length;l++)jexcel.current.headers[l].classList.remove("dragging-left"),jexcel.current.headers[l].classList.remove("dragging-right");jexcel.current.dragging.column==a?jexcel.current.dragging.destination=parseInt(a):e.target.clientWidth/2>e.offsetX?(jexcel.current.dragging.column<a?jexcel.current.dragging.destination=parseInt(a)-1:jexcel.current.dragging.destination=parseInt(a),jexcel.current.headers[a].classList.add("dragging-left")):(jexcel.current.dragging.column<a?jexcel.current.dragging.destination=parseInt(a):jexcel.current.dragging.destination=parseInt(a)+1,jexcel.current.headers[a].classList.add("dragging-right"))}}else{var s=e.target.getAttribute("data-y");if(s)if(jexcel.current.isRowMerged(s).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var u=e.target.clientHeight/2>e.offsetY?e.target.parentNode.nextSibling:e.target.parentNode;jexcel.current.dragging.element!=u&&(e.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,u),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}}else{var c=e.target.getAttribute("data-x"),d=e.target.getAttribute("data-y"),p=e.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),e.target.parentNode.parentNode&&e.target.parentNode.parentNode.className&&(e.target.parentNode.parentNode.classList.contains("resizable")&&(e.target&&c&&!d&&p.width-(e.clientX-p.left)<6?(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="col-resize"):e.target&&!c&&d&&p.height-(e.clientY-p.top)<6&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="row-resize")),e.target.parentNode.parentNode.classList.contains("draggable")&&(e.target&&!c&&d&&p.width-(e.clientX-p.left)<6||e.target&&c&&!d&&p.height-(e.clientY-p.top)<6)&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else if(e.button)t=e.button;else t=e.which;if(t||(jexcel.isMouseAction=!1),jexcel.current&&1==jexcel.isMouseAction){var n=jexcel.getElement(e.target);if(n[0]){if(jexcel.current!=n[0].jexcel&&jexcel.current)return!1;var o=e.target.getAttribute("data-x"),r=e.target.getAttribute("data-y");if(jexcel.current.resizing||jexcel.current.dragging);else{if(1==n[1]&&jexcel.current.selectedHeader){o=e.target.getAttribute("data-x");var i=jexcel.current.selectedHeader,a=o;jexcel.current.updateSelectionFromCoords(i,0,a,jexcel.current.options.data.length-1)}if(2==n[1])if(e.target.classList.contains("jexcel_row")){if(jexcel.current.selectedRow){i=jexcel.current.selectedRow,a=r;jexcel.current.updateSelectionFromCoords(0,i,jexcel.current.options.data[0].length-1,a)}}else jexcel.current.edition||o&&r&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(o,r):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],o,r))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(e){if(jexcel.current)if(e.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var t=jexcel.current.highlighted[0].getAttribute("data-x"),n=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,o=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),r=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[n][t],jexcel.current.records[r][o])}}else if(e.target.classList.contains("jexcel_column_filter")){var i=e.target.getAttribute("data-x");jexcel.current.openFilter(i)}else{var a=jexcel.getElement(e.target);if(1==a[1]&&1==jexcel.current.options.columnSorting)(i=e.target.getAttribute("data-x"))&&jexcel.current.orderBy(i);if(2==a[1]&&1==jexcel.current.options.editable&&!jexcel.current.edition){var l=function(e){if(e.parentNode){var t=e.getAttribute("data-x"),n=e.getAttribute("data-y");return t&&n?e:l(e.parentNode)}},s=l(e.target);s&&s.classList.contains("highlight")&&jexcel.current.openEditor(s)}}},jexcel.copyControls=function(e){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(e){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),1==jexcel.current.options.editable&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(e){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||1==jexcel.current.options.editable&&(e&&e.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],e.clipboardData.getData("text")),e.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(e){if("buttons"in(e=e||window.event))e.buttons;else e.which||e.button;if(jexcel.current)if(jexcel.current.edition)e.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var t=e.target.getAttribute("data-x"),n=e.target.getAttribute("data-y");if(t||n){(t<parseInt(jexcel.current.selectedCell[0])||t>parseInt(jexcel.current.selectedCell[2])||n<parseInt(jexcel.current.selectedCell[1])||n>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(t,n,t,n);var o=jexcel.current.options.contextMenu(jexcel.current,t,n,e);jexcel.current.contextMenu.contextmenu.open(e,o),e.preventDefault()}}},jexcel.touchStartControls=function(e){var t=jexcel.getElement(e.target);if(t[0]?jexcel.current!=t[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=t[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var n=e.target.getAttribute("data-x"),o=e.target.getAttribute("data-y");n&&o&&(jexcel.current.updateSelectionFromCoords(n,o),jexcel.timeControl=setTimeout((function(){"color"==jexcel.current.options.columns[n].type?jexcel.tmpElement=null:jexcel.tmpElement=e.target,jexcel.current.openEditor(e.target,!1,e)}),500))}},jexcel.touchEndControls=function(e){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&"INPUT"==jexcel.tmpElement.children[0].tagName&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(e,t){var n=[];if(e.classList.contains("jexcel_tabs"))r=e.children[0],i=e.children[1];else{e.innerHTML="",e.classList.add("jexcel_tabs"),e.jexcel=[];var o=document.createElement("div"),r=e.appendChild(o),i=(o=document.createElement("div"),e.appendChild(o))}for(var a=[],l=[],s=0;s<t.length;s++){a[s]=document.createElement("div"),a[s].classList.add("jexcel_tab");var u=jexcel(a[s],t[s]);i.appendChild(a[s]),n[s]=e.jexcel.push(u),l[s]=document.createElement("div"),l[s].classList.add("jexcel_tab_link"),l[s].setAttribute("data-spreadsheet",e.jexcel.length-1),l[s].innerHTML=t[s].sheetName,l[s].onclick=function(){for(var e=0;e<r.children.length;e++)r.children[e].classList.remove("selected"),i.children[e].style.display="none";var t=this.getAttribute("data-spreadsheet");i.children[t].style.display="block",r.children[t].classList.add("selected")},r.appendChild(l[s])}for(var c=0;c<r.children.length;c++)r.children[c].classList.remove("selected"),i.children[c].style.display="none";return r.children[r.children.length-1].classList.add("selected"),i.children[r.children.length-1].style.display="block",n},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(e,t){var n,o=function(e){var t=[];return e.SheetNames.forEach((function(n){var o={rows:[],columns:[],data:[],style:{}};if(o.sheetName=n,(p=e.Sheets[n]["!cols"])&&p.length)for(var r=0;r<p.length;r++)o.columns[r]={},p[r]&&p[r].wpx&&(o.columns[r].width=p[r].wpx+"px");if((p=e.Sheets[n]["!rows"])&&p.length)for(r=0;r<p.length;r++)p[r]&&p[r].hpx&&(o.rows[r]={},o.rows[r].height=p[r].hpx+"px");if((p=e.Sheets[n]["!merges"])&&p.length>0){o.mergeCells=[];for(r=0;r<p.length;r++){var i=p[r].s.c,a=p[r].s.r,l=p[r].e.c,s=p[r].e.r,u=jexcel.getColumnNameFromId([i,a]);o.mergeCells[u]=[l-i+1,s-a+1]}}var c=0,d=0,p=Object.keys(e.Sheets[n]);for(r=0;r<p.length;r++)if("!"!=p[r].substr(0,1)){var f=e.Sheets[n][p[r]],h=jexcel.getIdFromColumnName(p[r],!0);o.data[h[1]]||(o.data[h[1]]=[]),o.data[h[1]][h[0]]=f.f?"="+f.f:f.w,c<h[0]&&(c=h[0]),d<h[1]&&(d=h[1]),f.style&&Object.keys(f.style).length>0&&(o.style[p[r]]=f.style),f.s&&f.s.fgColor&&(o.style[p[r]]&&(o.style[p[r]]+=";"),o.style[p[r]]+="background-color:#"+f.s.fgColor.rgb)}for(var b=o.columns,g=0;g<=d;g++)for(r=0;r<=c;r++)o.data[g]||(o.data[g]=[]),o.data[g][r]||b<r&&(o.data[g][r]="");t.push(o)})),t};(n=new XMLHttpRequest).open("GET",e,!0),"undefined"!=typeof Uint8Array?(n.responseType="arraybuffer",n.onload=function(e){var r=n.response,i=new Uint8Array(r),a=XLSX.read(i,{type:"array",cellFormula:!0,cellStyles:!0});t(o(a))}):(n.setRequestHeader("Accept-Charset","x-user-defined"),n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){var e=convertResponseBodyToText(n.responseBody),r=XLSX.read(e,{type:"binary",cellFormula:!0,cellStyles:!0});t(o(r))}}),n.send()},jexcel.validLetter=function(e){return e.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(e,t,n){return e.slice(0,t).concat(n).concat(e.slice(t))},jexcel.getColumnName=function(e){var t="";return e>701?(t+=String.fromCharCode(64+parseInt(e/676)),t+=String.fromCharCode(64+parseInt(e%676/26))):e>25&&(t+=String.fromCharCode(64+parseInt(e/26))),t+=String.fromCharCode(65+e%26)},jexcel.getIdFromColumnName=function(e,t){var n=/^[a-zA-Z]+/.exec(e);if(n){for(var o=0,r=0;r<n[0].length;r++)o+=parseInt(n[0].charCodeAt(r)-64)*Math.pow(26,n[0].length-1-r);--o<0&&(o=0);var i=parseInt(/[0-9]+$/.exec(e));i>0&&i--,e=1==t?[o,i]:o+"-"+i}return e},jexcel.getColumnNameFromId=function(e){return Array.isArray(e)||(e=e.split("-")),jexcel.getColumnName(parseInt(e[0]))+(parseInt(e[1])+1)},jexcel.getElement=function(e){var t=0,n=0;return function e(o){o.className&&o.classList.contains("jexcel_container")&&(n=o),"THEAD"==o.tagName?t=1:"TBODY"==o.tagName&&(t=2),o.parentNode&&(n||e(o.parentNode))}(e),[n,t]},jexcel.doubleDigitFormat=function(e){return 1==(e=""+e).length&&(e="0"+e),e},jexcel.createFromTable=function(e,t){if("TABLE"==e.tagName){t||(t={}),t.columns=[],t.data=[];var n=e.querySelectorAll("colgroup > col");if(n.length)for(var o=0;o<n.length;o++){if(!(r=n[o].style.width))var r=n[o].getAttribute("width");r&&(t.columns[o]||(t.columns[o]={}),t.columns[o].width=r)}var i=function(e){var n=e.getBoundingClientRect(),r=n.width>50?n.width:50;t.columns[o]||(t.columns[o]={}),e.getAttribute("data-celltype")?t.columns[o].type=e.getAttribute("data-celltype"):t.columns[o].type="text",t.columns[o].width=r+"px",t.columns[o].title=e.innerHTML,t.columns[o].align=e.style.textAlign||"center",(n=e.getAttribute("name"))&&(t.columns[o].name=n),(n=e.getAttribute("id"))&&(t.columns[o].id=n)},a=[],l=e.querySelectorAll(":scope > thead > tr");if(l.length){for(var s=0;s<l.length-1;s++){var u=[];for(o=0;o<l[s].children.length;o++){var c={title:l[s].children[o].innerText,colspan:l[s].children[o].getAttribute("colspan")||1};u.push(c)}a.push(u)}l=l[l.length-1].children;for(o=0;o<l.length;o++)i(l[o])}var d=0,p={},f={},h={},b={},g=e.querySelectorAll(":scope > tr, :scope > tbody > tr");for(s=0;s<g.length;s++)if(t.data[d]=[],1!=t.parseTableFirstRowAsHeader||l.length||0!=s){for(o=0;o<g[s].children.length;o++){if(m=g[s].children[o].getAttribute("data-formula"))"="!=m.substr(0,1)&&(m="="+m);else var m=g[s].children[o].innerHTML;t.data[d].push(m);var j=jexcel.getColumnNameFromId([o,s]),v=g[s].children[o].getAttribute("class");v&&(b[j]=v);var y=parseInt(g[s].children[o].getAttribute("colspan"))||0,x=parseInt(g[s].children[o].getAttribute("rowspan"))||0;(y||x)&&(p[j]=[y||1,x||1]),g[s].children[o].style&&"none"==g[s].children[o].style.display&&(g[s].children[o].style.display="");var C=g[s].children[o].getAttribute("style");C&&(h[j]=C),g[s].children[o].classList.contains("styleBold")&&(h[j]?h[j]+="; font-weight:bold;":h[j]="font-weight:bold;")}g[s].style&&g[s].style.height&&(f[s]={height:g[s].style.height}),d++}else for(var o=0;o<g[s].children.length;o++)i(g[s].children[o]);if(Object.keys(a).length>0&&(t.nestedHeaders=a),Object.keys(h).length>0&&(t.style=h),Object.keys(p).length>0&&(t.mergeCells=p),Object.keys(f).length>0&&(t.rows=f),Object.keys(b).length>0&&(t.classes=b),(g=e.querySelectorAll("tfoot tr")).length){var w=[];for(s=0;s<g.length;s++){var E=[];for(o=0;o<g[s].children.length;o++)E.push(g[s].children[o].innerText);w.push(E)}Object.keys(w).length>0&&(t.footers=w)}if(1==t.parseTableAutoCellType){var A=[];for(o=0;o<t.columns.length;o++){var L=!0,N=!0;A[o]=[];for(s=0;s<t.data.length;s++){m=t.data[s][o];A[o][m]||(A[o][m]=0),A[o][m]++,m.length>25&&(L=!1),10==m.length&&"-"==m.substr(4,1)&&"-"==m.substr(7,1)||(N=!1)}var I=Object.keys(A[o]).length;N?t.columns[o].type="calendar":1==L&&I>1&&I<=parseInt(.1*t.data.length)&&(t.columns[o].type="dropdown",t.columns[o].source=Object.keys(A[o]))}}return t}console.log("Element is not a table")},jexcel.helpers=(component={getCaretIndex:function(e){if(this.config.root)var t=this.config.root;else t=window;var n=0,o=t.getSelection();if(o&&0!==o.rangeCount){var r=o.getRangeAt(0),i=r.cloneRange();i.selectNodeContents(e),i.setEnd(r.endContainer,r.endOffset),n=i.toString().length}return n},invert:function(e){for(var t=[],n=Object.keys(e),o=0;o<n.length;o++)t[e[n[o]]]=n[o];return t},getColumnName:function(e){var t="";return e>701?(t+=String.fromCharCode(64+parseInt(e/676)),t+=String.fromCharCode(64+parseInt(e%676/26))):e>25&&(t+=String.fromCharCode(64+parseInt(e/26))),t+=String.fromCharCode(65+e%26)},getColumnNameFromCoords:function(e,t){return component.getColumnName(parseInt(e))+(parseInt(t)+1)},getCoordsFromColumnName:function(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var n=0,o=0;o<t[0].length;o++)n+=parseInt(t[0].charCodeAt(o)-64)*Math.pow(26,t[0].length-1-o);--n<0&&(n=0);var r=parseInt(/[0-9]+$/.exec(e))||null;return r>0&&r--,[n,r]}},createFromTable:function(){},injectArray:function(e,t,n){return e.slice(0,t).concat(n).concat(e.slice(t))},parseCSV:function(e,t){t=t||",";for(var n=0,o=0,r=[[]],i=0,a=null,l=!1,s=!1,u=0;u<e.length;u++)if(r[o]||(r[o]=[]),r[o][n]||(r[o][n]=""),"\r"!=e[u])if("\n"!=e[u]&&e[u]!=t||0!=l&&1!=s&&a){if('"'==e[u]&&(l=!l),null===a){if(1==(a=l))continue}else if(!0===a&&!s&&'"'==e[u]){'"'==e[u+1]?(l=!0,r[o][n]+=e[u],u++):s=!0;continue}r[o][n]+=e[u]}else{if(a=null,l=!1,s=!1,'"'==r[o][n][0]){var c=r[o][n].trim();'"'==c[c.length-1]&&(r[o][n]=c.substr(1,c.length-2))}"\n"==e[u]?(n=0,o++):++n>i&&(i=n)}for(var d=0;d<r.length;d++)for(u=0;u<=i;u++)void 0===r[d][u]&&(r[d][u]="");return r}},component),"undefined"!=typeof jQuery&&function(e){e.fn.jspreadsheet=e.fn.jexcel=function(t){var n=e(this).get(0);return n.jexcel?Array.isArray(n.jexcel)?n.jexcel[t][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):n.jexcel[t].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(e(this).get(0),arguments[0])}}(jQuery),jexcel}))},{"@jspreadsheet/formula":1,jsuites:2}]},{},[3])(3)}));